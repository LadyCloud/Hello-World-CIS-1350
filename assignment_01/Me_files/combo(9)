YUI.add("comms-intl-bidihighlight",function(A){A.mix(A.namespace("comms.Intl"),{_needPrevChar:/[\u0620\u0622-\u063F\u0641-\u064A\u066E\u066F\u0671-\u0673\u0675-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u077F\u07CA-\u07EA]/,_needNextChar:/[\u0620\u0626\u0628\u062A-\u062E\u0633-\u063F\u0641-\u0647\u0649\u064A\u066E\u066F\u0678-\u0687\u069A-\u06BF\u06C1\u06C2\u06CC\u06CE\u06D0\u06D1\u06FA-\u06FC\u06FF\u0712-\u0714\u071A-\u071D\u071F-\u0727\u0729\u072B\u072D\u072E\u074E-\u0758\u075C-\u076A\u076D-\u0770\u0772\u0775-\u0777\u077A-\u077F\u07CA-\u07EA]/,_highlightJoiner:"\u200d",_highlightStartTag:"<b>",_highlightEndTag:"</b>",_initializeBidiHighlightJoiner:function(){},highlightString:function(I,J,G){var K,F,M,D,B,L,C,E,H;E=function(N){return N===""?"":N.charAt(N.length-1);};H=function(N){return N===""?"":N.charAt(0);};if(I.length===0){return"";}L=E(J);C=H(G);K=I.charAt(0);M=I.charAt(I.length-1);F=K.charCodeAt(0);D=M.charCodeAt(0);if(L===""||L.charCodeAt(0)<1568||F<1568){B=this._highlightStartTag+I;}else{if(this._needNextChar.test(L)&&this._needPrevChar.test(K)){B=this._highlightJoiner+this._highlightStartTag+this._highlightJoiner+I;}else{B=this._highlightStartTag+I;}}if(C===""||C.charCodeAt(0)<1568||D<1568){B=B+this._highlightEndTag;}else{if(this._needPrevChar.test(C)&&this._needNextChar.test(M)){B=B+this._highlightJoiner+this._highlightEndTag+this._highlightJoiner;}else{B=B+this._highlightEndTag;}}return B;}});A.comms.Intl._initializeBidiHighlightJoiner();},"1.0.0");YUI.add("ac-widget",function(e){function s(e){var t=null,n=null;return e&&(n=e.one(".ac-value"))&&(t=n.get("text")),t}function o(e){var t=this;e.ac=t._getEventPlugin(e),e.itemNodeToValue?this._nodeToValue=e.itemNodeToValue:this._nodeToValue=s,e.ac&&o.superclass.constructor.apply(t,[e])}var t=e.Lang,n=e.contacts,r=n.utils,i=e.comms;o.NAME="ACWidget",e.extend(o,i.ui.AutoComplete,{bind:function(){o.superclass.bind.apply(this,arguments)},bindUI:function(){o.superclass.bindUI.apply(this,arguments)},_getEventPlugin:function(e){var n=!1,r=t.isUndefined;return!r(e.acNode)&&!r(e.acTarget)&&(n=e.acTarget.plug(i.ui.AutoCompleteEventsPlugin,{alignNode:e.acNode}).ac),n},refresh:function(e){var t=this,n=!1;return n=t._getEventPlugin(e),n?(e.ac=n,t.setAttrs(e)):t},getItemMarkup:function(t){return e.comms.FilterContactsMarkup.getItemMarkup(t)},click:function(t){var n=this,r=n.get("ac");t.halt();if(t.target.hasClass("ac-remove-item")){var s=t.target,o=s.getAttribute("data-ac-id"),u=s.getAttribute("data-ac-email-field-id"),a=s.getAttribute("data-ac-email");e.fire("mt:click",{action:"ac_del",append:{ltxt:n._selectedIndex}}),e.use("common-ui-dialog-helper","_shared_module_offscreen_bin_modal_btn_generic",function(e){var t=e.common.Utils.substitute(e.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"ok",btnLabel:strings.str_delete}),n=e.common.Utils.substitute(e.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"cancel","default":"default",btnLabel:strings.str_btn_cancel}),s={hd:strings.str_address_remove_hd,bd:e.common.Utils.substitute(strings.str_contacts_remove_bd,{name:a}),ft:t+n},f={ok:{handler:function(){var t=new i.FilterContacts;e.contacts.api.removeEmail(o,parseInt(u,10),t.buildContactsIndex),r.set("queryValue",""),s={hd:strings.str_address_removed_hd,bd:e.common.Utils.substitute(strings.str_address_removed_bd,{name:a}),ft:e.common.Utils.substitute(e.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"ok","default":"default",btnLabel:strings.str_ok})},e.common.ui.DialogHelper.createCommon(s)}},cancel:{handler:function(){r.set("queryValue","")}}},l=function(){};e.common.ui.DialogHelper.createCommon(s,f,l)})}else{var f;e.fire("mt:click",{action:"ac_select",append:{ltxt:n._selectedIndex}}),f=t.currentTarget.getData("selectedCb");if(f){f.call(t.target,t);return}n._selectedIndex=-1;var l=this._nodeToValue(t.currentTarget);l!==null&&(r.set("queryValue",l),r.get("host").simulate("keydown",{keyCode:13})),n._currentValue=l,r.get("host").focus()}n.hide()},handleEnter:function(e,t){var n=t.get("ac"),s=t._selectedIndex,o,u;e.halt();var a=new i.FilterContacts;if(t.get("data").queryStr!==n.get("queryValue")){a.updateFilterItems(n.get("queryValue"));var f=a.filterContacts(r.getSortedFlatContacts(["firstname","lastname","email"]));t.setAttrs({query:n.get("queryValue"),data:f}).drawMarkUp().setAlign().show()}s!==-1&&(o=t.item(s),o&&(u=this._nodeToValue(o),u!==null&&(n.set("queryValue",u),t._selectedIndex=-1,n.get("host").focus(),t.hide())))},triggerQuery:function(){this.get("ac").fire("ac:query",{value:this.get("ac").get("queryValue")})},isMousedOver:function(){var e=this.get("boundingBox"),t=e&&(e.one("div.ac-results:hover")||e.one("div.ac-results li.over")||e.one("li.yui3-aclist-item-hover"));return!!t},buildName:e.comms.FilterContactsMarkup.buildName}),o.ATTRS={host:{value:null,getter:function(){return this.get("ac").get("host")}},alignNode:{value:null,getter:function(){return this.get("ac").get("alignNode")}}},e.namespace("contacts.ui"),e.contacts.ui.ACWidget=o},"1.0.0",{requires:["overlay","node-event-simulate","comms-ui-autocomplete-plugin","comms-ui-autocomplete","contacts-api-utils","contacts-api","filter-contacts","common-utils","comms-intl-bidihighlight"]});
YUI.add("_shared_module_offscreen_bin_compose",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_compose={base:'<div id="ac-to-results" class="ac-results"></div><div id="ac-cc-results" class="ac-results"></div><div id="ac-bcc-results" class="ac-results"></div>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_notification_notifications",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_notification_notifications={base:"{{addlozenge_exceededmax}}{{send_success}}{{send_error}}{{send_abuse}}{{intro}}{{spam_success}}",addlozenge_exceededmax:'<div class="nf-text">{{str_comp_addlozenge_exceededmax}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_success:'<div class="nf-text">{{str_comp_msg_sent}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_error:'<div class="nf-text">{{str_comp_not_sent}} <a href = "#" data-action="retry">{{str_retry}}</a> <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_abuse:'<div class="nf-text">{{str_comp_send_abuse_error}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',intro:'<div class="nf-text">Click <a href = "#" data-action = "view" style="padding:0">here</a> to learn more about your inbox! <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',spam_success:'<div class="nf-text">{{str_modal_spam_investigation}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>'};},"1.0.0");YUI.add("mail-model-compose",function(D){var B=function(){B.superclass.constructor.apply(this,arguments);};var C={oComposeData:null,initializer:function(){this.oComposeData={header:{subject:null,from:null,replyto:null,to:null,cc:null,bcc:null},origin:{action:null,fid:null,oMsg:null,ctxReq:null,forwardAsAttachment:false,errInfo:null},content:null,textcontent:null,attachments:[],spellcheck:{corrections:null,correctionHash:[]},composeActions:[],isRich:null};this.cdoType="compose";},destructor:function(){},updateData:function(G){var E,F={uiUpdate:true};for(E in G){if(E){this.set(E,G[E],F);}}},neas:function(E){return E&&E.length;},_getActionCount:function(){return this.oComposeData.composeActions.length;},_setComposeAction:function(E){var G,F;if(E){if(typeof E==="string"){G=E;}else{G=E.action||"composestart";F=E.timestamp;}F=F||new Date().getTime();this.oComposeData.composeActions.push({action:G,timestamp:F});}},_getComposeAction:function(){var E=this.oComposeData.composeActions.length;return this.oComposeData.composeActions[E];},_getReplyHeader:function(){var E={from:this.oComposeData.header.from,to:this.oComposeData.header.to,cc:this.oComposeData.header.cc,subject:this.oComposeData.header.subject};return E;},_setReplyHeader:function(E){if(E.from){this.oComposeData.header.from=E.from;}if(E.to){this.oComposeData.header.to=E.to;}if(E.cc){this.oComposeData.header.cc=E.cc;}if(E.bcc){this.oComposeData.header.bcc=E.bcc;}if(E.subject){this.oComposeData.header.subject=E.subject;}},_getHeader:function(){return this.oComposeData.header;},_setHeader:function(E){this.oComposeData.header=E;},_getContent:function(){return this.oComposeData.content;},_setContent:function(E){this.oComposeData.content=E;},_getTextContent:function(){return this.oComposeData.textcontent;},_setTextContent:function(E){this.oComposeData.textcontent=E;},_getReplyContent:function(){return this._getContent();},_setReplyContent:function(E){this._setContent(E);},_getTextMode:function(){if(this.oComposeData.isRich!==null){return this.oComposeData.isRich;}else{var F=D.common.persist.UserData.get("userUIPref.useRichText"),E=((F))&&(F!=="plain");this.oComposeData.isRich=E;return E;}},_setTextMode:function(E){this.oComposeData.isRich=E;D.common.persist.UserData.set("userUIPref.useRichText",E?"dynamic":"plain");setTimeout(function(){D.common.persist.UserData.saveOne("userUIPref.useRichText");},10);},_getOrigin:function(){return this.oComposeData.origin;},_setOrigin:function(E){this.oComposeData.origin=E;this.cdoType="compose";if(E.action){this.cdoType+=E.action;}else{this.cdoType+="unkorigin";}},_getOriginError:function(){return this.oComposeData.origin.errInfo;},_setOriginError:function(E){this.oComposeData.origin.errInfo=E;},_addAttachment:function(G){var F=this.oComposeData.attachments.length,E=G&&G.state&&G.state.uploaded||0;G.cdoIndex=F;this.oComposeData.attachments.push(G);this.fire("CDO_ATTACHMENT_ADDED",F,E);},_isAttachmentOversized:function(E){return E.state.failCause==="size";},_addAttachments:function(E){if(E){for(var F=0;F<E.length;F++){this._addAttachment(E[F]);}}},_removeAttachment:function(E){var F=this.oComposeData.attachments[E]||{};F.state=F.state||{};F.state.cancelled=true;this.fire("CDO_ATTACHMENT_DELETED",E);},_removeAllAttachments:function(F){var E=this.oComposeData.attachments;for(var G=0;G<E.length;G++){if(!F||F(E[G])){this._removeAttachment(G);}}this.fire("CDO_ALL_ATTACHMENTS_DELETED");},_updateAttachment:function(E,G){var F=this.oComposeData.attachments[E];for(var H in G){F[H]=G[H];}this.fire("CDO_ATTACHMENT_PROCESSED",E);},_getAttachmentsSize:function(){var I=this.oComposeData.attachments;var E=0;for(var F=0;F<I.length;F++){var H=I[F];var G=H.state||{};var J=H.size||{sampled:0,original:0};if(isNaN(J.original)){J.original=0;}if(isNaN(J.resampled)){J.resampled=0;}if(!G.cancelled){if(G.resampled){E+=J.sampled;}else{E+=J.original;}}}return E;},_getAttachmentsCount:function(E){var J=this.oComposeData.attachments,F=0;for(var G=0;G<J.length;G++){var I=J[G];var H=I.state||{};if(E&&!E(I)){continue;}else{if(!E&&H.cancelled){continue;}}F++;}return F;},_getIsEmpty:function(){var G=this.oComposeData,F=this.oComposeData.header,E=this.neas(F.subject)||this.neas(F.to)||this.neas(F.cc)||this.neas(F.bcc)||(F.replyto!==null)||(G.origin.action!==null)||this.neas(G.attachments);return(!E);},_getAttachments:function(){return this.oComposeData.attachments;},_setSpellCheckCorrections:function(E){this.oComposeData.spellcheck.corrections=E;},_getSpellCheckCorrections:function(){return this.oComposeData.spellcheck.corrections;},_setSpellCheckCorrectionHash:function(E){this.oComposeData.spellcheck.correctionHash=E;},_getSpellCheckCorrectionHash:function(){return this.oComposeData.spellcheck.correctionHash;}};D.extend(B,D.Base,C,{NAME:"composeModel",ATTRS:{header:{setter:C._setHeader,getter:C._getHeader},replyheader:{setter:C._setReplyHeader,getter:C._getReplyHeader},content:{setter:C._setContent,getter:C._getContent},textcontent:{setter:C._setTextContent,getter:C._getTextContent},replycontent:{setter:C._setReplyContent,getter:C._getReplyContent},isRichText:{setter:C._setTextMode,getter:C._getTextMode},origin:{setter:C._setOrigin,getter:C._getOrigin},originerror:{setter:C._setOriginError,getter:C._getOriginError},attachments:{getter:C._getAttachments},attachmentsSize:{getter:C._getAttachmentsSize},attachmentsCount:{getter:C._getAttachmentsCount},spellcheckcorrections:{setter:C._setSpellCheckCorrections,getter:C._getSpellCheckCorrections},spellcheckcorrectionhash:{setter:C._setSpellCheckCorrectionHash,getter:C._getSpellCheckCorrectionHash},actionCount:{value:0,getter:C._getActionCount},composeAction:{value:"",setter:C._setComposeAction,getter:C._getComposeAction},antivirus:{value:0},prePopulated:{value:false},saveaction:{}}});var A=function(){var G=this;var F=0;function E(I){var H=new B();H.isDirty=false;H.isDraft=I;H.cdoCount=F;F++;return H;}D.mix(G,{createModel:E});};D.namespace("mail.model");D.mail.model.ComposeModel=B;D.mail.model.ComposeModelFactory=new A();
},"1.0.0",{requires:["base","common-persist-user-data"]});YUI.add("mail-model-send",function(D){var C=function(){C.superclass.constructor.apply(this,arguments);};var B={oSendData:null,initializer:function(){this.oSendData={cascade:{message:{subject:null,from:null,to:null,cc:null,bcc:null,replyto:{name:null,email:null},simplebody:{html:null,text:null,attachment:null}}},origin:{fid:null,oMsg:null,action:null},draftMID:null,cid:null,requestState:null,requestId:0};},destructor:function(){},reset:function(){delete this.oSendData;this.initializer();},_setHeader:function(F){for(var E in F){if(E){this.oSendData.cascade.message[E]=F[E];}}},_setContentHTML:function(E){this.oSendData.cascade.message.simplebody.html=E;},_setContentText:function(E){this.oSendData.cascade.message.simplebody.text=E;},_setAttachments:function(E){this.oSendData.cascade.message.simplebody.attachment=E;},_setOrigin:function(E){this.oSendData.origin=E;if(E.action&&E.action!=="edit"&&E.fid&&E.oMsg&&E.oMsg&&E.oMsg.mid){this.oSendData.cascade.messageReference={fid:E.fid,mid:E.oMsg.mid,replied:E.action==="reply_all"||E.action==="reply_sender",forwarded:E.action==="forward"};}},_getOrigin:function(){return this.oSendData.origin;},_setDraftMID:function(E){this.oSendData.draftMID=E;},_getDraftMID:function(){return this.oSendData.draftMID;},_setCaptcha:function(F){if(!this.oSendData.cascade.headers){this.oSendData.cascade.headers={};}for(var E in F){if(E){this.oSendData.cascade.headers[E]=F[E];}}},_getRecipients:function(){return{to:this.oSendData.cascade.message.to,cc:this.oSendData.cascade.message.cc,bcc:this.oSendData.cascade.message.bcc};},_getCascade:function(){return this.oSendData.cascade;},_setCID:function(E){this.oSendData.cid=E;},_getCID:function(){return this.oSendData.cid;},_getRequestState:function(){return this.oSendData.requestState;},_setRequestState:function(E){this.oSendData.requestState=E;},_getRequestId:function(){return this.oSendData.requestId;},_setRequestId:function(E){this.oSendData.requestId=E;}};D.extend(C,D.Base,B,{NAME:"sendModel",ATTRS:{header:{setter:B._setHeader},contenthtml:{setter:B._setContentHTML},contenttext:{setter:B._setContentText},attachments:{setter:B._setAttachments},origin:{setter:B._setOrigin,getter:B._getOrigin},draftMID:{setter:B._setDraftMID,getter:B._getDraftMID},captcha:{setter:B._setCaptcha},recipients:{getter:B._getRecipients},cascade:{getter:B._getCascade},sendaction:{},disableaddcontact:{},cid:{setter:B._setCID,getter:B._getCID},requestState:{setter:B._setRequestState,getter:B._getRequestState},requestId:{setter:B._setRequestId,getter:B._getRequestId}}});var A=function(){var F=this;function E(){var G=new C();return G;}D.mix(F,{createModel:E});};D.namespace("mail.model");D.mail.model.SendModel=C;D.mail.model.SendModelFactory=new A();},"1.0.0",{requires:["base"]});YUI.add("mail-controller-compose",function(e){function x(){return n.createModel()}function T(){}function N(){}function C(t){var n,r=F(p.get("userSendPref.defaultID"));r&&(n=e.mail.Controller.Compose.injectSignature(t.get("content"),t.get("isRichText"),r),n&&t.set("content",n))}function k(t){e.use("mail-controller-sendconfirm","mail-ui-sendconfirmview-base-conv",function(e){var n={sdo:_(t.cdo,null,{draftMID:t.mid},!0),auto:t.auto||null,silent:t.silent||null,mid:t.mid},r;t.cdo&&t.cdo.appid&&(n.appid=t.cdo.appid),t.cdo&&(r=t.cdo.get("origin"),r&&(n.cid=r.oMsg&&r.oMsg.cid)),n.action=t.cdo.cdoType+"_"+t.cdo.cdoCount+"_savedraft",t.cdo.set("composeAction",n.action),n.actionCount=t.cdo.get("actionCount"),e.mail.Controller.SendConfirm.saveMessage(n,function(e,r,i){t.cdo.set("saveaction",{mid:e,auto:n.auto,state:r,isMailboxBusy:i})})})}function L(e,t){var n={textConvert:!0};e.set("isRichText",!1),e.set("content",t,n)}function A(e){e.set("isRichText",!0)}function O(t,n){p.set(t,n),setTimeout(function(){e.common.persist.UserData.saveOne(t)},10)}function M(t,n,r,i){e.Array.each(t,function(e){if(e.uploadState!=="success")return;var t=e.original;if(!t||!t.mid||r){n.push({attachment:"upload://"+e.diskfilename,disposition:"attachment"});return}n.push({attachment:tt(t.fid,t.mid?t.mid:i,t.partId,t.tnef),disposition:"attachment"})})}function _(t,n,r,i){var s=t.get("header"),o=t.get("origin"),u=t.get("content"),a=t.get("textcontent"),f=t.get("isRichText"),l=[],c;return NeoConfig.useAttComposerTT&&M(t.attachments.getAll(!1,!0),l,t.get("passive"),r?r.draftMID:null),c={subject:s.subj||s.subject,from:s.from,to:s.to,cc:s.cc,bcc:s.bcc,replyto:{name:s.from.name,email:yt(s.from.email)}},bt(o,c),n?n.reset():n=e.mail.model.SendModelFactory.createModel(),n.set("header",c),n.set("contenttext",a),n.set("attachments",l),f&&n.set("contenthtml",u),i&&!!o&&o.action&&n.set("origin",o),r&&(r.draftMID&&n.set("draftMID",r.draftMID),r.cid&&n.set("cid",r.cid)),n}function D(t,n,r,i){var o=t.get("origin");if(o.action&&o.fid&&o.oMsg){o.ctxReq&&e.mail.Controller.Messages&&s.abort(o.ctxReq);var u,a=n?{truncateAt:null,midRequest:{blockImages:"none"}}:{truncateAt:null},f={success:function(){P.apply(this,arguments),i&&i()},failure:function(){H.apply(this,arguments)},args:{cdo:t,isDraft:n,stopwatch:r}};u={fid:o.fid,msg:o.oMsg,cachekey:"Prime",ovparams:a},r&&!r.CMGStart&&(r.CMGStart=new Date),e.use("mail-controller-messages",function(){o.ctxReq=e.mail.Controller.Messages.get(u,f),t.set("origin",o)})}}function P(e,t){var n=t.args.cdo,r=n.get("origin"),i=t.args.stopwatch,s={};e.mid?(i&&(i.CMGEnd||(i.CMGEnd=new Date,t.respProps&&(i.wasCached=t.respProps.wasCached)),i.CMGSize=e.body.display.length),r.oMsg=e,r.ctxReq=null,r.errInfo="ok",e.yivPrefixNumber&&(s={yqtdPrefix:e.yivPrefixNumber}),B(n,t.args.isDraft,s)):H({msg:this.message},t)}function H(e,t){var n=t.args.cdo;n.set("originerror",e)}function B(t,n,r){var i,s,o;I(t),i=q(t,n),NeoConfig.useAttComposerTT&&(o=0,e.Array.each(i.attachments,function(e){typeof t.attach_map=="undefined"&&(t.attach_map=[]),t.attach_map[o]&&t.attachments.get(t.attach_map[o])?t.get("origin").action!=="forward"&&(t.attachments.del(t.attach_map[o]),t.attach_map.splice(o,1)):(s=t.attachments.add(e),t.attach_map.push(s)),o++}));if(!n){var u=t.get("origin"),a=at(u),f=F(a.email),l,c=!0;r&&r.noSig&&(c=!1),f&&c&&(l=e.mail.Controller.Compose.injectSignature(null,t.get("isRichText"),f),i.prolog=strings.str_cfg_tog_insert_signature_bottom?i.prolog+l:l+i.prolog)}r&&r.yqtdPrefix&&t.set("yqtdPrefix",r.yqtdPrefix),t.set("replyheader",i.header),t.set("replycontent",i.prolog)}function j(t){var n,r,i;n=q(t,!1),NeoConfig.useAttComposerTT&&(i=0,e.Array.each(n.attachments,function(e){typeof t.attach_map=="undefined"&&(t.attach_map=[]),t.attach_map[i]&&t.attachments.get(t.attach_map[i])?t.get("origin").action!=="forward"&&(t.attachments.del(t.attach_map[i]),t.attach_map.splice(i,1)):(r=t.attachments.add(e),t.attach_map.push(r)),i++}))}function F(e){var t=p.get("userSendPref"),n,r,i;if(strings.str_cfg_tog_use_accountbased_signature&&e&&e!==t.defaultFromAddress){r=p.get("aliases.alias");for(var s=0;s<r.length;++s){i=r[s];if(e===i.address){n={text:i.signature,isRich:i.signatureType==="d",isActive:i.addSignature};break}}}else n={text:t.signatureText,isRich:t.richTextSignature==="plainhtml"||t.richTextSignature==="dhtml",isActive:t.signatureActive};return n&&n.isActive&&n.text?n:null}function I(t){e.use("mail-controller-messages-ops",function(){var n=t.get("origin"),r={},i=new Array(n.oMsg);r.read=1,e.mail.Controller.Messages.flag({fid:n.fid,mid:i,setFlags:r},{failure:function(){},suppressCodes:["Client.MessageIdsNotFound"]})})}function q(e,t){var n=e.get("origin"),r={prolog:null,header:null,attachments:null};if(t)return r.header=n.oMsg.header,r.prolog=et(n.oMsg.body.display),r.attachments=W(n),r;r.header=U(n);if(n.forwardAsAttachment)return r.prolog="",r.attachments=X(n),r;r.prolog=R(e,n);if(n.action==="forward"||n.action==="reply_sender"||n.action==="reply_all")r.attachments=W(n);return r}function R(e,t){var n=J(e),r=Z(t),i;return NeoConfig.hasConv?i=l(n||r?h.reply_rich_short:h.reply_plain_short,t,S,e,strings):i=l(n||r?h.reply_rich:h.reply_plain,t,S,e,strings),!n&&r&&e.set("isRichText",!0),i}function U(t){var n,r=t.action==="reply_sender"||t.action==="reply_all",i={from:null,to:null,cc:null,subject:null},s=[],o=[],u=t.fid==="Sent"||t.fid==="%40S%40Search"&&t.oMsg.sourceFolderInfo.fid==="Sent";return i.from=r?at(t):ut(),r&&(n=dt(t.oMsg),t.action==="reply_sender"?(o.push(n),i.to=o):(u||o.push(n),s.push(n),s.push(i.from),i.to=o.concat(mt(t.oMsg.header.to,s)),i.cc=mt(t.oMsg.header.cc,s),u&&i.to.length===0&&i.cc.length===0&&(i.to=t.oMsg.header.to,i.to.length===0&&(i.cc=t.oMsg.header.cc)))),i.subject=f(z(t)),u||e.Array.each(t.oMsg.header.replyto||[],function(t){var n=i.to;n&&e.Array.indexOf(n,t)<0&&e.Array.indexOf(o,t)<0&&i.to.push(t)}),i}function z(e){var t=e.action==="reply_sender"||e.action==="reply_all"||e.action==="forward";return t?(e.oMsg.header
.subject===strings["str_msg-view_no_subject"]&&(e.oMsg.header.subject=""),l(h.subject.replace(/\s+$/,""),e,E,null,strings)):e.oMsg.header.subject}function W(t){var n=t.oMsg.attachments,r=[];return e.Array.each(n,function(e){(t.action==="forward"||t.action==="edit"||(t.action==="reply_sender"||t.action==="reply_all")&&(e.referencedInline===!0||e.disposition==="inline"))&&r.push(V(e,t))}),r}function X(e){var t=strings.str_comp_nosubject;return e.oMsg.header.subject.length>0&&(t=e.oMsg.header.subject.substring(0,240)),NeoConfig.useAttComposerTT?[{filename:t+".eml",uploadState:"success",size:e.oMsg.header.size,original:{fid:e.fid,mid:e.oMsg.mid,partId:"",tnef:"",disposition:"attachment",displayable:!1}}]:[{filename:t+".eml",state:{uploaded:!0},size:{original:e.oMsg.header.size},original:{partId:"",mid:e.oMsg.mid,fid:e.fid,tnef:""}}]}function V(e,t){return NeoConfig.useAttComposerTT?{filename:e.filename,size:e.size,mimetype:e.type+"/"+e.subtype,thumbnail:e.thumbnailurl,type:e.type,referencedInline:e.referencedInline,uploadState:"success",original:{fid:t.fid,mid:t.oMsg.mid,partId:e.partId||"",tnef:e.tnef,displayable:e.isDisplayable,disposition:e.disposition}}:{filename:e.filename,mimetype:e.type+"/"+e.subtype,size:{original:e.size},state:{uploaded:!0},disposition:e.disposition,isDisplayable:e.isDisplayable,original:{partId:e.partId||"",mid:t.oMsg.mid,fid:t.fid,tnef:e.tnefId}}}function $(e,t,n){var r=/[\x01-\x08\x0B-\x0C\x0E-\x1F\x7F-\x84\x86-\x9F]/ig,i,s,o,u=!0;return e.get("nodeType")===9?o=e.one("body"):o=e,i=n,s=this.convertToPlain(o,!1,u),i=i.replace("<!-- ORIGINAL -->",""),i=i.replace(r,""),s=s.replace(r,""),i=i.replace(/<br\b([^>]*?)\bclass="yui-cursor"(.*?)>/ig,""),i=i.replace(/<p\b([^>]*)>/ig,"<div$1>"),i=i.replace(/<\/p\b[^>]*>/ig,"</div>"),i=["<html><body>",'<div style="color:',t.foreColor,"; background-color:",t.backColor,"; font-family:",t.fontFamily,";font-size:",t.fontSize,'">',i,"</div></body></html>"].join(""),{html:i,text:s}}function J(e){return!NeoConfig.low_bandwidth&&e.get("isRichText")}function K(){return strings.str_cfg_tog_compose_autoattach_prefix||Q(m)==="yes"}function Q(e){return d.get("cg.pref."+e)}function G(e){var t=v+e.replace(/\r?\n|(.{0,80})\r?\n|(.{1,80})$|(.{1,80} +)/mg,"$1$2$3<br />"+v);return t=t.replace(/(^[\>|(?:&gt;)]+|\<br \/\>(?:\>|\&gt\;)*)/mgi,"$1 "),t.substring(0,t.length-v.length)}function Y(t,n){var r,i=document.createElement("div");return i.innerHTML=t,r=e.mail.Controller.Compose.convertGuts(i),n||(r=a(r)),i.innerHTML="",i=null,r}function Z(e){var t=e.oMsg.part;if(t)for(var n=0;n<t.length;n++)if(t[n].subtype==="html")return!0;return!1}function et(e){return e&&(e=e.replace(y,"$1"),e=e.replace(b,"$1"),e=e.replace(w,"")),e}function tt(e,t,n,r){return typeof r!="undefined"&&r!==""&&r!=="null"?["message:/",encodeURIComponent(e),encodeURIComponent(t),n,r].join("/"):["message:/",encodeURIComponent(e),encodeURIComponent(t),n].join("/")}function nt(e){var t,n;return e?{fontFamily:t=it(!0),fontSize:n=st(!0)}:rt()}function rt(){var e,t;return t=p.get("userUIPref.composeFontFamily"),t=t.split("|"),t.length>1?t=t[0]:(t=it(!1),p.set("userUIPref.composeFontFamily",t+"|1")),t||(t=it(!1),p.set("userUIPref.composeFontFamily",t+"|1")),e=p.get("userUIPref.composeFontSize"),e?e+="px":e=st(!1),{fontFamily:t,fontSize:e}}function it(e){return e?ot()[0]:strings.str_rte_default_font}function st(e){if(e){var t=ot();return""+parseInt(t[1],10)+t[2]}return parseInt(strings.str_rte_default_font_size,10)+"px"}function ot(){return e.mail.ui.common.Fonts.getPlainTextOption()||[strings.str_comp_plaintext_default_font,strings.str_comp_plaintext_default_font_size,"px"]}function ut(){var e,t,n,r=p.get("userSendPref.defaultFromAddress"),i=p.get("userSendPref.defaultFromName"),s=p.get("externalAccounts")||{},o=s.extAccountsTotal||0,u=s.extAccount||[];if(o>0)for(e=0;e<o;e++)t=u[e],n=t.address,t.address&&t.address.length>0&&t.isDefault&&(r=t.address,i=t.fromName,i===""&&(i=p.get("userSendPref.defaultFromName")));return{name:i,email:r}}function at(e){var t,n={email:p.get("userSendPref.defaultFromAddress"),name:p.get("userSendPref.defaultFromName")};return e.fid==="Sent"?dt(e.oMsg):(t=ft(e.oMsg.header.to,n),t||(t=ft(e.oMsg.header.cc,n)),t||(t=ft(e.oMsg.header.bcc,n)),t||(t=ut()),t)}function ft(t,n){var r,i=null,s={},o=(p.get("externalAccounts")||{}).extAccount||[],u=(p.get("aliases")||{}).alias||[],a=(p.get("disposableAddresses")||{}).deaName||[],f=function(e){if(e&&e.address&&e.address===s.email)return i={email:e.address,name:e.fromName},!0};for(r=0;!i&&r<t.length;r++){s=t[r];if(s.email===n.email)return n;e.Array.some([].concat(o,u,a),f)}return i}function lt(e,t){var n=0,r=t.length,i=new Array(r);while(r--)i[n]=e(t[n++]);return i}function ct(e){return e.name?e.name:e.email}function ht(t){var n="",r;return NeoConfig.bidi?(t.name&&(r=e.Intl.detectDirection(t.name)==="rtl"?"\u202b":"\u202a",n=pt(t.name)?r+'"'+t.name+'"\u202c':r+t.name+"\u202c"),t.email&&(n+=n.length?" \u202a<"+t.email+">\u202c":t.email)):(t.name&&(n=pt(t.name)?'"'+t.name+'"':t.name),t.email&&(n+=n.length?" <"+t.email+">":t.email)),n}function pt(e){return e.match(/[;,"<>@]/)!==null}function dt(e,t){return!t&&e.header.replyto&&e.header.replyto.length>0?e.header.replyto[0]:e.header.from}function vt(e,t,n){return e=mt(e,n),lt(t?ht:ct,e).join("; ")}function mt(e,t){return gt(e,t)}function gt(e,t){var n,r,i,s=[],o;for(n=0;n<e.length;n++){o=!1;if(!e[n].email)continue;i=e[n].email.toLowerCase();if(t)for(r=0;r<t.length;r++)if(i===t[r].email.toLowerCase()){o=!0;break}o||(s.push({name:e[n].name,email:e[n].email}),t&&t.push(e[n]))}return s}function yt(t){var n=t,r=p.get("userSendPref.defaultFromAddress"),i=function(e){e&&e.address&&e.address===t&&(n=e.replyTo||e.address)};return r===t?n=p.get("userSendPref.defaultReplyToAddress")||r:e.Array.each([].concat((p.get("externalAccounts")||{}).extAccount||[],(p.get("aliases")||{}).alias||[],(p.get("disposableAddresses")||{}).deaName||[]),i),n=e.Lang.trim(n),n?n:t}function bt(e,t){if(e.oMsg&&e.oMsg
.header){var n=e.oMsg.header;t.inreplyto=n.messageId||n.inReplyTo,t.references="",n.references?t.references=n.references+" ":n.inReplyTo&&(t.references=n.inReplyTo+" "),t.references+=n.messageId}}function wt(){return new RegExp("(^re:\\s?)|(^fw:\\s?)|(^"+strings.str_comp_reply_spRE+"\\s?)|"+"(^"+strings.str_comp_reply_spFWD+"\\s?)","i")}function Et(t,n){var r=e.mail.Controller.Compose.convertHTMLToPlain,i=r(t),s=r(n),o=i.replace(s,""),u=["see attached","see attachment","find the included","see included","is attached","attached is","are attached","please find attached","attached are","attached to this email","attached to this message","I'm attaching","I am attaching","find attached","find the attached","find included","attached file","see the attached","see attachments","attached files","I've attached","I have attached"];for(var a in u)if(o.indexOf(u[a])!=="-1")return u[a];return!1}var t=e.mail,n=t.model.ComposeModelFactory,r=t.Controller,i=r.extend("Compose"),s=t.Controller.Messages,o=e.common,u=o.Utils,a=u.escapeHtml,f=u.unescapeHtml,l=u.substitute,c=e.ui.Templates,h=c._shared_module_compose_reply,p=o.persist.UserData,d=t.persist.MetaData,v=">",m="general.prefixreplyquotetype",g=null,y=new RegExp(/<a[^>]*href="([^\s]*?)"[^>]*>[\s]*<span[^>]*id="?lw_\d*?_\d*?"?[^>]*>http(([\s]|[^\s])*?)<\/span>[\s]*<\/a>/ig),b=new RegExp(/<span[^>]*id="?lw_\d*?_\d*?"?[^>]*>(([\s]|[^\s])*?)<\/span>/ig),w=new RegExp(/<script[^>]*[^>]*>(([\s]|[^\s])*?)<\/script>/ig),E={subject_prefix:function(e){return strings[e.action==="forward"?"str_comp_reply_spFWD":"str_comp_reply_spRE"]},subject_data:function(e){return g||(g=wt()),e.oMsg.header.subject.replace(g,"")}},S={quotetext_header:function(){return K()?h.qthdr:""},quotetext_footer:function(){return K()?h.qtftr:""},fontfamily:function(){return rt().fontFamily},fontsize:function(){return rt().fontSize},deffontfamily:function(){return it(!1)},deffontsize:function(){return st(!1)},from_data:function(e){return a(f(ht(dt(e.oMsg,!0))))},to_data:function(e){return a(f(vt(e.oMsg.header.to,!0)))},cchdr:function(e){return e.oMsg.header.cc.length>0?l(h.cchdr,e,S,null,strings):""},cc_data:function(e){return a(f(vt(e.oMsg.header.cc,!0)))},date_data:function(e){return a(u.dateFormatter(new Date(e.oMsg.header.receivedDate*1e3),strings.str_tog_dateformat_header_l10n))},subject_data:function(e){return a(f(e.oMsg.header.subject))},reply_rich_body:function(e){return et(e.oMsg.body.display)},forward_rich_body:function(e){return e.action==="forward"?h.forward_rich_body:!1},reply_rich_header:function(e){var t=NeoConfig.hasConv?"":h.rulerHeader,n=e.action==="forward"?h.fwdhdr:t;return l(n,null,null,null,strings)},reply_plain_body:function(e){var t=et(e.oMsg.body.display);if(K()){try{t=Y(t)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-composectrl:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-composectrl:1")}t=G(t)}return t},reply_plain_header:function(e){return strings[e.action==="forward"?"str_comp_reply_fwdHeader":"str_comp_reply_origHeader"]},quoteprefix:function(){return K()?v+" ":""},headerDir:function(){return NeoConfig.isRTL?' dir="rtl" ':' dir="ltr" '}};e.mix(i,{createCDO:x,insertSignature:C,applyStationery:T,addAttachment:N,assembleSendBody:$,transformSend:_,save:k,savePref:O,toPlainText:L,toRichText:A,fetchOrigin:D,getDefaultFontInfo:nt,getStyleFontFamily:it,getStyleFontSize:st,getDefaultFromAddress:ut,seedSubject:z,htmlToText:Y,getSignature:F,convertAttachmentData:W,attachAlert:Et,updateAttachments:j,getBody:R,getHeaderContent:U,transformOrigin:q,updateFromOrigin:B},!0)},"3.0.0",{requires:["mail-controller-base","mail-model-compose","mail-model-send","common-persist-user-data","mail-persist-meta-data","mail-ui-common-fonts","_shared_module_compose_reply"]});
YUI.add("mail-controller-compose-text",function(A){A.namespace("mail.Controller");var J=A.common.Utils,O={address:1,blockquote:1,body:1,caption:1,center:1,col:1,colgroup:1,dd:1,dir:1,div:1,dl:1,dt:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,li:1,menu:1,ol:1,p:1,pre:1,table:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,ul:1};function B(S,T,R){var U=S.cloneNode(true),Q=A.Node.getDOMNode(U),P=F(Q);if(T){P=I(P,true);}if(R){P=E(P);}return P;}function L(R,T){var P=A.Node.create("<div>"+R+"</div>"),S=A.Node.getDOMNode(P),Q=F(S);if(T){Q=I(Q);}return Q;}function F(Q){var P=A.UA.ie;if(!P){K(Q);}else{Q.innerHTML=Q.innerHTML.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,"<BR/>");}return M(Q,false,"").replace(/\n[\s\xA0]+$/,"");}function E(P){return P.replace(/\xA0/g," ");}function M(S,W,X){var Z=A.one(S),U,a;if(Z.hasClass("compose-ignore")){return"";}else{if(S.nodeType===1||S.nodeType===11){var R=S.tagName;if(A.UA.ie&&S.tagName==="DIV"&&S.getAttribute("class")&&S.getAttribute("class")!=null&&S.getAttribute("class").indexOf("hr")!==-1){R="HR";}switch(R){case"SCRIPT":case"STYLE":case"LINK":case"OBJECT":case"EMBED":return"";case"HR":a=S.previousSibling;return(G(a)?"":"\n")+X+"________________________________\n"+X;case"BR":return"\n"+X;case"BLOCKQUOTE":X+=">";default:U=[];var P=S.firstChild;var V=0;if(R==="SPAN"&&A.one(S).hasClass("Apple-tab-span")){return A.one(S).get("text");}while(P!==null){var Y=M(P,P.tagName==="PRE",X);if(P.nodeType===1){if(H(P)==="block"&&U.length>0&&P.tagName!=="TD"){var T=Y.match(/^[ \t\r\n\v\f]*$/);if(!T||P.tagName==="LI"){U.push("\n"+X);}}switch(P.tagName){case"LI":V++;U.push("\t"+(P.parentNode.tagName==="OL"?V+".":"*")+" ");break;}}if(Y){U.push(Y);}if(P.nodeType===1){switch(P.tagName){case"TD":U.push(" ");break;}}P=P.nextSibling;}return U.join("");}}else{if(S.nodeType===3){U=S.nodeValue;if(!W){a=S.previousSibling;var Q=a?H(a):null;U=G(a)?U:U.replace(/\n[ \t\r\n\v\f]+/g," ");if(a===null||G(a)){U=U.replace(/^[ \t\r\n\v\f]+/,"");}else{if(Q==="block"){U=U.replace(/^[ \t\r\n\v\f]+/,"\n");}else{if(Q==="inline"){U=U.replace(/^[ \t\r\n\v\f]+/," ");}}}U=U.replace(/[ \t\r\n\v\f]+$/," ");}return U;}else{return"";}}}}function G(P){if(P===null||P.nodeType!==1){return false;}return P.tagName==="BR";}function H(P){if(P===null||P.nodeType!==1){return null;}if(P.style.display){if(P.style.display==="block"){return"block";}else{if(P.style.display==="inline"){return"inline";}}}return O[P.tagName.toLowerCase()]?"block":"inline";}function K(S){if(S.nodeType===1||S.nodeType===11){var Q=S.firstChild;while(Q!==null){var U=Q.nextSibling;K(Q);Q=U;}}else{if(S.nodeType===3){var R=S.nodeValue;if(R.match(/^[ \t\r\n\v\f]*$/)){var P=S.previousSibling;var T=P?H(P):"inline";if(T==="inline"&&!G(P)){S.nodeValue=S.nodeValue.replace(/\n.*/," ");}else{S.parentNode.removeChild(S);}}}}}function I(Q,P){Q=J.escapeHtml(Q);if(P){Q=Q.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");Q=Q.replace(/( ){2}/g,"&nbsp;&nbsp;");}Q=Q.replace(/\n/ig,"<br />");return Q;}function C(U,R,S){var P,T=S&&S.isRich,Q,W=S&&S.text;if(!W){return"";}W=N(W,T);if(!T){W=D(W);}else{if(!R){try{Q="<br>";W=W.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,Q);W=W.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,Q);W=W.replace(/((<p\s+[^>]*>)|(<p\s*>)&nbsp;<\/p>)/gi,Q);W=W.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,Q);W=W.replace(/(<br\s+[^>]*>)|(<br\s*>)/gi,Q);W=W.replace(/(<br\/\s+[^>]*>)|(<br\/\s*>)/gi,Q);W=W.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"");W=W.replace(/<\/p>/gi,Q);W=W.replace(/(<hr\s*>)/gi,Q+"________________________________"+Q);W=L(W,true);}catch(V){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-composetext:1",V,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-composetext:1");}}}U=U||"";P=U!="";if(W!=""){if(A.UA.ie||A.UA.webkit){if(P){U=U+"<div></div><div>&nbsp;</div>"+W;}else{U="<div></div><div>&nbsp;</div>"+W+U;}}else{if(P){U=U+"<div>&nbsp;</div>"+W;}else{U="<div>&nbsp;</div>"+W+U;}}}return U;}function N(Q,P){if(Q!=null){if(!P){Q=Q.replace(/<vbr>|\n/gi,"<br />");return"<div>"+Q+"</div>";}else{Q=Q.replace(/<vbr>/gi,"");}}return Q||"";}function D(R){var Q,P;R=A.common.Utils.unescapeHtml(R);R=R.replace(/<hr\s*[^>]*>/gi,"<div><hr></div>");R=R.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,"endptagpblanklineppblanklinepstartptag");R=R.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,"endptagpblanklinepstartptag");R=R.replace(/((<p\s+[^>]*>)|(<p\s*>)&nbsp;<\/p>)/gi,"endptagpblanklinepstartptag");R=R.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,"endptagpblanklinepstartptag");R=R.replace(/(<br\s+[^>]*>)|(<br\s*>)/gi,"brtag");R=R.replace(/(<br\/\s+[^>]*>)|(<br\/\s*>)/gi,"brtag");R=R.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"startptag");R=R.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"startptag");R=R.replace(/<\/p>/gi,"endptag");Q=R.replace(/<div\s+[^>]*dir\s*=\s*[\'|\"]ltr[\'|\"]\s*[^>]*>/gi,"ltrstartptag");Q=Q.replace(/<div\s+[^>]*dir\s*=\s*[\'|\"]rtl[\'|\"]\s*[^>]*>/gi,"rtlstartptag");Q=Q.replace(/(<div\s+[^>]*>)|(<div\s*>)/gi,"startptag");R=Q.replace(/<\/div>/gi,"endptag");P=A.common.Utils.escapeHtml(R);P=P.replace(/brtag/g,"<br />");P=P.replace(/ltrstartptag/g,"<div dir='ltr'>");P=P.replace(/rtlstartptag/g,"<div dir='rtl'>");P=P.replace(/startptag/g,"<div>");P=P.replace(/endptag/g,"</div>");P=P.replace(/pblanklinep/g,"<br/><br/>");return P;}A.mix(A.mail.Controller.Compose,{convertToPlain:B,convertHTMLToPlain:L,convertGuts:F,injectSignature:C});},"1.0.0",{requires:["common-persist-user-data","mail-controller-compose"]});YUI.add("mail-models-validators-send",function(A){A.namespace("mail.Models.Validators").send={MAX_NUM_OF_RECIPIENTS:100,YNC_ADDR_WHITELIST:["sgproxy_test_10@localhost","sgproxy_test_20@localhost","sgproxy_test_40@localhost","sgproxy_test_50@localhost"],validateAddress:function(C){var E=Array.prototype.concat(C.to,C.cc,C.bcc),F=E.length,D,B={valid:true};for(D=0;D<F;D++){if(!A.comms.Utils.isValidEmail(E[D].email)){if(this.YNC_ADDR_WHITELIST.indexOf(E[D].email)!==-1){continue;}B.valid=false;B.invalidAddress=E[D].email;return B;}}return B;},validatePresenceOfRecipients:function(C){var B={valid:true};if(C.to.length<1&&C.cc.length<1&&C.bcc.length<1){B.valid=false;}return B;},validateNotUploadingAttachments:function(B){return({valid:!B.isUploadingAttachments()});},validateCleanAttachments:function(B){var C=0;var D=0;A.each(B.attachments,function(E){if(E.state()==="infected"){C++;}else{if(E.state()==="failed"){D++;}}});return{valid:(C+D===0),cntInfected:C,cntFailed:D};},validatePresenceOfContent:function(C){var D=A.Lang.trim(C.subject),B={valid:true};if(D.length<1){B.valid=false;}return B;},validateNumberOfRecipients:function(D){var B={valid:true},C=D.to.length+D.cc.length+D.bcc.length;if(C>this.MAX_NUM_OF_RECIPIENTS){B.valid=false;}return B;},validateSpame:function(C){var B={valid:true};if(C.isSpame()){B.valid=false;}return B;},validateCaptcha:function(C){var B={valid:true};if(C.isRejectedOnCaptcha()&&!C.captchaAnswer){B.valid=false;}return B;},checkForAttachment:function(C){var B={valid:true},E=A.common.Utils.getVal(C,"origin.action"),D;if(E==="edit"&&A.common.Utils.getVal(C,"attachments").length===0){D=C.makeInReplyTo();if(A.common.Utils.getVal(D,"replied")){E="reply_sender";}}if(A.common.Utils.getVal(C,"origin.parentMsg.flags.hasAttachment")&&(E==="reply_all"||E==="reply_sender")){B.valid=false;}return B;}};},"1.0.0",{requires:["comms-utils","common-utils"]});YUI.add("mail-ui-mailcompose-base-header-v3",function(e){function F(e){var t=this;t.composeView.attView&&t.composeView.attView.reposAttachObj(e)}function I(){e.ACWidgetInst&&e.ACWidgetInst.hide()}function q(e){e.removeAttribute("aria-owns"),e.removeAttribute("aria-activedescendant")}function R(e){e.removeAttribute("aria-describedby")}function U(){var t=e.ACWidgetInst;t.get("ac").get("host").set("aria-owns",t.get("contentBox").generateID())}function z(e){var t=e.ancestor("ul"),n=t.all(".lozenge-static"),r;n.size()>0&&(r=[],n.each(function(e){r.push(e.generateID())})),r?e.set("aria-describedby",r.join(" ")):e.removeAttribute("aria-describedby")}function W(e){var t;t=e.get("value").replace(/([^,; ]+?@[^ ,;]+?\.[a-z]+?>?)[ ;]+([^ ,;])/ig,"$1, $2"),e.set("value",t)}function X(e,t){var n=e.get("value"),r=n.length,i=parseInt(e.ancestor(".ac-input").getStyle("width"),10)-40,s=150,o=17,u=this;t&&(n?(W(e),u._lozengeIt(e)):setTimeout(function(){W(e),u._lozengeIt(e)},500)),r>o?(s+=(r-o)*10,s>i&&(s=i),e.setStyle("width",s+"px")):e.setStyle("width","")}function V(t){var r=!1,i=null,s=null,o=/(<[^<>]+@[^<>]+\.[^<>]+>)|(\([^\(\)]+@[^\(\)]+\.[^\(\)]+\))|(\[[^\[\]]+@[^\[\]]+\.[^\[\]]+\])/,u,a=t.replace(/\".*\"/g,"");return!n(a)||a.indexOf("@")<0?{fail:!0,email:t,name:t}:(o.test(t)?(u=t.match(o),s=u[0],i=n(t.replace(s,"")),s=s.substring(1,s.length-1)):s=i=n(t),e.comms.Utils.isValidEmail(s)||(r=!0),{fail:r,email:s,name:i})}function $(e){var t=0,n=0,r=e.length,i=[],s=!1,o=!1;for(n=0;n!==r;n++){var u=e.charAt(n);switch(u){case'"':s=!s;break;case"&":o=!0;break;case";":o&&(o=!1);break;case",":s||(i.push(e.slice(t,n)),t=n+1)}}return t!==n&&i.push(e.slice(t,n)),i}function J(t){var n=t.ancestor("ul"),r=n.all(".hLozenge"),i;r&&(q(t),R(t),r.remove(),e.fire("lozenge:remove"),_&&(i=t.ancestor(".ac-input"),this._toggleHideRecptsBtn(i.get("id"),!1)))}function K(){var t=this,n;if(!t.isLozengeHighlighted)return;n=t.composeView.baseNode.all(".hLozenge.focus"),n.removeClass(x),q(e.all("#to-field, #cc-field, #bcc-field")),t.allLozengesSelected=!1,t.isLozengeHighlighted=!1}function Q(e,t){var n=this;n._removeLozengeHighlights(),e.toggleClass(x),n.isLozengeHighlighted=!0;var r=e.one(".lozenge-static").generateID();t.setAttrs({"aria-owns":r,"aria-activedescendant":r})}function G(e){var t=this,n=e.ancestor("ul"),r=n.all(".hLozenge");r&&(r.addClass(x),t.isLozengeHighlighted=!0),t.allLozengesSelected=!0}function Y(e){var t=this,r,i,s;r=e.ancestor(),i=n(e.get("value"));if(!n(i)){e.set("value","");return}i&&i.indexOf('"')>-1?s=$(i):(i.lastIndexOf(",")===i.length-1&&(i=i.substring(0,i.length-1)),s=i.split(/[;,]+/)),t._makeLozenges(s,r),z(e),e.set("value",""),t.checkOtherLozengeBoxes()}function Z(){var t=this,n=t.composeView.baseNode,r,i;n.all("li.hLozenge").size()>100&&(i=new e.common.ui.Notification({type:"fade",className:"top",parent:"shellcontent",parentType:"id"}),r=d._shared_module_offscreen_bin_notification_notifications.addlozenge_exceededmax,i.on("clickEvent",function(){i.destroy()}),i.notify(l(r,null,null,null,strings),5e3))}function et(e,t){var r=this,i,s=e.length,o,u,a,f;for(i=0;i<s;i++)u=e[i],n(u),u&&(a=V(u),f=r._createLozenge(a),t.insert(f,t));_&&(o=t.ancestor(".ac-input"),r._toggleHideRecptsBtn(o.get("id"))),r.composeView.resizeRTE(),r._checkRecipientCount(),r.composeView._setDirty(),r.checkOtherLozengeBoxes()}function tt(t,n){var r,i,s,o,u=[];H[n]=[];for(i=0;i<t.length;i++)o=t[i],H[n].push(o),u.push(o.email);s=u.join(",");var a={label:l(strings.str_hdr_more_recipients,{num_more_recipients:u.length},0,0,strings),hover:s,state:"normal",data:s,menu:null,edit:!1,copy:!1,parentClass:"group",dataClass:"more_recp more",action:"expand-recpts",valFn:function(){return!0}},f=new e.comms.ui.Lozenge(a);return f.getNode()}function nt(t){var n,r;if(!t)return null;t.name=t.name||t.email;if(strings.str_cfg_tog_compose_enable_nickname){var i=b.getContactsByEmail(t.email),s;i&&(s=b.getFirstFieldValue(i[0],"nickname"),s&&(t.isNN=!0,t.name=s))}n||(n={email:t.email,firstName:t.name||t.email}),t.fail?r=strings.str_comp_error_email_lozenge_attr:r=t.email;var o,u={label:h(t.name),hover:h(r),state:t.fail?"error":"normal",data:t,menu:null,edit:!0,copy:!0,parentClass:"draggable"};o=new e.comms.ui.Lozenge(u);var a=o.getNode();return a.set("role","presentation"),e.mail.e2e&&e.mail.e2e.hasStarted&&e.mail.e2e.hasStarted()&&e.mail.e2e.isValid()&&e.mail.e2e.validateRecipients([t.email],function(e){e[0].recipient===t.email&&e[0].valid&&a._node.classList.add("lozenge-secure")}),a}function rt(t){var n=t.getData("lozenge"),r=n.data,i=n.error;if(t.hasClass("group"))return;if(strings.str_cfg_tog_compose_enable_nickname&&r.name&&r.isNN){var s=e.contacts.utils,o=s.getContactsByEmail(r.email),u,a;u=s.getFirstFieldValue(o[0],"name"),a=u?u.familyName+" "+u.givenName:"",r.name=a}if(i){this.currentAddress=r.email,this.validAddress=!1;if(!this.allowWhitelist||this.currentField!=="to"||e.mail.Models.Validators.send.YNC_ADDR_WHITELIST.indexOf(r.email)===-1)return}this[this.currentField].push(r)}function it(){var e=this,t={to:[],cc:[],bcc:[],validAddress:!0,allowWhitelist:NeoConfig.isAMT||!!NeoConfig.isInternal||!!NeoConfig.isInternalIP,currentAddress:"",currentField:""},n,r,i,o,u,a,f,l,c,h,p,d;return n=e.composeView.baseNode.one(".cm-to.ac-input").all(".hLozenge"),t.currentField="to",n.each(rt,t),r=e.composeView.baseNode.one(".cm-cc.ac-input").all(".hLozenge"),t.currentField="cc",r.each(rt,t),i=e.composeView.baseNode.one(".cm-bcc.ac-input").all(".hLozenge"),t.currentField="bcc",i.each(rt,t),u=((s.get("externalAccounts")||{}).extAccount||[]).length,a=((s.get("aliases")||{}).alias||[]).length,f=((s.get("disposableAddresses")||{}).deaName||[]).length,u>0||a>0||f>0?e.composeView.type&&e.composeView.type==="inlineCompose"?t.from={email:e.composeView.draft.get("header").from.email,name:e.composeView.draft.get("header").from.name}:(l=e.composeView.baseNode.one(".from-select").get("value"),c=l.lastIndexOf("<"),h=l.lastIndexOf(">"),p=l.substring(c+1,h),d=l.substring(0,c-1),t.from=
{email:p,name:d}):t.from={email:s.get("userSendPref.defaultFromAddress"),name:s.get("userSendPref.defaultFromName")},o=e.composeView.baseNode.one(".cm-subject-field"),o?t.subject=o.get("value"):t.subject=e.composeView.draft.get("header").subject,t}function st(t,n,r){var i,s,o,u,a,f,c,h=e.mail.ui.PaneUtils,p=n.recipients,d=n.more_recipients,v=n.to_str;if(t)return s=t.to||[],o=t.cc||[],u=t.bcc||[],a=s.concat(o,u),i=a.length,f=function(e){var t={to:h.getName(e),rcpt_id:h.getAddress(e),rcpt_name:h.getName(e)};return t},c=h.createRecipientList(a,p,null,r,f),r!==""&&a.length>r&&(c+=l(d,{num_more_recipients:a.length-r},0,0,strings)),c=l(v,null,null,null,strings)+c,c}function ot(e){var t=lt("cc"),n,r,i=this.composeView.baseNode,s=i.one(t.groupNode+" .address-btns");typeof e!="boolean"&&(n=lt("bcc"),r=i.all(t.groupNode+" .hLozenge, "+n.groupNode+" .hLozenge"),e=r.size()>0?!1:!0),s[e?"removeClass":"addClass"]("hidden")}function ut(e,t){var n=lt(e),r=this.composeView.baseNode.one(n.groupNode),i=r.one(".compose-hide-recpts"),s,o,u;typeof t=="undefined"&&(o=r.all(".hLozenge"),u=o.size(),t=u>P),e!=="to"&&this._showHideCcBccOption(t?!1:""),i[t?"removeClass":"addClass"]("hidden")}function at(e,t){var n=this.composeView,r=lt(e),i=n.baseNode.one(r.groupNode),s=n.baseNode.one(r.node),o=s.ancestor("li"),u=[],a,f,l,c,h,p,d;d=i.one(".hLozenge.group"),d&&d.remove(!0),a=i.all(".hLozenge"),p=a.size(),l=t?!1:P===p?p:D,a.each(function(e,t){l&&t>=l?(e.addClass("hidden"),u.push(e.getData("lozenge").data)):e.removeClass("hidden")}),u.length?(h=tt(u,e),o.insert(h,o),this._toggleHideRecptsBtn(e,!1)):p>P&&this._toggleHideRecptsBtn(e,!0),n.resizeRTE()}function ft(e,t,n){var r=this.composeView,i=lt(t),s=r.baseNode.one(i.node),o=s.ancestor("li"),u,a,f,l;l=n?!1:D;for(u=0;u<e.length;u++)a=e[u],f=this._createLozenge({name:a.name,email:a.email}),l&&u>=l&&f.addClass("hidden"),o.insert(f,o),r.resizeRTE(),this._checkRecipientCount(),r._setDirty();_&&this._manageHideMoreOptions(t,n),this._showHideCcBccOption(),z(s)}function lt(e,t){return{list:t&&t[e],node:".cm-"+e+"-field",groupNode:".cm-"+e+"-group"}}function ct(t){var n=this,r=n.composeView,i,s,o,u,l,c,h=r.type==="inlineCompose"?r.baseNode.one(".thread-recipients"):null,p="",v=[],m=["to","cc","bcc"],g=function(e){var t={to:f.getName(e),email:f.getAddress(e)};return t},y;for(s in m)c=m[s],l=lt(c,t),u=l.list,u&&(o=l.node,h&&o!==".cm-bcc-field"&&(v=v.concat(u)),n._createAddressList(u,c));h&&(p=f.createRecipientList(v,d._shared_module_thread_thread_display_rollup.recipients1,null,null,g),h.setContent(p));if(t.cc&&t.cc.length!==0||t.bcc&&t.bcc.length!==0)n._bccSwitch(!0,!1,"cc"),n._bccSwitch(!0,!1,"bcc");if(r.type==="fullCompose"){t.from&&t.from.email&&(y=a.features.enabled("imapIn")?e.mail.Controller.ImapIn:null,y&&!y.isPrimaryAccount()?n._setFromMenu(y.getCurrentAccount()):n._setFromMenu(t.from));if(t.subject){r.baseNode.one(".cm-subject-field").set("value",t.subject);var b=e.UA.ie>0&&e.UA.ie<10,w=b&&r.baseNode.one(".IEplaceholder");b&&w&&w.addClass("hidden"),r._setDirty()}}n.checkOtherLozengeBoxes()}function ht(e){var t=this,n=t.composeView.baseNode.all("div.ac-input input"),r=t.composeView.baseNode.all("div.subject input");e?(n.removeAttribute("readOnly"),r.removeAttribute("readOnly")):(n.setAttribute("readOnly",!0),r.setAttribute("readOnly",!0))}function pt(e){!B||!e?B.changeSelection(s.get("userSendPref.defaultID")):B.changeSelection(e.email),this._buildFromMenu()}function dt(t,n){var r=this,i=t.result.value.filters,o=i.length,u,a,f,l,c,h,p,d;if(o===0){d=s.get("userSendPref.defaultFromAddress");for(h=0;h<length;h++)if(d===n[h].email){r._setFromMenu(d);break}}else{a=e.one("#storm-listnav li.selected i"),u=a?a.get("text"):null;if(u)for(h=0;h<o;h++)if(i[h].actions[0].value.folderActionValueBean.folder.name===u){c=i[h].criterions,l=c.length;for(p=0;p<l;p++){f=c[p];if(f.field==="TO"&&vt(f.value,n)){r._setFromMenu(f.value);return}}}}}function vt(e,t){var n=t.length,r;for(r=0;r<n;r++)if(t[r].addr===e||t[r].email===e)return!0;return!1}function mt(t,n){var r=this,i,s,o,a,f;if(t.length===0)return;if(t.length===1)r._setFromMenu(t[0]);else{if(!vt(n,t)){r._setFromMenu();return}B||(B=new e.mail.Controller.mailComposeFromListHelper.FromOptionList,B.init()),i=B.getFromList(),vt(n,i)?(a={email:n},r._setFromMenu(a)):(s=r.getMatchedAddresses(t,i),o=s.length,o===0?r._setFromMenu():o===1?r._setFromMenu(s[0]):e.common.Utils.features.enabled("imapIn")?u?r._setFromMenu(u.getCurrentAccount()):e.use("mail-controller-filters-v3",function(e){f=e.mail.Controller.FiltersV3Controller.listFilters({suppressNotification:!0,suppressStat:!1}),f.then(function(t){r._processFiltersForReplyFrom(t,s)},function(t){r._setFromMenu(s[0])})}):r._setFromMenu(s[0]))}}function gt(e,t){var n=e.length,r=t.length,i=[],s,o,u;for(s=0;s<n;s++){u=e[s];for(o=0;o<r;o++)if(u.email===t[o].addr){i.push(u);break}}return i}function yt(e,t){var n=this,r,i,s=(e.isRTL?"rtl":!1)||(strings.str_tog_loadRTLCss?"rtl":"ltr"),o,u;return NeoConfig.bidi?(o=(s==="rtl"?"\u202b":"\u202a")+e.name+"\u202c",u=(s==="rtl"?"\u202b":"\u202a")+"\u200e&lt;"+e.addr+"&gt;\u200e\u202c",i=c(o)+" "+u):i=c(e.name,p)+" &lt;"+e.addr+"&gt;",r=l(m,{isDefault:t,address:i},n.composeView.formatters,null,strings),r}function bt(){var t=this,n=t.composeView.baseNode.one(".from-select"),r,i,s,o=[],u,a;B||(B=new e.mail.Controller.mailComposeFromListHelper.FromOptionList,B.init()),u=B.getFromList(),a=B.getSelectedIndex();for(r=0;r<u.length;r++)i=u[r],s=t._buildOptionMarkup(i,r===a),o.push(s);n.purge(!0,"change"),n.setContent(o.join("")),B.getVisible()?t.composeView.baseNode.one("div.account-select").removeClass(S):t.composeView.baseNode.one("div.account-select").addClass(S),n.on("change",function(){t.composeView._setDirty()})}function wt(){var e=this,t=v.show_full_header,n=l(t,e.draft,e.composeView.formatters,null,strings,d);e.hdr=e.composeView.baseNode.one(".compose-header"),e.hdr.setContent(n),e._bindUIHeader(),e._buildFromMenu()}function Et(e,t){var n=this,r;t=t||!1,r=t?1:0,n._bccSwitch
(r,!1,"cc")}function St(e){var t,n=-1;return typeof e.get("selectionEnd")=="number"?n=e.get("selectionEnd"):document.selection&&document.selection.createRange&&(t=document.selection.createRange(),t.moveStart("character",-e.get("value").length),n=t.text.length),n}function xt(t,n){n=n||"bcc";var r=this,i=r.composeView.baseNode,s=i.one(".cm-"+n+".ac-input").all(".hLozenge"),u=i.one(".cm-"+n+"-field"),a=n==="bcc"?w:E;t||s.isEmpty()&&u.get("value").length===0?(r._bccSwitch(t,!0,n),a!==w&&o.set(a,t)):(e.fire("util:ymstats",{name:"compose_hdr_close_confirm_"+n}),e.fire("mt:click",{action:"compose_hdr_close_confirm_"+n}),r.composeView.confirm(null,strings["str_comp_conf_"+n],function(){s.each(function(e){e.remove(),r.composeView._setDirty()}),u.set("value",""),r._bccSwitch(!1,!0,n),a!==w&&o.set(a,!1)}))}function Tt(t,n,r){r=r||"bcc";var i=this,s=i.composeView.baseNode.all(".cm-btn-show-"+r),o=i.composeView.baseNode.one(".cm-"+r+"-group");typeof n=="undefined"&&(n=!0),t?(o.removeClass(S),s.addClass(S),n&&i.composeView.setFocus(r)):(o.addClass(S),s.removeClass(S),n&&i.composeView.setFocus(r));var u=i.composeView.baseNode.one(".cm-bcc-group"),a=i.composeView.baseNode.one(".cm-cc-group"),f=i.composeView.baseNode.one(".btn-bcc-in-cc");u.hasClass(S)&&(t?f.removeClass(S):a.hasClass(S)?f.addClass(S):f.removeClass(S)),i._reposAttachObj(k),i.composeView.resizeRTE(),e.fire("recalculateScrollToRepositionSend")}function Nt(e){var t=this;t._initAutoComplete2(e)}function Ct(t){var n={"to-field":".cm-to","cc-field":".cm-cc","bcc-field":".cm-bcc"},r=this,i=y.ui.ACWidget,s=t.get("id");if(s&&n[s]){t.removeClass("whiteout");var o=r.composeView.baseNode.one(n[s]),u=function(){r.listeners.push(e.ACWidgetInst.get("ac").on("ac:query",function(t){var n=this,r=t.value,i,s;if(b.areContactsLoaded()){var o=new e.comms.FilterContacts;o.updateFilterItems(r),i=o.fastMatch(),i.queryStr=r,s=e.bind(n.reload,n,i),s(i)}}))};e.ACWidgetInst?e.ACWidgetInst.get("ac").get("alignNode")!==o&&(e.ACWidgetInst.get("ac").destructor(),e.ACWidgetInst.refresh({acNode:o,acTarget:t,width:o.getStyle("width"),selectFirst:!0}).setAlign().render(),u(),r._setACWidgetARIAOwns()):(r.offscreenContent&&r.offscreenContent.remove(),r.offscreenContent=e.Node.create(l(d._shared_module_offscreen_bin_compose.base,{},null,null,strings,d)),e.one(document.body).append(r.offscreenContent),e.ACWidgetInst=(new i({acNode:o,acTarget:t,contentBox:"#ac-to-results",selectFirst:!0})).setAlign().render(),r._setACWidgetARIAOwns(),e.ACWidgetInst.after("visibleChange",function(t){var n=this.get("ac").get("host"),r=e.ACWidgetInst.get("contentBox").one("li"),i=t.newVal&&r?!0:!1;n.set("aria-expanded",i),i||n.set("aria-activedescendant","")}),e.ACWidgetInst.after("selectedIndexChange",function(e){var t="";e.newVal>-1&&(t=this.get("contentBox").one(".yui3-acwidget-selected").generateID()),this.get("ac").get("host").set("aria-activedescendant",t)}),u())}}function kt(){var e=this,t=e.listeners;if(t){var n=t.length,r;for(r=0;r<n;r++)t[r]&&t[r].detach();t.length=0}e.lozengeDD&&e.lozengeDD.destroy(!0),e.hdr&&(e.hdr.detachAll(),e.hdr.remove()),j.superclass.ondestroy.call(e,arguments)}function Lt(e){var t=this,n=e.target,r=n.ancestor("div.ac-input",!1),i;if(r){i=r.get("id"),t.composeView.focusNode=i,r.addClass(T),r.get("parentNode").addClass("active");if(r.one(".hLozenge.group")){t._manageHideMoreOptions(i,!0);return}}if(n.hasClass("cm-to-field")||n.hasClass("cm-cc-field")||n.hasClass("cm-bcc-field"))t.composeView._registerFocus(n),t._initAutoComplete(n),t.checkOtherLozengeBoxes()}function At(t){e.one("div.ac-results:hover")||e.one("div.ac-results li.over")||e.one("li.yui3-aclist-item-hover")||(I(),this._lozengeIt(t),e.ACWidgetInst.get("ac").set("queryValue",""))}function Ot(e){var t=this,n=e.target,r=t.composeView.draft;if(n.hasClass("cm-to-field")||n.hasClass("cm-cc-field")||n.hasClass("cm-bcc-field"))e.preventDefault(),this.handleACBlur(n);else if(n.get("id")==="subject-field"){var i=n.get("value");i&&i!==""&&r.subject&&typeof r.subject!="undefined"&&r.subject!==i&&t.composeView._setDirty()}}function Mt(e,t){var n=this,r=e.target,i=e.keyCode,s,o,u=r.ancestor("div"),a=u.one(".hLozenge.focus"),f=r.get("value"),l,c,h=r.get("id");if(h){s={"to-field":t.one("#to_add_contacts"),cc_show_btn_in_to:"to",cc_hide_btn:"cc","cc-field":t.one("#cc_add_contacts"),"bcc-field":t.one("#bcc_add_contacts"),bcc_show_btn_in_cc:t.one("#cc_hide_btn"),bcc_hide_btn:"bcc"},o={"to-field":t.one("#cc_show_btn_in_to"),to_add_contacts:"to",cc_add_contacts:"cc",cc_hide_btn:t.one("#bcc_show_btn_in_cc"),bcc_add_contacts:"bcc",cc_show_btn_in_to:t.one("#bcc_show_btn_in_to"),"cc-field":t.one("#cc_hide_btn"),"bcc-field":t.one("#bcc_hide_btn")};if(i===39)if(r.get("nodeName")==="A"||!f&&!a||f&&St(r)===f.length){l=o[h];if(l){n.composeView.setFocus(l);if(l==="to"||l==="cc"||l==="bcc"){var p=t.one("#"+l);c=p.one(".hLozenge"),c&&(n._selectSingleLozenge(c,p),p.addClass("whiteout"))}return}}}if(!r.get("value")){e.preventDefault();var d;if(a)i===37?(d=a.previous(),d||(s[h]&&n.composeView.setFocus(s[h]),n._removeLozengeHighlights(),r.removeClass("whiteout"))):(d=a.next(),d.hasClass("hLozenge")||(d=null,n._removeLozengeHighlights(),r.removeClass("whiteout"))),d&&(n._removeLozengeHighlights(),n._selectSingleLozenge(d,r));else if(i===37){var v=r.ancestor();d=v.previous(),d&&d.hasClass("hLozenge")?(n._removeLozengeHighlights(),n._selectSingleLozenge(d,r),r.addClass("whiteout")):s[h]&&n.composeView.setFocus(s[h])}}}function _t(t){var n=this,r=t.keyCode,i=t.target;if(!i.get("value")){var s=i.ancestor(),o=i.ancestor(".ac-input"),u=o.all(".hLozenge.focus"),a=u.size();t.halt();if(n.allLozengesSelected){n.removeAllLozenges(i),i.removeClass("whiteout");return}var f,l;a?(n.removeARIAFocus(i),n.removeARIADescription(i),a===1?(f=u.item(0),l=f.next(),l===s&&(l=f.previous()),l?n._selectSingleLozenge(l,i):i.removeClass("whiteout")):i.removeClass("whiteout"),n.composeView._setDirty(),u.detachAll(),u.remove(),u=null,e.fire("lozenge:remove"),_&&n._toggleHideRecptsBtn
(o.get("id"))):r===8&&(l=s.previous(),l&&(n._removeLozengeHighlights(),n._selectSingleLozenge(l,i),i.addClass("whiteout"))),n.checkOtherLozengeBoxes(),n.composeView.resizeRTE()}}function Dt(){var e=this,t=e.composeView.baseNode.one(".cm-to.ac-input").all(".hLozenge").size(),n=e.composeView.baseNode.one(".cm-cc.ac-input").all(".hLozenge").size(),r=e.composeView.baseNode.one(".cm-bcc.ac-input").all(".hLozenge").size(),i=0;return i=t+n+r,e.totalLozenges=i,i}function Pt(){var e=this,t=e.lozengeCount();t<=0?e.composeView._showSendBtn(!1):e.composeView._showSendBtn(!0)}function Ht(){var t=e.ACWidgetInst;return t.canHandleEnter?t.canHandleEnter():t&&t.isVisible()&&(t.get("data").length>0||NeoConfig.isCorpmail&&t.get("gabData").length>0)}function Bt(t,n){var r=this,i=e.ACWidgetInst,s=t.decodeCategory(n.get("value")),o=function(e,t,n,r,i){switch(t){case"amp":if(n)return o(e,n,"",r+5,i);return"&";case"#39":return"'";case"quot":return'"';case"lt":return"<";case"gt":return">";case"#35":return"#";default:return""}};if(s){var u,a=[];for(u in s){var f=s[u];if(f){var l="",h=f.firstname&&c(f.firstname),p=f.middlename&&c(f.middlename),d=f.lastname&&c(f.lastname),v=f.nickname&&c(f.nickname);l=i.buildName(h,p,d,v),l=l+"("+f.email+")",a.push(l.replace(/&((?:[a-zA-Z]+)|(?:#[0-9]+));(?:([a-zA-Z]+|(?:#[0-9]+));)?|([;,])/gi,o))}}r._makeLozenges(a,n.ancestor()),r.addARIADescription(n),n.set("value","")}else r._lozengeIt(n)}function jt(t){var n=this,i=t.target,s=t.ctrlKey,o=t.metaKey,u=e.ACWidgetInst,a=e.UA.os,f=s&&(a==="linux"||a==="windows"||a==="win")||o&&(a==="macintosh"||a==="mac");if(i.get("nodeName")==="A")return;f&&!t.altKey&&n.composeView.handleComposeAction("send",t);var l=new e.comms.FilterContacts;if(n.canACWidgetInstHandleEnter())u.handleEnter(t,u);else{l.updateFilterItems(i.get("value"));var c=l.fastMatch();if(c&&c.length){var h=c[0],p=r(u.getItemMarkup(h));p.one("span.ac-remove-item").remove(),i.set("value",p.get("text"))}}t.halt();if(!i.get("value")){t.preventDefault();var d=i.ancestor("div"),v=d.one(".hLozenge.focus");v&&v.getData("lozenge").startEdit();return}n.setACCategory(l,i)}function Ft(t){var n=this,r=t.target,i=t.ctrlKey,s=t.metaKey,o=e.ACWidgetInst,u,a,f=(u=o.get("data"))&&u.length,l=(a=o.get("gabData"))&&a.length;if(i||s||!r.get("value"))return;if(f>=2||l>=2)return;f===1||l===1?(t.halt(),o&&o.isVisible()&&r.simulate("keydown",{keyCode:13})):(t.halt(),n._lozengeIt(r))}function It(e){var t=this,n=e.target,r=e.ctrlKey,i=e.metaKey;if(!r&&!i||n.get("value"))return;e.halt(),t._selectAllLozenges(n),n.addClass("whiteout")}function qt(t){var n=this,r,i=t.target,s=t.ctrlKey,o=t.metaKey,u=t.altKey,a=e.ACWidgetInst,f=(r=a.get("data"))&&r.length;if(!i.get("value"))if(a.hasItemSelected){if(!a.hasItemSelected())return}else if(!a.isVisible())return;!s&&!o&&!u&&(f>=1&&t.halt(),n.composeView.keepHdrFocus=!0,i.simulate("keydown",{keyCode:13}))}function Rt(n){function u(){var e=r.hdr,n=t.ui.MessagePaneUtils,i="";e.all("li.focus").each(function(e){i+=e.one("input").get("value"),i+="; "}),i!==""&&(i=i.substring(0,i.length-1),n.initializeCopyText(),n.copyToClipboard(i,null,document.activeElement))}var r=this,i=n.ctrlKey,s=n.metaKey,o=e.UA.os==="macintosh"?s:i;o&&(n.stopPropagation(),u())}function Ut(t){var n=this,r=t.target,i=t.ctrlKey,s=t.metaKey,o=e.UA.os==="macintosh"?s:i,u=t.type==="paste"?!0:!1;(o||u)&&setTimeout(function(){n.updateTextField(r,!0)},0)}function zt(t){var n=this,r=t.target,i=t.shiftKey,s=t.ctrlKey,o=t.metaKey,u=e.UA.os==="macintosh"?o:s;r.removeClass("whiteout"),!u&&!i&&n._removeLozengeHighlights()}function Wt(e){var t=this,n=e.target;if(n.hasClass("cm-to-field")||n.hasClass("cm-cc-field")||n.hasClass("cm-bcc-field")){var r=t.composeView.baseNode.one(".ac-input.compose-field-focus .recipient-input input"),i=t.totalLozenges;r===null&&i<=0?t.composeView._showSendBtn(!1):r.getDOMNode().value===""&&i<=0?t.composeView._showSendBtn(!1):t.composeView._showSendBtn(!0)}}function Xt(t){var n=this,r=n.hdr,i=t.keyCode,s=t.shiftKey,o=t.ctrlKey,u=t.metaKey,a=t.altKey,f=e.UA.os==="macintosh"?u:o,l,c=t.target,h=NeoConfig.infinitePane,p=c?c.get("type")?c.get("type").toLowerCase()||"":"":"",d=c?c.get("tagName").toLowerCase():"",v=function(){return c.ancestor("div.cm-to ul,.cm-cc ul,div.cm-bcc ul")},m;e.fire("HoverCard:hideHoverCard"),!p||p!=="text"&&p!=="textarea"?d&&(d==="input"||d==="textarea")&&t.stopPropagation():t.stopPropagation(),c.hasClass("cm-from-field")&&h&&(t.keyCode===37||t.keyCode===39)&&t.stopPropagation(),!(s&&o&&u&&a)&&(i===188||i===186)&&c.hasClass("lozenge-edit")&&v()&&(m=v().one("li.recipient-input input"),m?m.focus():c.blur());if(c.hasClass("cm-subject-field")||c.hasClass("cm-to-field")||c.hasClass("cm-cc-field")||c.hasClass("cm-bcc-field")||c.get("nodeName")==="A"){h&&(t.keyCode===37||t.keyCode===39)&&t.stopPropagation();if((i===83||i===89&&s||i===85&&s)&&(o||u)||i===27){n.composeView.get("keydownHandler")?n.composeView.get("keydownHandler")(t):n.composeView.onKeyDown(t);return}if(c.hasClass("cm-subject-field")){l=(o||u)&&!a&&!s||i===9,(!l||f&&i===86)&&n.composeView._setDirty(),i===9&&!s&&(c.blur(),n.composeView.setFocus("body"),t.halt()),i===13&&f&&!t.altKey&&(n.composeView.handleComposeAction("send",t),t.halt());return}switch(i){case 37:case 39:n.handleLeftRightArrow(t,r);break;case 8:case 46:n.handleDelete(t);break;case 13:n.handleEnter(t);break;case 32:n.handleSpacebar(t);break;case 65:n.handleSelectAll(t);break;case 38:break;case 9:n.handleTab(t);break;case 67:n.handleCopy(t,r);break;case 86:n.handlePaste(t);break;default:n.handleDefaultKeydown(t)}}}function Vt(){var e=this,t=e.hdr,n=e.listeners;n.push(t.on("blur",e.setInputBlur,e)),n.push(t.on("keydown",e.keyHandler,e)),n.push(t.on("keyup",e.sendEnableKeyHandle,e)),n.push(t.one("#subject-field").on("keyup",function(){e.composeView._setDirty()})),n.push(t.on("change",function(t){var n=t.target;(n.hasClass("cm-to-field")||n.hasClass("cm-cc-field")||n.hasClass("cm-bcc-field"))&&e.composeView._setDirty()}))}function $t(t){var n=this,r=
t.dataAction;switch(r){case"reply_all":case"reply_sender":case"forward":n.switchReplyMode(t.dataAction),e.fire("mt:click",{action:"reply_card_menu_"+r});break;case"edit_subject":n.allowSubjectEdit(!0)}}function Jt(t){var n=this,r=n.composeView.draft.origin,i=e.common.ui.MenuHelper,s=t.target;e.use("mail-ui-inboxmenu-base","_shared_module_offscreen_bin_menus_reply_modes",function(e){e.mail.ui.InboxMenu.insert("menu-reply-modes",function(){var r=e.one("#menu-reply-modes");i.create(s,{menu:r,flushLeft:!1,isContext:!1,xy:[t.clientX,t.clientY]},function(){r.on("menuSelected",n.onReplyModeSelected,n),r.after("menu:state",function(t){var n=t.state;n==="hide"&&(s.removeClass("pressed"),s.unplug(e.Plugin.Menu),this.destroy(!0))})})},r.fid,{origin:r,isQuickReply:n.composeView.get("isQuickReply")})})}function Kt(){var t=this,n,r,i,s;t.listeners.push(t.hdr.delegate("click",function(r){var i=a.getDataAction(r).action;switch(i){case"menu":t.loadReplyModeMenu(r),e.fire("mt:click",{action:"reply_card_"+i});break;case"qr-cancel":t.neoFire("qrCancel"),e.fire("ToolTips:hideTooltips"),e.fire("mt:click",{action:"reply_card_"+i});break;case"expand-recpts":s=r.target.ancestor(".ac-input"),n=s.get("id"),t._manageHideMoreOptions(n,!0);break;case"hide-recpts":s=r.target.ancestor(".field").one(".ac-input"),n=s.get("id"),t._manageHideMoreOptions(n,!1)}},".compose-header"))}function Qt(){var t=this,r=t.composeView.baseNode,i=r.one("input.cm-subject-field"),s=r.one("input.cm-to-field"),o=r.one("input.cm-cc-field"),u=r.one("input.cm-bcc-field"),a=e.UA.ie>0&&e.UA.ie<10,f=a&&r.one(".IEplaceholder"),l=t.hdr;NeoConfig.bidi&&i.plug(e.Plugin.BidiTextEntry),t._bindAutoComplete(),t.listeners.push(t.hdr.delegate("paste",Ut,"#to-field, #cc-field, #bcc-field",t)),t.listeners.push(e.on("lozenge:highlight",function(){t.isLozengeHighlighted=!0})),NeoConfig.useDD&&t.composeView.type==="fullCompose"&&e.use("common-ui-lozengeDD",function(e){e.Lang.later(0,0,function(){t.lozengeDD=new e.common.ui.lozengeDD({composeView:t.composeView,dragSelector:".draggable"})})}),t.listeners.push(l.on("focus",Lt,t)),t.listeners.push(i.after("focus",function(){t.composeView._registerFocus(i),a&&f.addClass("hidden")})),t.listeners.push(i.on("change",function(){a&&f.addClass("hidden")})),t.listeners.push(s.after("blur",function(){s.ancestor("div").removeClass(T),t.composeView.resizeRTE()})),t.listeners.push(o.after("blur",function(){o.ancestor("div").removeClass(T),t.composeView.resizeRTE()})),t.listeners.push(u.after("blur",function(){u.ancestor("div").removeClass(T),t.composeView.resizeRTE()})),t.listeners.push(i.after("blur",function(n){t.neoFire("updateSubject"),a&&e.Lang.trim(n.target.get("value"))===""&&f.removeClass("hidden")})),t.listeners.push(l.delegate("click",function(n){n.halt(),t._reposAttachObj(N);var r={to_add_contacts:".cm-to",cc_add_contacts:".cm-cc",bcc_add_contacts:".cm-bcc"},i={wspath:NeoConfig.socdirProxyPath,guid:NeoConfig.neoguid,wssid:NeoConfig.wssid,requestFn:e.common.net.SessionMgr.requestProxy,selectAll:!1,lookForSelect:!0,lookForInput:!0,onDone:function(e,n){var i,s,o,u=n.get("id"),a=t.composeView.baseNode.one(r[u]),f=a.all("li"),l=f.item(f.size()-1);for(i in e)s={name:e[i].name,email:h(e[i].field.value)},o=t._createLozenge(s),t.composeView._setDirty(),l.insert(o,l),t.composeView.resizeRTE(),t._checkRecipientCount();_&&t._toggleHideRecptsBtn(a.get("id")),t._reposAttachObj(C),t.composeView._restoreFocus()},onCancel:function(){t._reposAttachObj(C)}};e.use("contacts-ui-choosecontactdialog",function(e){t.composeView.cancelDialogLoad||e.fire("ccd:create",i,n.currentTarget)});var s=n.currentTarget.get("id"),o="addbcc";s==="to_add_contacts"?o="addrec":s==="cc_add_contacts"&&(o="addcc"),e.fire("mt:click",{action:"cmps_"+o,append:{t1:"cmpsTb"}})},".choose-contact")),t.listeners.push(l.delegate("click",function(e){var n=e.target,r=e.currentTarget,i=r.getElementsByTagName("INPUT"),s=i.item(i.size()-1),o;if(n.hasClass("lozenge-edit"))return;o=r.get("scrollTop"),n.hasClass("compose-hide-recpts")||n.hasClass("more_recp")?s===t.composeView.focusNode?t.composeView.setFocus(t.composeView.editor.getRTE()):t.composeView._restoreFocus():s.focus(),n.hasClass("lozenge-static")||n.hasClass("lozenge-edit")?(r.set("scrollTop",o),s.addClass("whiteout")):(s.removeClass("whiteout"),t._removeLozengeHighlights(),r.set("scrollTop",r.get("scrollHeight")))},"div.ac-input")),t.listeners.push(l.on("keyup",function(e){var r=e.target,i=r.get("value"),s=i.length,o=i[s-1];if(!(r.hasClass("cm-to-field")||r.hasClass("cm-cc-field")||r.hasClass("cm-bcc-field")))return;s>0&&t.composeView._setDirty();if(o===";"||o===","){e.halt(),i=n(i);if(i.length===1){r.set("value","");return}if(!i)return;t._lozengeIt(r)}t.updateTextField(r),t._reposAttachObj(k)}))}function Gt(e,t){var n=e.action===L;n?(t.removeClass("ico-thread-reply"),t.addClass("ico-thread-reply-all")):(t.removeClass("ico-thread-reply-all"),t.addClass("ico-thread-reply"))}function Yt(t){t=t||0;var n=this,r=n.composeView.draft.origin,s=n.composeView.baseNode,o=s.all(".replyall-toggle-btn a"),u,a,f=s.one(".qr-card-actions");t||(t=r.action===A?L:A),r.action=t,f&&f.replace(l(d._shared_module_compose_quick_reply_card_actions.base,{reply_type:M[t]},null,null,strings)),t===A?(o.set("text",strings.str_comp_btn_reply_all),!n.composeView.get("isQuickReply")&&e.fire("mt:click",{action:"cmps_rplysndr",append:{t1:"cmpsTb"}}),n.composeView.composeTictacApi.render(n.composeView.baseNode.one(".attachments-pane")),i.excludeAttachment(n.composeView.draft)):t===L?(o.set("text",strings.str_comp_btn_reply_sender),!n.composeView.get("isQuickReply")&&e.fire("mt:click",{action:"cmps_rplyall",append:{t1:"cmpsTb"}}),n.composeView.composeTictacApi.render(n.composeView.baseNode.one(".attachments-pane")),i.excludeAttachment(n.composeView.draft)):t===O&&(!n.composeView.get("isQuickReply")&&e.fire("mt:click",{action:"cmps_fwd",append:{t1:"cmpsTb"}}),n.allowSubjectEdit(!1),i.excludeAttachment(n.composeView.draft),i.includeAttachment(n.composeView.
draft,{fetchGDM:!0}),n.composeView.composeTictacApi.render(n.composeView.baseNode.one(".attachments-pane"))),n.composeView.type==="inlineCompose"&&Gt(r,o),a=i.getHeaderContent(r),u=s.one(".cm-subject-field"),u&&(a.subject=u.get("value"));var c=s.one(".cm-to-field"),h=s.one(".cm-cc-field");n.removeAllLozenges(c),n.removeAllLozenges(h),n.setHeader(a),n.composeView._restoreFocus()}function Zt(){var e=this,t=e.hdr,n,r,i=e.composeView.draft.origin,s=i&&i.oMsg&&i.oMsg.header,o=i&&i.oMsg&&i.oMsg.body,u=s&&(s.to?s.to.length:0)+(s.cc?s.cc.length:0)||0,a=i.action,f,l,c,h=e.composeView.baseNode,p=h.all(".replyall-toggle-btn"),d,v={},m,y,b=1,w;i.fid==="Sent"&&a===A&&(i.action=L);if(a!==L&&a!==A||!o||!u)return;if(s.replyto){w=s.replyto.length;for(d=0;d<w;d++)v[s.replyto[d].email]=1}m=s.to.concat(s.cc),f=g()||{},w=m.length;for(d=0;d<w;d++){l=m[d].email||"";if(y&&l!==y||w===1&&!(l in f||l in v))b=0;y=l,(l in f||l in v)&&!c?c=0:c=1}if(a&&c&&!b&&h.one(".replyall-toggle-btn")&&i.fid!=="Sent"){p.removeClass("hidden"),n=t.one("#to"),r=t.one(".address-btns");if(r&&n.getX()+n.get("clientWidth")+r.get("clientWidth")+20>t.get("clientWidth")+t.getX()){p.addClass("hidden");return}e.composeView.type==="inlineCompose"&&Gt(i,h.all(".replyall-toggle-btn a")),e.listeners.push(h.delegate("click",function(){e.switchReplyMode()},".address-btns .replyall-toggle-btn a",e))}}function en(e){var t=this.hdr.one(".subject");t.removeClass("hidden"),e&&setTimeout(function(){t.one("input").focus()},0)}var t=e.mail,n=e.Lang.trim,r=e.Node.create,i=e.mail.Controller.ReplyProcessor,s=e.common.persist.UserData,o=t.persist.MetaData,u=t.model.DataStore.Accounts,a=e.common.Utils,f=t.ui.PaneUtils,l=a.substitute,c=a.escapeHtml,h=a.unescapeHtml,p=strings.str_cfg_tog_unescape_ncr,d=e.ui.Templates,v=d._shared_module_compose_message_header_fresh,m=v&&v.compose_from_address,g=e.mail.Controller.mailComposeFromListHelper.getAllAccountEmails,y=e.contacts,b=y.utils,w="neo.pref.compose.showBcc",E="neo.pref.compose.showCc",S="hidden",x="focus",T="compose-field-focus",N="offscreen",C="restore",k="move",L="reply_all",A="reply_sender",O="forward",M={reply_sender:strings.str_reply,reply_all:strings.str_reply,forward:strings.str_forward},_=a.features.enabled("showHideComposeRecipients"),D=a.settings.value("recipientThresholdVal"),P=D+1,H={},B,j=function(e,t){var n=this;n.isLozengeHighlighted=!1,n.allLozengesSelected=!1,n.composeView=t,n.offscreenContent=null,n.listeners=[],j.superclass.constructor.apply(n,arguments),n.neoEvent("updateSubject",{emitFacade:!0,broadcast:1}),n.neoEvent("qrCancel",{emitFacade:!0,broadcast:1})};e.extend(j,t.ui.BaseWidget),e.mix(j.prototype,{NAME:"HeaderBase",render:wt,getHeader:it,setHeader:ct,enableHeader:ht,allowEditing:Et,_bindUIHeader:Qt,bind:Kt,loadReplyModeMenu:Jt,setInputFocus:Lt,setInputBlur:Ot,keyHandler:Xt,lozengeCount:Dt,sendEnableKeyHandle:Wt,handleACBlur:At,handleLeftRightArrow:Mt,handleDelete:_t,handleEnter:jt,handleSpacebar:Ft,handleTab:qt,handleSelectAll:It,handleCopy:Rt,handlePaste:Ut,handleDefaultKeydown:zt,setACCategory:Bt,canACWidgetInstHandleEnter:Ht,checkOtherLozengeBoxes:Pt,_bindAutoComplete:Vt,ondestroy:kt,destroy:kt,hideACWidget:I,_cmdBccSwitch:xt,_reposAttachObj:F,_setFromMenu:pt,removeAllLozenges:J,_removeLozengeHighlights:K,_createLozenge:nt,enableSwitchReplyButton:Zt,switchReplyMode:Yt,_lozengeIt:Y,_manageHideMoreOptions:at,_createAddressList:ft,_toggleHideRecptsBtn:ut,_showHideCcBccOption:ot,_checkRecipientCount:Z,_makeLozenges:et,_selectSingleLozenge:Q,_selectAllLozenges:G,_tokenizeAddresses:$,removeARIAFocus:q,_setACWidgetARIAOwns:U,removeARIADescription:R,addARIADescription:z,updateTextField:X,_buildOptionMarkup:yt,_buildFromMenu:bt,createAddress:V,_initAutoComplete:Nt,_initAutoComplete2:Ct,_processFiltersForReplyFrom:dt,addressInList:vt,_bccSwitch:Tt,_getRecptList:st,getCursorLocation:St,onReplyModeSelected:$t,setReplyFrom:mt,getMatchedAddresses:gt,allowSubjectEdit:en,_ccSwitch:function(){}},!0),e.namespace("mail.Views").ComposeHeader=j},"1.0.0",{requires:["comms-ui-lozenge","ac-widget","_shared_module_offscreen_bin_compose","mail-controller-reply-processor","_shared_module_offscreen_bin_notification_notifications","mail-controller-compose-text","contacts-api","_shared_module_compose_message_header_fresh","mail-models-validators-send","mail-ui-basewidget","mail-common-utils-features","mail-ui-mailcompose-header-form-list-helper","mail-model-datastore","mail-common-utils-settings","mail-ui-pane-utils"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("selector-css3",function(e,t){e.Selector._reNth=/^(?:([\-]?\d*)(n){1}|(odd|even)$)*([\-+]?\d*)$/,e.Selector._getNth=function(t,n,r,i){e.Selector._reNth.test(n);var s=parseInt(RegExp.$1,10),o=RegExp.$2,u=RegExp.$3,a=parseInt(RegExp.$4,10)||0,f=[],l=e.DOM._children(t.parentNode,r),c;u?(s=2,c="+",o="n",a=u==="odd"?1:0):isNaN(s)&&(s=o?1:0);if(s===0)return i&&(a=l.length-a+1),l[a-1]===t?!0:!1;s<0&&(i=!!i,s=Math.abs(s));if(!i){for(var h=a-1,p=l.length;h<p;h+=s)if(h>=0&&l[h]===t)return!0}else for(var h=l.length-a,p=l.length;h>=0;h-=s)if(h<p&&l[h]===t)return!0;return!1},e.mix(e.Selector.pseudos,{root:function(e){return e===e.ownerDocument.documentElement},"nth-child":function(t,n){return e.Selector._getNth(t,n)},"nth-last-child":function(t,n){return e.Selector._getNth(t,n,null,!0)},"nth-of-type":function(t,n){return e.Selector._getNth(t,n,t.tagName)},"nth-last-of-type":function(t,n){return e.Selector._getNth(t,n,t.tagName,!0)},"last-child":function(t){var n=e.DOM._children(t.parentNode);return n[n.length-1]===t},"first-of-type":function(t){return e.DOM._children(t.parentNode,t.tagName)[0]===t},"last-of-type":function(t){var n=e.DOM._children(t.parentNode,t.tagName);return n[n.length-1]===t},"only-child":function(t){var n=e.DOM._children(t.parentNode);return n.length===1&&n[0]===t},"only-of-type":function(t){var n=e.DOM._children(t.parentNode,t.tagName);return n.length===1&&n[0]===t},empty:function(e){return e.childNodes.length===0},not:function(t,n){return!e.Selector.test(t,n)},contains:function(e,t){var n=e.innerText||e.textContent||"";return n.indexOf(t)>-1},checked:function(e){return e.checked===!0||e.selected===!0},enabled:function(e){return e.disabled!==undefined&&!e.disabled},disabled:function(e){return e.disabled}}),e.mix(e.Selector.operators,{"^=":"^{val}","$=":"{val}$","*=":"{val}"}),e.Selector.combinators["~"]={axis:"previousSibling"}},"3.16.0",{requires:["selector-native","selector-css2"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("frame",function(e,t){var n=e.Lang,r="contentready",i="host",s=function(){s.superclass.constructor.apply(this,arguments)};e.extend(s,e.Plugin.Base,{_ready:null,_rendered:null,_iframe:null,_instance:null,_create:function(t){var n,r="",i,o=this.get("src")===s.ATTRS.src.value,u=this.get("extracss")?'<style id="extra_css">'+this.get("extracss")+"</style>":"";this._iframe=e.one(e.config.doc.createElement("iframe")),this._iframe.setAttrs(s.IFRAME_ATTRS),this._iframe.setStyle("visibility","hidden"),this._iframe.set("src",this.get("src")),this.get("container").append(this._iframe),this._iframe.set("height","99%"),o&&(r=e.Lang.sub(s.PAGE_HTML,{DIR:this.get("dir"),LANG:this.get("lang"),TITLE:this.get("title"),META:s.META,LINKED_CSS:this.get("linkedcss"),CONTENT:this.get("content"),BASE_HREF:this.get("basehref"),DEFAULT_CSS:s.DEFAULT_CSS,EXTRA_CSS:u}),e.config.doc.compatMode!=="BackCompat"&&(r=s.getDocType()+"\n"+r)),n=this._resolveWinDoc(),r&&(n.doc.open(),n.doc.write(r),n.doc.close()),n.doc.documentElement?t(n):i=e.later(1,this,function(){n.doc&&n.doc.documentElement&&(t(n),i.cancel())},null,!0)},_resolveWinDoc:function(t){var n=t?t:{};return n.win=e.Node.getDOMNode(this._iframe.get("contentWindow")),n.doc=e.Node.getDOMNode(this._iframe.get("contentWindow.document")),n.doc||(n.doc=e.config.doc),n.win||(n.win=e.config.win),n},_onDomEvent:function(t){var n,r;if(!e.Node.getDOMNode(this._iframe))return;t.frameX=t.frameY=0,(t.pageX>0||t.pageY>0)&&t.type.substring(0,3)!=="key"&&(r=this._instance.one("win"),n=this._iframe.getXY(),t.frameX=n[0]+t.pageX-r.get("scrollLeft"),t.frameY=n[1]+t.pageY-r.get("scrollTop")),t.frameTarget=t.target,t.frameCurrentTarget=t.currentTarget,t.frameEvent=t,this.fire("dom:"+t.type,t)},initializer:function(){var e=this.get(i);e&&(e.frame=this),this.publish("ready",{emitFacade:!0,defaultFn:this._defReadyFn})},destructor:function(){var e=this.getInstance();e.one("doc").detachAll(),e=null,this._iframe.remove()},_DOMPaste:function(e){var t=this.getInstance(),n="",r=t.config.win;e._event.originalTarget&&(n=e._event.originalTarget),e._event.clipboardData&&(n=e._event.clipboardData.getData("Text")),r.clipboardData&&(n=r.clipboardData.getData("Text"),n===""&&(r.clipboardData.setData("Text",n)||(n=null))),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,n?e.clipboardData={data:n,getData:function(){return n}}:e.clipboardData=null,this.fire("dom:paste",e)},_defReadyFn:function(){var t=this.getInstance();e.each(s.DOM_EVENTS,function(n,r){var i=e.bind(this._onDomEvent,this),o=e.UA.ie&&s.THROTTLE_TIME>0?e.throttle(i,s.THROTTLE_TIME):i;t.Node.DOM_EVENTS[r]||(t.Node.DOM_EVENTS[r]=1),n===1&&r!=="focus"&&r!=="blur"&&r!=="paste"&&(r.substring(0,3)==="key"?t.on(r,o,t.config.doc):t.on(r,i,t.config.doc))},this),t.Node.DOM_EVENTS.paste=1,t.on("paste",e.bind(this._DOMPaste,this),t.one("body")),t.on("focus",e.bind(this._onDomEvent,this),t.config.win),t.on("blur",e.bind(this._onDomEvent,this),t.config.win),t.__use=t.use,t.use=e.bind(this.use,this),this._iframe.setStyles({visibility:"inherit"}),t.one("body").setStyle("display","block")},_fixIECursors:function(){var e=this.getInstance(),t=e.all("table"),n=e.all("br"),r;t.size()&&n.size()&&(r=t.item(0).get("sourceIndex"),n.each(function(t){var n=t.get("parentNode"),i=n.get("children"),s=n.all(">br");n.test("div")&&(i.size()>2?t.replace(e.Node.create("<wbr>")):t.get("sourceIndex")>r?s.size()&&t.replace(e.Node.create("<wbr>")):s.size()>1&&t.replace(e.Node.create("<wbr>")))}))},_onContentReady:function(t){if(!this._ready){this._ready=!0;var n=this.getInstance(),r=e.clone(this.get("use"));this.fire("contentready"),t&&(n.config.doc=e.Node.getDOMNode(t.target)),r.push(e.bind(function(){n.EditorSelection&&(n.EditorSelection.DEFAULT_BLOCK_TAG=this.get("defaultblock")),this.get("designMode")&&(e.UA.ie?(n.config.doc.body.contentEditable="true",this._ieSetBodyHeight(),n.on("keyup",e.bind(this._ieSetBodyHeight,this),n.config.doc)):n.config.doc.designMode="on"),this.fire("ready")},this)),n.use.apply(n,r),n.one("doc").get("documentElement").addClass("yui-js-enabled")}},_ieHeightCounter:null,_ieSetBodyHeight:function(t){this._ieHeightCounter||(this._ieHeightCounter=0),this._ieHeightCounter++;var n=!1,r,i,s;t||(n=!0);if(t){switch(t.keyCode){case 8:case 13:n=!0}if(t.ctrlKey||t.shiftKey)n=!0}if(n)try{r=this.getInstance(),i=this._iframe.get("offsetHeight"),s=r.config.doc.body.scrollHeight,i>s?(i=i-15+"px",r.config.doc.body.style.height=i):r.config.doc.body.style.height="auto"}catch(t){this._ieHeightCounter<100&&e.later(200,this,this._ieSetBodyHeight)}},_resolveBaseHref:function(t){if(!t||t==="")t=e.config.doc.location.href,t.indexOf("?")!==-1&&(t=t.substring(0,t.indexOf("?"))),t=t.substring(0,t.lastIndexOf("/"))+"/";return t},_getHTML:function(e){if(this._ready){var t=this.getInstance();e=t.one("body").get("innerHTML")}return e},_setHTML:function(t){if(this._ready){var n=this.getInstance();n.one("body").set("innerHTML",t)}else this.once(r,e.bind(this._setHTML,this,t));return t},_getLinkedCSS:function(t){e.Lang.isArray(t)||(t=[t]);var n="";return this._ready?n=t:e.each(t,function(e){e&&(n+='<link rel="stylesheet" href="'+e+'" type="text/css">')}),n},_setLinkedCSS:function(e){if(this._ready){var t=this.getInstance();t.Get.css(e)}return e},_setExtraCSS:function(t){if(this._ready){var n=this.getInstance(),i=n.one("#extra_css");i&&i.remove(),n.one("head").append('<style id="extra_css">'+t+"</style>")}else this.once(r,e.bind(this._setExtraCSS,this,t));return t},_instanceLoaded:function(t){this._instance=t,this._onContentReady();var n=this._instance.config.doc;if(this.get("designMode")&&!e.UA.ie)try{n.execCommand("styleWithCSS",!1,!1),n.execCommand("insertbronreturn",!1,!1)}catch(r){}},use:function(){var t=this.getInstance(),n=e.Array(arguments),r=!1;return e.Lang.isFunction(n[n.length-1])&&(r=n.pop()),r&&n.push(function(){r.apply(t,arguments)}),t.__use.apply(t,n)},delegate:function(e,t,n,r){var i=this.getInstance();return i?(r||(r=n,n="body"),i.delegate
(e,t,n,r)):!1},getInstance:function(){return this._instance},render:function(t){return this._rendered?this:(this._rendered=!0,t&&this.set("container",t),this._create(e.bind(function(t){var n,r,s=e.bind(function(e){this._instanceLoaded(e)},this),o=e.clone(this.get("use")),u={debug:!1,win:t.win,doc:t.doc},a=e.bind(function(){u=this._resolveWinDoc(u),n=YUI(u),n.host=this.get(i);try{n.use("node-base",s),r&&clearInterval(r)}catch(e){r=setInterval(function(){a()},350)}},this);o.push(a),e.use.apply(e,o)},this)),this)},_handleFocus:function(){var e=this.getInstance(),t=new e.EditorSelection,n,r,i,s;t.anchorNode&&(n=t.anchorNode,n.test("p")&&n.get("innerHTML")===""&&(n=n.get("parentNode")),r=n.get("childNodes"),r.size()&&(r.item(0).test("br")?t.selectNode(n,!0,!1):r.item(0).test("p")?(n=r.item(0).one("br.yui-cursor"),n&&(n=n.get("parentNode")),n||(n=r.item(0).get("firstChild")),n||(n=r.item(0)),n&&t.selectNode(n,!0,!1)):(i=e.one("br.yui-cursor"),i&&(s=i.get("parentNode"),s&&t.selectNode(s,!0,!1)))))},_validateLinkedCSS:function(e){return n.isString(e)||n.isArray(e)},focus:function(t){if(e.UA.ie&&e.UA.ie<9){try{e.one("win").focus(),this.getInstance()&&this.getInstance().one("win")&&this.getInstance().one("win").focus()}catch(n){}t===!0&&this._handleFocus(),e.Lang.isFunction(t)&&t()}else try{e.one("win").focus(),e.later(100,this,function(){this.getInstance()&&this.getInstance().one("win")&&this.getInstance().one("win").focus(),t===!0&&this._handleFocus(),e.Lang.isFunction(t)&&t()})}catch(r){}return this},show:function(){this._iframe.setStyles({position:"static",left:""});if(e.UA.gecko){try{this.getInstance()&&(this.getInstance().config.doc.designMode="on")}catch(t){}this.focus()}return this},hide:function(){return this._iframe.setStyles({position:"absolute",left:"-999999px"}),this}},{THROTTLE_TIME:100,DOM_EVENTS:{dblclick:1,click:1,paste:1,mouseup:1,mousedown:1,keyup:1,keydown:1,keypress:1,activate:1,deactivate:1,beforedeactivate:1,focusin:1,focusout:1},DEFAULT_CSS:"body { background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } img { cursor: pointer !important; border: none; }",IFRAME_ATTRS:{border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%",height:"99%"},PAGE_HTML:'<html dir="{DIR}" lang="{LANG}"><head><title>{TITLE}</title>{META}<base href="{BASE_HREF}"/>{LINKED_CSS}<style id="editor_css">{DEFAULT_CSS}</style>{EXTRA_CSS}</head><body>{CONTENT}</body></html>',getDocType:function(){var t=e.config.doc.doctype,n=s.DOC_TYPE;return t?n="<!DOCTYPE "+t.name+(t.publicId?" "+t.publicId:"")+(t.systemId?" "+t.systemId:"")+">":e.config.doc.all&&(t=e.config.doc.all[0],t.nodeType&&t.nodeType===8&&t.nodeValue&&t.nodeValue.toLowerCase().indexOf("doctype")!==-1&&(n="<!"+t.nodeValue+">")),n},DOC_TYPE:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',META:'<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=7">',NAME:"frame",NS:"frame",ATTRS:{title:{value:"Blank Page"},dir:{value:"ltr"},lang:{value:"en-US"},src:{value:"javascript"+(e.UA.ie?":false":":")+";"},designMode:{writeOnce:!0,value:!1},content:{validator:n.isString,value:"<br>",setter:"_setHTML",getter:"_getHTML"},basehref:{value:!1,getter:"_resolveBaseHref"},use:{writeOnce:!0,value:["node","node-style","selector-css3"]},container:{value:"body",setter:function(t){return e.one(t)}},node:{readOnly:!0,value:null,getter:function(){return this._iframe}},id:{writeOnce:!0,getter:function(t){return t||(t="iframe-"+e.guid()),t}},linkedcss:{validator:"_validateLinkedCSS",getter:"_getLinkedCSS",setter:"_setLinkedCSS"},extracss:{validator:n.isString,setter:"_setExtraCSS"},defaultblock:{value:"p"}}}),e.namespace("Plugin"),e.Plugin.Frame=s,e.Frame=s},"3.16.0",{requires:["base","node","plugin","selector-css3","yui-throttle"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("exec-command",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)},r=function(t,n,r){var i=this.getInstance(),s=i.config.doc,o=s.selection.createRange(),u=s.queryCommandValue(t),a,f,l,c,h,p,d;u&&(a=o.htmlText,f=new RegExp(r,"g"),l=a.match(f),l&&(a=a.replace(r+";","").replace(r,""),o.pasteHTML('<var id="yui-ie-bs">'),c=s.getElementById("yui-ie-bs"),h=s.createElement("div"),p=s.createElement(n),h.innerHTML=a,c.parentNode!==i.config.doc.body&&(c=c.parentNode),d=h.childNodes,c.parentNode.replaceChild(p,c),e.each(d,function(e){p.appendChild(e)}),o.collapse(),o.moveToElementText&&o.moveToElementText(p),o.select())),this._command(t)};e.extend(n,e.Base,{_lastKey:null,_inst:null,command:function(e,t){var r=n.COMMANDS[e];return r?r.call(this,e,t):this._command(e,t)},_command:function(e,t){var n=this.getInstance();try{try{n.config.doc.execCommand("styleWithCSS",null,1)}catch(r){try{n.config.doc.execCommand("useCSS",null,0)}catch(i){}}n.config.doc.execCommand(e,null,t)}catch(s){}},getInstance:function(){return this._inst||(this._inst=this.get("host").getInstance()),this._inst},initializer:function(){e.mix(this.get("host"),{execCommand:function(e,t){return this.exec.command(e,t)},_execCommand:function(e,t){return this.exec._command(e,t)}}),this.get("host").on("dom:keypress",e.bind(function(e){this._lastKey=e.keyCode},this))},_wrapContent:function(e,t){var n=this.getInstance().host.editorPara&&!t?!0:!1;return n?e="<p>"+e+"</p>":e+="<br>",e}},{NAME:"execCommand",NS:"exec",ATTRS:{host:{value:!1}},COMMANDS:{wrap:function(e,t){var n=this.getInstance();return(new n.EditorSelection).wrapContent(t)},inserthtml:function(t,n){var r=this.getInstance();if(r.EditorSelection.hasCursor()||e.UA.ie)return(new r.EditorSelection).insertContent(n);this._command("inserthtml",n)},insertandfocus:function(e,t){var n=this.getInstance(),r,i;return n.EditorSelection.hasCursor()?(t+=n.EditorSelection.CURSOR,r=this.command("inserthtml",t),i=new n.EditorSelection,i.focusCursor(!0,!0)):this.command("inserthtml",t),r},insertbr:function(){var t=this.getInstance(),n=new t.EditorSelection,r="<var>|</var>",i=null,s=t.EditorSelection.ROOT,o=e.UA.webkit?"span.Apple-style-span,var":"var",u=function(e){var n=t.Node.create("<br>");return e.insert(n,"before"),n};n._selection.pasteHTML?n._selection.pasteHTML(r):this._command("inserthtml",r),s.all(o).each(function(t){var n=!0,r;e.UA.webkit&&(n=!1,t.get("innerHTML")==="|"&&(n=!0)),n&&(i=u(t),(!i.previous()||!i.previous().test("br"))&&e.UA.gecko&&(r=i.cloneNode(),i.insert(r,"after"),i=r),t.remove())}),e.UA.webkit&&i&&(u(i),n.selectNode(i))},insertimage:function(e,t){return this.command("inserthtml",'<img src="'+t+'">')},addclass:function(e,t){var n=this.getInstance();return(new n.EditorSelection).getSelected().addClass(t)},removeclass:function(e,t){var n=this.getInstance();return(new n.EditorSelection).getSelected().removeClass(t)},forecolor:function(t,n){var r=this.getInstance(),i=new r.EditorSelection,s;e.UA.ie||this._command("useCSS",!1);if(r.EditorSelection.hasCursor())return i.isCollapsed?(i.anchorNode&&i.anchorNode.get("innerHTML")==="&nbsp;"?(i.anchorNode.setStyle("color",n),s=i.anchorNode):(s=this.command("inserthtml",'<span style="color: '+n+'">'+r.EditorSelection.CURSOR+"</span>"),i.focusCursor(!0,!0)),s):this._command(t,n);this._command(t,n)},backcolor:function(t,n){var r=this.getInstance(),i=new r.EditorSelection,s;if(e.UA.gecko||e.UA.opera)t="hilitecolor";e.UA.ie||this._command("useCSS",!1);if(r.EditorSelection.hasCursor())return i.isCollapsed?(i.anchorNode&&i.anchorNode.get("innerHTML")==="&nbsp;"?(i.anchorNode.setStyle("backgroundColor",n),s=i.anchorNode):(s=this.command("inserthtml",'<span style="background-color: '+n+'">'+r.EditorSelection.CURSOR+"</span>"),i.focusCursor(!0,!0)),s):this._command(t,n);this._command(t,n)},hilitecolor:function(){return n.COMMANDS.backcolor.apply(this,arguments)},fontname2:function(e,t){this._command("fontname",t);var n=this.getInstance(),r=new n.EditorSelection;r.isCollapsed&&this._lastKey!==32&&r.anchorNode.test("font")&&r.anchorNode.set("face",t)},fontsize2:function(t,n){this._command("fontsize",n);var r=this.getInstance(),i=new r.EditorSelection,s;i.isCollapsed&&i.anchorNode&&this._lastKey!==32&&(e.UA.webkit&&i.anchorNode.getStyle("lineHeight")&&i.anchorNode.setStyle("lineHeight",""),i.anchorNode.test("font")?i.anchorNode.set("size",n):e.UA.gecko&&(s=i.anchorNode.ancestor(r.EditorSelection.DEFAULT_BLOCK_TAG),s&&s.setStyle("fontSize","")))},insertunorderedlist:function(){this.command("list","ul")},insertorderedlist:function(){this.command("list","ol")},list:function(t,n){var r=this.getInstance(),i,s=this,o="dir",u="yui3-touched",a,f,l,c,h,p,d,v,m,g,y=r.host.editorPara?!0:!1,b,w,E,S,x=r.EditorSelection.ROOT,T=new r.EditorSelection;t="insert"+(n==="ul"?"un":"")+"orderedlist";if(e.UA.ie&&e.UA.ie<11&&!T.isCollapsed){f=T._selection,i=f.htmlText,l=r.Node.create(i)||x;if(l.test("li")||l.one("li")){this._command(t,null);return}l.test(n)?(c=f.item?f.item(0):f.parentElement(),h=r.one(c),g=h.all("li"),p="<div>",g.each(function(e){p=s._wrapContent(e.get("innerHTML"))}),p+="</div>",d=r.Node.create(p),h.get("parentNode").test("div")&&(h=h.get("parentNode")),h&&h.hasAttribute(o)&&(y?d.all("p").setAttribute(o,h.getAttribute(o)):d.setAttribute(o,h.getAttribute(o))),y?h.replace(d.get("innerHTML")):h.replace(d),f.moveToElementText&&f.moveToElementText(d._node),f.select()):(v=e.one(f.parentElement()),v.test(r.EditorSelection.BLOCKS)||(v=v.ancestor(r.EditorSelection.BLOCKS)),v&&v.hasAttribute(o)&&(a=v.getAttribute(o)),i.indexOf("<br>")>-1?i=i.split(/<br>/i):(b=r.Node.create(i),ps=b?b.all("p"):null,ps&&ps.size()?(i=[],ps.each(function(e){i.push(e.get("innerHTML"))})):i=[i]),m="<"+n+' id="ie-list">',e.each(i,function(e){var t=r.Node.create(e);t&&t.test("p")&&(t.hasAttribute(o)&&(a=t.getAttribute(o)),e=t.get("innerHTML")),m+="<li>"+e+"</li>"}),m+="</"+n+">",f.pasteHTML(m),c=r.config.doc.getElementById("ie-list"),c.id="",a&&c.setAttribute
(o,a),f.moveToElementText&&f.moveToElementText(c),f.select())}else e.UA.ie&&e.UA.ie<11?(v=r.one(T._selection.parentElement()),v.test("p")?(v&&v.hasAttribute(o)&&(a=v.getAttribute(o)),i=e.EditorSelection.getText(v),i===""?(w="",a&&(w=' dir="'+a+'"'),m=r.Node.create(e.Lang.sub("<{tag}{dir}><li></li></{tag}>",{tag:n,dir:w})),v.replace(m),T.selectNode(m.one("li"))):this._command(t,null)):this._command(t,null)):(x.all(n).addClass(u),T.anchorNode.test(r.EditorSelection.BLOCKS)?v=T.anchorNode:v=T.anchorNode.ancestor(r.EditorSelection.BLOCKS),v||(v=T.anchorNode.one(r.EditorSelection.BLOCKS)),v&&v.hasAttribute(o)&&(a=v.getAttribute(o)),v&&v.test(n)?(E=v.ancestor("p"),i=r.Node.create("<div/>"),c=v.all("li"),c.each(function(e){i.append(s._wrapContent(e.get("innerHTML"),E))}),a&&(y?i.all("p").setAttribute(o,a):i.setAttribute(o,a)),y&&(i=r.Node.create(i.get("innerHTML"))),S=i.get("firstChild"),v.replace(i),T.selectNode(S)):this._command(t,null),m=x.all(n),a&&m.size()&&m.each(function(e){e.hasClass(u)||e.setAttribute(o,a)}),m.removeClass(u))},justify:function(t,n){if(e.UA.webkit){var r=this.getInstance(),i=new r.EditorSelection,s=i.anchorNode,o,u=s.getStyle("backgroundColor");this._command(n),i=new r.EditorSelection,i.anchorNode.test("div")&&(o="<span>"+i.anchorNode.get("innerHTML")+"</span>",i.anchorNode.set("innerHTML",o),i.anchorNode.one("span").setStyle("backgroundColor",u),i.selectNode(i.anchorNode.one("span")))}else this._command(n)},justifycenter:function(){this.command("justify","justifycenter")},justifyleft:function(){this.command("justify","justifyleft")},justifyright:function(){this.command("justify","justifyright")},justifyfull:function(){this.command("justify","justifyfull")}}}),e.UA.ie&&e.UA.ie<11&&(n.COMMANDS.bold=function(){r.call(this,"bold","b","FONT-WEIGHT: bold")},n.COMMANDS.italic=function(){r.call(this,"italic","i","FONT-STYLE: italic")},n.COMMANDS.underline=function(){r.call(this,"underline","u","TEXT-DECORATION: underline")}),e.namespace("Plugin"),e.Plugin.ExecCommand=n},"3.16.0",{requires:["frame"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("editor-selection",function(e,t){var n="textContent",r="innerHTML",i="fontFamily";e.UA.ie&&e.UA.ie<11&&(n="nodeValue"),e.EditorSelection=function(t){var n,r,i,s,o,u,a,f=0,l,c,h=e.EditorSelection.ROOT;e.config.win.getSelection&&(!e.UA.ie||e.UA.ie>8)?n=e.config.win.getSelection():e.config.doc.selection&&(n=e.config.doc.selection.createRange()),this._selection=n;if(!n)return!1;if(n.pasteHTML){this.isCollapsed=n.compareEndPoints("StartToEnd",n)?!1:!0;if(this.isCollapsed){this.anchorNode=this.focusNode=e.one(n.parentElement()),t&&(i=e.config.doc.elementFromPoint(t.clientX,t.clientY)),o=n.duplicate();if(!i){r=n.parentElement(),s=r.childNodes;for(u=0;u<s.length;u++)o.inRange(n)&&(i||(i=s[u]))}this.ieNode=i,i&&(i.nodeType!==3&&(i.firstChild&&(i=i.firstChild),h.compareTo(i)&&i.firstChild&&(i=i.firstChild)),this.anchorNode=this.focusNode=e.EditorSelection.resolve(i),o.moveToElementText(n.parentElement()),a=n.compareEndPoints("StartToStart",o),a&&(f=this.getEditorOffset(h),n.move("character",-f)),this.anchorOffset=this.focusOffset=f,this.anchorTextNode=this.focusTextNode=e.one(i))}else n.htmlText&&n.htmlText!==""&&(l=e.Node.create(n.htmlText),l&&l.get("id")?(c=l.get("id"),this.anchorNode=this.focusNode=e.one("#"+c)):l&&(l=l.get("childNodes"),this.anchorNode=this.focusNode=l.item(0)))}else this.isCollapsed=n.isCollapsed,this.anchorNode=e.EditorSelection.resolve(n.anchorNode),this.focusNode=e.EditorSelection.resolve(n.focusNode),this.anchorOffset=n.anchorOffset,this.focusOffset=n.focusOffset,this.anchorTextNode=e.one(n.anchorNode||this.anchorNode),this.focusTextNode=e.one(n.focusNode||this.focusNode);e.Lang.isString(n.text)?this.text=n.text:n.toString?this.text=n.toString():this.text=""},e.EditorSelection.removeFontFamily=function(t){t.removeAttribute("face");var n=t.getAttribute("style").toLowerCase();(n===""||n==="font-family: ")&&t.removeAttribute("style"),n.match(e.EditorSelection.REG_FONTFAMILY)&&(n=n.replace(e.EditorSelection.REG_FONTFAMILY,""),t.setAttribute("style",n))},e.EditorSelection.filter=function(t){var n=(new Date).getTime(),r=e.EditorSelection,s=r.ROOT,o,u=s.all(r.ALL),a=s.all("strong,em"),f=e.config.doc,l,c={},h="",p,d=(new Date).getTime(),v;u.each(function(t){var n=e.Node.getDOMNode(t);n.style[i]&&(c["."+t._yuid]=n.style[i],t.addClass(t._yuid),r.removeFontFamily(n))}),v=(new Date).getTime(),s.all(".hr").addClass("yui-skip").addClass("yui-non"),e.UA.ie&&(l=e.Node.getDOMNode(s).getElementsByTagName("hr"),e.each(l,function(e){var t=f.createElement("div"),n=t.style;t.className="hr yui-non yui-skip",t.setAttribute("readonly",!0),t.setAttribute("contenteditable",!1),e.parentNode&&e.parentNode.replaceChild(t,e),n.border="1px solid #ccc",n.lineHeight="0",n.height="0",n.fontSize="0",n.marginTop="5px",n.marginBottom="5px",n.marginLeft="0px",n.marginRight="0px",n.padding="0"})),e.each(c,function(e,t){h+=t+" { font-family: "+e.replace(/"/gi,"")+"; }"}),e.StyleSheet(h,"editor"),a.each(function(e,t){var n=e.get("tagName").toLowerCase(),i="i";n==="strong"&&(i="b"),r.prototype._swap(a.item(t),i)}),p=s.all("ol,ul"),p.each(function(e){var t=e.all("li");t.size()||e.remove()}),t&&r.filterBlocks(),o=(new Date).getTime()},e.EditorSelection.filterBlocks=function(){var t=(new Date).getTime(),r,i=e.Node.getDOMNode(e.EditorSelection.ROOT).childNodes,s,o,u=!1,a=!0,f,l,c,h,p,d;if(i){for(s=0;s<i.length;s++)o=e.one(i[s]),o.test(e.EditorSelection.BLOCKS)?u=e.EditorSelection._wrapBlock(u):(a=!0,i[s].nodeType===3&&(h=i[s][n].match(e.EditorSelection.REG_CHAR),p=i[s][n].match(e.EditorSelection.REG_NON),h===null&&p&&(a=!1)),a&&(u||(u=[]),u.push(i[s])));u=e.EditorSelection._wrapBlock(u)}l=e.all(e.EditorSelection.DEFAULT_BLOCK_TAG);if(l.size()===1){c=l.item(0).all("br");if(c.size()===1){c.item(0).test(".yui-cursor")||c.item(0).remove(),d=l.item(0).get("innerHTML");if(d===""||d===" ")l.set("innerHTML",e.EditorSelection.CURSOR),f=new e.EditorSelection,f.focusCursor(!0,!0);c.item(0).test(".yui-cursor")&&e.UA.ie&&c.item(0).remove()}}else l.each(function(e){var t=e.get("innerHTML");t===""&&e.remove()});r=(new Date).getTime()},e.EditorSelection.REG_FONTFAMILY=/font-family:\s*;/,e.EditorSelection.REG_CHAR=/[a-zA-Z-0-9_!@#\$%\^&*\(\)-=_+\[\]\\{}|;':",.\/<>\?]/gi,e.EditorSelection.REG_NON=/[\s|\n|\t]/gi,e.EditorSelection.REG_NOHTML=/<\S[^><]*>/g,e.EditorSelection._wrapBlock=function(t){if(t){var n=e.Node.create("<"+e.EditorSelection.DEFAULT_BLOCK_TAG+"></"+e.EditorSelection.DEFAULT_BLOCK_TAG+">"),r=e.one(t[0]),i;for(i=1;i<t.length;i++)n.append(t[i]);r.replace(n),n.prepend(r)}return!1},e.EditorSelection.unfilter=function(){var t=e.EditorSelection.ROOT,n=t.all("[class]"),r="",s,o,u=t;return n.each(function(e){e.hasClass(e._yuid)&&(e.setStyle(i,e.getStyle(i)),e.removeClass(e._yuid),e.getAttribute("class")===""&&e.removeAttribute("class"))}),s=t.all(".yui-non"),s.each(function(e){!e.hasClass("yui-skip")&&e.get("innerHTML")===""?e.remove():e.removeClass("yui-non").removeClass("yui-skip")}),o=t.all("[id]"),o.each(function(e){e.get("id").indexOf("yui_3_")===0&&(e.removeAttribute("id"),e.removeAttribute("_yuid"))}),u&&(r=u.get("innerHTML")),t.all(".hr").addClass("yui-skip").addClass("yui-non"),r},e.EditorSelection.resolve=function(t){if(!t)return e.EditorSelection.ROOT;if(t&&t.nodeType===3)try{t=t.parentNode}catch(n){t=e.EditorSelection.ROOT}return e.one(t)},e.EditorSelection.getText=function(t){var n=t.get("innerHTML").replace(e.EditorSelection.REG_NOHTML,"");return n=n.replace("<span><br></span>","").replace("<br>",""),n},e.EditorSelection.DEFAULT_BLOCK_TAG="p",e.EditorSelection.ALL="[style],font[face]",e.EditorSelection.BLOCKS="p,div,ul,ol,table,style",e.EditorSelection.TMP="yui-tmp",e.EditorSelection.DEFAULT_TAG="span",e.EditorSelection.CURID="yui-cursor",e.EditorSelection.CUR_WRAPID="yui-cursor-wrapper",e.EditorSelection.CURSOR='<span><br class="yui-cursor"></span>',e.EditorSelection.ROOT=e.one("body"),e.EditorSelection.hasCursor=function(){var t=e.all("#"+e.EditorSelection.CUR_WRAPID);return t.size()},e.EditorSelection.cleanCursor=
function(){var t,n="br.yui-cursor";t=e.all(n),t.size()&&t.each(function(t){var n=t.get("parentNode.parentNode.childNodes"),r;n.size()?t.remove():(r=e.EditorSelection.getText(n.item(0)),r!==""&&t.remove())})},e.EditorSelection.prototype={text:null,isCollapsed:null,anchorNode:null,anchorOffset:null,anchorTextNode:null,focusNode:null,focusOffset:null,focusTextNode:null,_selection:null,_wrap:function(t,n){var i=e.Node.create("<"+n+"></"+n+">");return i.set(r,t.get(r)),t.set(r,""),t.append(i),e.Node.getDOMNode(i)},_swap:function(t,n){var i=e.Node.create("<"+n+"></"+n+">");return i.set(r,t.get(r)),t.replace(i,t),e.Node.getDOMNode(i)},getSelected:function(){var t=e.EditorSelection,n=t.ROOT,r,s=[];return t.filter(),e.config.doc.execCommand("fontname",null,t.TMP),r=n.all(t.ALL),r.each(function(o,u){o.getStyle(i)===t.TMP&&(o.setStyle(i,""),t.removeFontFamily(o),o.compareTo(n)||s.push(e.Node.getDOMNode(r.item(u))))}),e.all(s)},insertContent:function(e){return this.insertAtCursor(e,this.anchorTextNode,this.anchorOffset,!0)},insertAtCursor:function(t,r,i,s){var o=e.Node.create("<"+e.EditorSelection.DEFAULT_TAG+' class="yui-non"></'+e.EditorSelection.DEFAULT_TAG+">"),u,a,f,l,c=this.createRange(),h,p=e.EditorSelection.ROOT;p.compareTo(r)&&(h=e.Node.create("<span></span>"),r.append(h),r=h);if(c.pasteHTML){if(i===0&&r&&!r.previous()&&r.get("nodeType")===3)return r.insert(t,"before"),c.moveToElementText&&c.moveToElementText(e.Node.getDOMNode(r.previous())),c.collapse(!1),c.select(),r.previous();l=e.Node.create(t);try{c.pasteHTML('<span id="rte-insert"></span>')}catch(d){}u=p.one("#rte-insert");if(u)return u.set("id",""),u.replace(l),c.moveToElementText&&c.moveToElementText(e.Node.getDOMNode(l)),c.collapse(!1),c.select(),l;e.on("available",function(){u.set("id",""),u.replace(l),c.moveToElementText&&c.moveToElementText(e.Node.getDOMNode(l)),c.collapse(!1),c.select()},"#rte-insert")}else i>0?(u=r.get(n),a=e.one(e.config.doc.createTextNode(u.substr(0,i))),f=e.one(e.config.doc.createTextNode(u.substr(i))),r.replace(a,r),l=e.Node.create(t),l.get("nodeType")===11&&(h=e.Node.create("<span></span>"),h.append(l),l=h),a.insert(l,"after"),f&&(l.insert(o,"after"),o.insert(f,"after"),this.selectNode(o,s))):(r.get("nodeType")===3&&(r=r.get("parentNode")||p),l=e.Node.create(t),t=r.get("innerHTML").replace(/\n/gi,""),t===""||t==="<br>"?r.append(l):l.get("parentNode")?r.insert(l,"before"):p.prepend(l),r.get("firstChild").test("br")&&r.get("firstChild").remove());return l},wrapContent:function(t){t=t?t:e.EditorSelection.DEFAULT_TAG;if(!this.isCollapsed){var n=this.getSelected(),r=[],i,s,o,u;return n.each(function(e,i){var s=e.get("tagName").toLowerCase();s==="font"?r.push(this._swap(n.item(i),t)):r.push(this._wrap(n.item(i),t))},this),i=this.createRange(),o=r[0],s=r[r.length-1],this._selection.removeAllRanges?(i.setStart(r[0],0),i.setEnd(s,s.childNodes.length),this._selection.removeAllRanges(),this._selection.addRange(i)):(i.moveToElementText&&(i.moveToElementText(e.Node.getDOMNode(o)),u=this.createRange(),u.moveToElementText(e.Node.getDOMNode(s)),i.setEndPoint("EndToEnd",u)),i.select()),r=e.all(r),r}return e.all([])},replace:function(t,r){var i=this.createRange(),s,o,u,a;return i.getBookmark?(u=i.getBookmark(),o=this.anchorNode.get("innerHTML").replace(t,r),this.anchorNode.set("innerHTML",o),i.moveToBookmark(u),a=e.one(i.parentElement())):(s=this.anchorTextNode,o=s.get(n),u=o.indexOf(t),o=o.replace(t,""),s.set(n,o),a=this.insertAtCursor(r,s,u,!0)),a},remove:function(){return this._selection&&this._selection.removeAllRanges&&this._selection.removeAllRanges(),this},createRange:function(){return e.config.doc.selection?e.config.doc.selection.createRange():e.config.doc.createRange()},selectNode:function(t,n,r){if(!t)return;r=r||0,t=e.Node.getDOMNode(t);var i=this.createRange();if(i.selectNode){try{i.selectNode(t)}catch(s){}this._selection.removeAllRanges(),this._selection.addRange(i);if(n)try{this._selection.collapse(t,r)}catch(s){this._selection.collapse(t,0)}}else{t.nodeType===3&&(t=t.parentNode);try{i.moveToElementText(t)}catch(o){}n&&i.collapse(r?!1:!0),i.select()}return this},setCursor:function(){return this.removeCursor(!1),this.insertContent(e.EditorSelection.CURSOR)},getCursor:function(){var t=e.EditorSelection.ROOT.all("."+e.EditorSelection.CURID);return t.isEmpty()?null:t.get("parentNode")},removeCursor:function(t){var n=this.getCursor();return n&&!t&&n.all("."+e.EditorSelection.CURID).remove(),n},focusCursor:function(e,t){e!==!1&&(e=!0),t!==!1&&(t=!0);var n=this.removeCursor(!0);n&&n.each(function(n){this.selectNode(n,e,t)},this)},toString:function(){return"EditorSelection Object"},getEditorOffset:function(t){var n=(t||e.EditorSelection.ROOT).getDOMNode(),r=0,i=e.config.doc,s=e.config.win,o,u,a;return typeof s.getSelection!="undefined"?(u=s.getSelection().getRangeAt(0),a=u.cloneRange(),a.selectNodeContents(n),a.setEnd(u.endContainer,u.endOffset),r=a.toString().length):(o=i.selection,o&&o.type!=="Control"&&(u=o.createRange(),a=i.body.createTextRange(),a.moveToElementText(n),a.setEndPoint("EndToEnd",u),r=a.text.length)),r}},e.Selection=e.EditorSelection},"3.16.0",{requires:["node"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("editor-base",function(e,t){var n=e.Lang,r=function(){r.superclass.constructor.apply(this,arguments)},i=":last-child";e.extend(r,e.Base,{frame:null,initializer:function(){this.publish("nodeChange",{emitFacade:!0,bubbles:!0,defaultFn:this._defNodeChangeFn})},destructor:function(){this.detachAll()},copyStyles:function(t,n){if(t.test("a"))return;var r=["color","fontSize","fontFamily","backgroundColor","fontStyle"],i={};e.each(r,function(e){i[e]=t.getStyle(e)}),t.ancestor("b,strong")&&(i.fontWeight="bold"),t.ancestor("u")&&(i.textDecoration||(i.textDecoration="underline")),n.setStyles(i)},_lastBookmark:null,_resolveChangedNode:function(e){var t=this.getInstance(),n,r,s,o=this._getRoot(),u;e&&e.compareTo(o)&&(u=new t.EditorSelection,u&&u.anchorNode&&(e=u.anchorNode));if(t&&e&&e.test("html")){n=o.one(i);while(!s)n?(r=n.one(i),r?n=r:s=!0):s=!0;n&&(n.test("br")&&(n.previous()?n=n.previous():n=n.get("parentNode")),n&&(e=n))}return e||(e=o),e},_getRoot:function(){return this.getInstance().EditorSelection.ROOT},_defNodeChangeFn:function(t){var n=(new Date).getTime(),i=this.getInstance(),s,o,u,a={},f,l,c=[],h="",p="",d,v=!1,m=this._getRoot();if(e.UA.ie&&e.UA.ie<11)try{s=i.config.doc.selection.createRange(),s.getBookmark&&(this._lastBookmark=s.getBookmark())}catch(g){}t.changedNode=this._resolveChangedNode(t.changedNode);switch(t.changedType){case"backspace-up":e.UA.webkit&&t.changedNode&&t.changedNode.set("innerHTML",t.changedNode.get("innerHTML"))}e.UA.webkit&&t.commands&&(t.commands.indent||t.commands.outdent)&&(d=m.all(".webkit-indent-blockquote, blockquote"),d.size()&&d.setStyle("margin","")),o=this.getDomPath(t.changedNode,!1),t.commands&&(a=t.commands),e.each(o,function(t){var n=t.tagName.toLowerCase(),s=r.TAG2CMD[n],o,u,d,m,g;s&&(a[s]=1),o=t.currentStyle||t.style,""+o.fontWeight=="normal"&&(v=!0),""+o.fontWeight=="bold"&&(a.bold=1),e.UA.ie&&o.fontWeight>400&&(a.bold=1),o.fontStyle==="italic"&&(a.italic=1),o.textDecoration.indexOf("underline")>-1&&(a.underline=1),o.textDecoration.indexOf("line-through")>-1&&(a.strikethrough=1),u=i.one(t),u.getStyle("fontFamily")&&(d=u.getStyle("fontFamily").split(",")[0].toLowerCase(),d&&(f=d),f&&(f=f.replace(/'/g,"").replace(/"/g,""))),l=r.NORMALIZE_FONTSIZE(u),m=t.className.split(" "),e.each(m,function(e){e!==""&&e.substr(0,4)!=="yui_"&&c.push(e)}),h=r.FILTER_RGB(u.getStyle("color")),g=r.FILTER_RGB(o.backgroundColor),g!=="transparent"&&g!==""&&(p=g)}),v&&(delete a.bold,delete a.italic),t.dompath=i.all(o),t.classNames=c,t.commands=a,t.fontFamily||(t.fontFamily=f),t.fontSize||(t.fontSize=l),t.fontColor||(t.fontColor=h),t.backgroundColor||(t.backgroundColor=p),u=(new Date).getTime()},getDomPath:function(e,t){var n=[],r,i,s=this._getRoot(),o=this.frame.getInstance();r=o.Node.getDOMNode(e),i=o.Node.getDOMNode(s);while(r!==null){if(r===o.config.doc.documentElement||r===o.config.doc||!r.tagName){r=null;break}if(!o.DOM.inDoc(r)){r=null;break}r.nodeName&&r.nodeType&&r.nodeType===1&&n.push(r);if(r===i){r=null;break}r=r.parentNode}return n.length===0&&(n[0]=o.config.doc.body),t?o.all(n.reverse()):n.reverse()},_afterFrameReady:function(){var t=this.frame.getInstance();this.frame.on("dom:mouseup",e.bind(this._onFrameMouseUp,this)),this.frame.on("dom:mousedown",e.bind(this._onFrameMouseDown,this)),this.frame.on("dom:keydown",e.bind(this._onFrameKeyDown,this)),e.UA.ie&&e.UA.ie<11&&(this.frame.on("dom:activate",e.bind(this._onFrameActivate,this)),this.frame.on("dom:beforedeactivate",e.bind(this._beforeFrameDeactivate,this))),this.frame.on("dom:keyup",e.bind(this._onFrameKeyUp,this)),this.frame.on("dom:keypress",e.bind(this._onFrameKeyPress,this)),this.frame.on("dom:paste",e.bind(this._onPaste,this)),t.EditorSelection.filter(),this.fire("ready")},_beforeFrameDeactivate:function(e){if(e.frameTarget.test("html"))return;var t=this.getInstance(),n=t.config.doc.selection.createRange();n.compareEndPoints&&!n.compareEndPoints("StartToEnd",n)&&n.pasteHTML('<var id="yui-ie-cursor">')},_onFrameActivate:function(e){if(e.frameTarget.test("html"))return;var t=this.getInstance(),n=new t.EditorSelection,r=n.createRange(),i=this._getRoot(),s=i.all("#yui-ie-cursor");s.size()&&s.each(function(e){e.set("id","");if(r.moveToElementText)try{r.moveToElementText(e._node);var t=r.move("character",-1);t===-1&&r.move("character",1),r.select(),r.text=""}catch(n){}e.remove()})},_onPaste:function(e){this.fire("nodeChange",{changedNode:e.frameTarget,changedType:"paste",changedEvent:e.frameEvent})},_onFrameMouseUp:function(e){this.fire("nodeChange",{changedNode:e.frameTarget,changedType:"mouseup",changedEvent:e.frameEvent})},_onFrameMouseDown:function(e){this.fire("nodeChange",{changedNode:e.frameTarget,changedType:"mousedown",changedEvent:e.frameEvent})},_currentSelection:null,_currentSelectionTimer:null,_currentSelectionClear:null,_onFrameKeyDown:function(t){var n,i;this._currentSelection?i=this._currentSelection:(this._currentSelectionTimer&&this._currentSelectionTimer.cancel(),this._currentSelectionTimer=e.later(850,this,function(){this._currentSelectionClear=!0}),n=this.frame.getInstance(),i=new n.EditorSelection(t),this._currentSelection=i),n=this.frame.getInstance(),i=new n.EditorSelection,this._currentSelection=i,i&&i.anchorNode&&(this.fire("nodeChange",{changedNode:i.anchorNode,changedType:"keydown",changedEvent:t.frameEvent}),r.NC_KEYS[t.keyCode]&&(this.fire("nodeChange",{changedNode:i.anchorNode,changedType:r.NC_KEYS[t.keyCode],changedEvent:t.frameEvent}),this.fire("nodeChange",{changedNode:i.anchorNode,changedType:r.NC_KEYS[t.keyCode]+"-down",changedEvent:t.frameEvent})))},_onFrameKeyPress:function(e){var t=this._currentSelection;t&&t.anchorNode&&(this.fire("nodeChange",{changedNode:t.anchorNode,changedType:"keypress",changedEvent:e.frameEvent}),r.NC_KEYS[e.keyCode]&&this.fire("nodeChange",{changedNode:t.anchorNode,changedType:r.NC_KEYS[e.keyCode]+"-press",changedEvent:e.frameEvent}))},_onFrameKeyUp:function(e){var t=this.frame.getInstance(),n=new t.EditorSelection(e);n&&n.anchorNode&&(this
.fire("nodeChange",{changedNode:n.anchorNode,changedType:"keyup",selection:n,changedEvent:e.frameEvent}),r.NC_KEYS[e.keyCode]&&this.fire("nodeChange",{changedNode:n.anchorNode,changedType:r.NC_KEYS[e.keyCode]+"-up",selection:n,changedEvent:e.frameEvent})),this._currentSelectionClear&&(this._currentSelectionClear=this._currentSelection=null)},_validateLinkedCSS:function(e){return n.isString(e)||n.isArray(e)},execCommand:function(e,t){var n=this.frame.execCommand(e,t),r=this.frame.getInstance(),i=new r.EditorSelection,s={},o={changedNode:i.anchorNode,changedType:"execcommand",nodes:n};switch(e){case"forecolor":o.fontColor=t;break;case"backcolor":o.backgroundColor=t;break;case"fontsize":o.fontSize=t;break;case"fontname":o.fontFamily=t}return s[e]=1,o.commands=s,this.fire("nodeChange",o),n},getInstance:function(){return this.frame.getInstance()},render:function(t){var n=this.frame;return n||(this.plug(e.Plugin.Frame,{designMode:!0,title:r.STRINGS.title,use:r.USE,dir:this.get("dir"),extracss:this.get("extracss"),linkedcss:this.get("linkedcss"),defaultblock:this.get("defaultblock")}),n=this.frame),n.hasPlugin("exec")||n.plug(e.Plugin.ExecCommand),n.after("ready",e.bind(this._afterFrameReady,this)),n.addTarget(this),n.set("content",this.get("content")),n.render(t),this},focus:function(e){return this.frame.focus(e),this},show:function(){return this.frame.show(),this},hide:function(){return this.frame.hide(),this},getContent:function(){var e="",t=this.getInstance();return t&&t.EditorSelection&&(e=t.EditorSelection.unfilter()),e=e.replace(/ _yuid="([^>]*)"/g,""),e}},{NORMALIZE_FONTSIZE:function(e){var t=e.getStyle("fontSize"),n=t;switch(t){case"-webkit-xxx-large":t="48px";break;case"xx-large":t="32px";break;case"x-large":t="24px";break;case"large":t="18px";break;case"medium":t="16px";break;case"small":t="13px";break;case"x-small":t="10px"}return n!==t&&e.setStyle("fontSize",t),t},TABKEY:'<span class="tab">&nbsp;&nbsp;&nbsp;&nbsp;</span>',FILTER_RGB:function(e){if(e.toLowerCase().indexOf("rgb")!==-1){var t=new RegExp("(.*?)rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)(.*?)","gi"),n=e.replace(t,"$1,$2,$3,$4,$5").split(","),r,i,s;n.length===5&&(r=parseInt(n[1],10).toString(16),i=parseInt(n[2],10).toString(16),s=parseInt(n[3],10).toString(16),r=r.length===1?"0"+r:r,i=i.length===1?"0"+i:i,s=s.length===1?"0"+s:s,e="#"+r+i+s)}return e},TAG2CMD:{b:"bold",strong:"bold",i:"italic",em:"italic",u:"underline",sup:"superscript",sub:"subscript",img:"insertimage",a:"createlink",ul:"insertunorderedlist",ol:"insertorderedlist"},NC_KEYS:{8:"backspace",9:"tab",13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete"},USE:["node","selector-css3","editor-selection","stylesheet"],NAME:"editorBase",STRINGS:{title:"Rich Text Editor"},ATTRS:{content:{validator:n.isString,value:'<br class="yui-cursor">',setter:function(t){return t.substr(0,1)==="\n"&&(t=t.substr(1)),t===""&&(t='<br class="yui-cursor">'),t===" "&&e.UA.gecko&&(t='<br class="yui-cursor">'),this.frame.set("content",t)},getter:function(){return this.frame.get("content")}},dir:{validator:n.isString,writeOnce:!0,value:"ltr"},linkedcss:{validator:"_validateLinkedCSS",value:"",setter:function(e){return this.frame&&this.frame.set("linkedcss",e),e}},extracss:{validator:n.isString,value:"",setter:function(e){return this.frame&&this.frame.set("extracss",e),e}},defaultblock:{validator:n.isString,value:"p"}}}),e.EditorBase=r},"3.16.0",{requires:["base","frame","node","exec-command","editor-selection"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("stylesheet",function(e,t){function v(t,r){var o,a,f,l={},h,p,m,g,y,b;if(!e.instanceOf(this,v))return new v(t,r);if(t){if(e.Node&&t instanceof e.Node)a=t._node;else if(t.nodeName)a=t;else if(s(t)){if(t&&u[t])return u[t];a=n.getElementById(t.replace(/^#/,d))}if(a&&u[e.stamp(a)])return u[e.stamp(a)]}if(!a||!/^(?:style|link)$/i.test(a.nodeName))a=n.createElement("style"),a.type="text/css";s(t)&&(t.indexOf("{")!=-1?a.styleSheet?a.styleSheet.cssText=t:a.appendChild(n.createTextNode(t)):r||(r=t));if(!a.parentNode||a.parentNode.nodeName.toLowerCase()!=="head")o=(a.ownerDocument||n).getElementsByTagName("head")[0],o.appendChild(a);f=a.sheet||a.styleSheet,h=f&&"cssRules"in f?"cssRules":"rules",m="deleteRule"in f?function(e){f.deleteRule(e)}:function(e){f.removeRule(e)},p="insertRule"in f?function(e,t,n){f.insertRule(e+" {"+t+"}",n)}:function(e,t,n){f.addRule(e,t,n)};for(g=f[h].length-1;g>=0;--g)y=f[h][g],b=y.selectorText,l[b]?(l[b].style.cssText+=";"+y.style.cssText,m(g)):l[b]=y;v.register(e.stamp(a),this),r&&v.register(r,this),e.mix(this,{getId:function(){return e.stamp(a)},enable:function(){return f.disabled=!1,this},disable:function(){return f.disabled=!0,this},isEnabled:function(){return!f.disabled},set:function(e,t){var n=l[e],r=e.split(/\s*,\s*/),i,s;if(r.length>1){for(i=r.length-1;i>=0;--i)this.set(r[i],t);return this}return v.isValidSelector(e)?(n?n.style.cssText=v.toCssText(t,n.style.cssText):(s=f[h].length,t=v.toCssText(t),t&&(p(e,t,s),l[e]=f[h][s])),this):this},unset:function(t,n){var r=l[t],s=t.split(/\s*,\s*/),o=!n,u,a;if(s.length>1){for(a=s.length-1;a>=0;--a)this.unset(s[a],n);return this}if(r){if(!o){n=e.Array(n),i.cssText=r.style.cssText;for(a=n.length-1;a>=0;--a)c(i,n[a]);i.cssText?r.style.cssText=i.cssText:o=!0}if(o){u=f[h];for(a=u.length-1;a>=0;--a)if(u[a]===r){delete l[t],m(a);break}}}return this},getCssText:function(e){var t,n,r;if(s(e))return t=l[e.split(/\s*,\s*/)[0]],t?t.style.cssText:null;n=[];for(r in l)l.hasOwnProperty(r)&&(t=l[r],n.push(t.selectorText+" {"+t.style.cssText+"}"));return n.join("\n")}})}var n=e.config.doc,r=n.createElement("p"),i=r.style,s=e.Lang.isString,o={},u={},a="cssFloat"in i?"cssFloat":"styleFloat",f,l,c,h="opacity",p="float",d="";l=h in i?function(e){e.opacity=d}:function(e){e.filter=d},i.border="1px solid red",i.border=d,c=i.borderLeft?function(e,t){var n;t!==a&&t.toLowerCase().indexOf(p)!=-1&&(t=a);if(s(e[t]))switch(t){case h:case"filter":l(e);break;case"font":e.font=e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=e.lineHeight=e.fontFamily=d;break;default:for(n in e)n.indexOf(t)===0&&(e[n]=d)}}:function(e,t){t!==a&&t.toLowerCase().indexOf(p)!=-1&&(t=a),s(e[t])&&(t===h?l(e):e[t]=d)},f=function(t,s){var o=t.styleFloat||t.cssFloat||t[p],u=e.Lang.trim,f;try{i.cssText=s||d}catch(l){r=n.createElement("p"),i=r.style,i.cssText=s||d}o&&!t[a]&&(t=e.merge(t),delete t.styleFloat,delete t.cssFloat,delete t[p],t[a]=o);for(f in t)if(t.hasOwnProperty(f))try{i[f]=u(t[f])}catch(c){}return i.cssText},e.mix(v,{toCssText:h in i?f:function(t,n){return h in t&&(t=e.merge(t,{filter:"alpha(opacity="+t.opacity*100+")"}),delete t.opacity),f(t,n)},register:function(e,t){return!!(e&&t instanceof v&&!u[e]&&(u[e]=t))},isValidSelector:function(e){var t=!1;return e&&s(e)&&(o.hasOwnProperty(e)||(o[e]=!/\S/.test(e.replace(/\s+|\s*[+~>]\s*/g," ").replace(/([^ ])\[.*?\]/g,"$1").replace(/([^ ])::?[a-z][a-z\-]+[a-z](?:\(.*?\))?/ig,"$1").replace(/(?:^| )[a-z0-6]+/ig," ").replace(/\\./g,d).replace(/[.#]\w[\w\-]*/g,d))),t=o[e]),t}},!0),e.StyleSheet=v},"3.16.0",{requires:["yui-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("content-editable",function(e,t){var n=e.Lang,r=e.Node,i="contentready",s="ready",o="p",u="blur",a="container",f="contentEditable",l="",c="focus",h="host",p="innerHTML",d="key",v="parentNode",m="paste",g="Text",y="use",b=function(){b.superclass.constructor.apply(this,arguments)};e.extend(b,e.Plugin.Base,{_rendered:null,_instance:null,initializer:function(){var e=this.get(h);e&&(e.frame=this),this._eventHandles=[],this.publish(s,{emitFacade:!0,defaultFn:this._defReadyFn})},destructor:function(){(new e.EventHandle(this._eventHandles)).detach(),this._container.removeAttribute(f)},_onDomEvent:function(e){var t;e.frameX=e.frameY=0,(e.pageX>0||e.pageY>0)&&e.type.substring(0,3)!==d&&(t=this._container.getXY(),e.frameX=t[0],e.frameY=t[1]),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,this.fire("dom:"+e.type,e)},_DOMPaste:function(e){var t=this.getInstance(),n=l,r=t.config.win;e._event.originalTarget&&(n=e._event.originalTarget),e._event.clipboardData&&(n=e._event.clipboardData.getData(g)),r.clipboardData&&(n=r.clipboardData.getData(g),n===l&&(r.clipboardData.setData(g,n)||(n=null))),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,n?e.clipboardData={data:n,getData:function(){return n}}:e.clipboardData=null,this.fire("dom:paste",e)},_defReadyFn:function(){var t=this.getInstance(),n=this.get(a);e.each(b.DOM_EVENTS,function(r,i){var s=e.bind(this._onDomEvent,this),o=e.UA.ie&&b.THROTTLE_TIME>0?e.throttle(s,b.THROTTLE_TIME):s;t.Node.DOM_EVENTS[i]||(t.Node.DOM_EVENTS[i]=1),r===1&&i!==c&&i!==u&&i!==m&&(i.substring(0,3)===d?this._eventHandles.push(n.on(i,o,n)):this._eventHandles.push(n.on(i,s,n)))},this),t.Node.DOM_EVENTS.paste=1,this._eventHandles.push(n.on(m,e.bind(this._DOMPaste,this),n),n.on(c,e.bind(this._onDomEvent,this),n),n.on(u,e.bind(this._onDomEvent,this),n)),t.__use=t.use,t.use=e.bind(this.use,this)},_onContentReady:function(t){if(!this._ready){this._ready=!0;var n=this.getInstance(),o=e.clone(this.get(y));this.fire(i),t&&(n.config.doc=r.getDOMNode(t.target)),o.push(e.bind(function(){n.EditorSelection&&(n.EditorSelection.DEFAULT_BLOCK_TAG=this.get("defaultblock"),n.EditorSelection.ROOT=this.get(a)),this.fire(s)},this)),n.use.apply(n,o)}},_getDefaultBlock:function(){return this._getHostValue("defaultblock")},_getDir:function(){return this._getHostValue("dir")},_getExtraCSS:function(){return this._getHostValue("extracss")},_getHTML:function(){var e,t;return this._ready&&(t=this.get(a),e=t.get(p)),e},_getHostValue:function(e){var t=this.get(h);if(t)return t.get(e)},_setHTML:function(t){if(this._ready){var n=this.get(a);n.set(p,t)}else this.once(i,e.bind(this._setHTML,this,t));return t},_setLinkedCSS:function(t){if(this._ready){var n=this.getInstance();n.Get.css(t)}else this.once(i,e.bind(this._setLinkedCSS,this,t));return t},_setDir:function(t){var n;return this._ready?(n=this.get(a),n.setAttribute("dir",t)):this.once(i,e.bind(this._setDir,this,t)),t},_setExtraCSS:function(t){if(this._ready){if(t){var n=this.getInstance(),s=n.one("head");this._extraCSSNode&&this._extraCSSNode.remove(),this._extraCSSNode=r.create("<style>"+t+"</style>"),s.append(this._extraCSSNode)}}else this.once(i,e.bind(this._setExtraCSS,this,t));return t},_setLang:function(t){var n;return this._ready?(n=this.get(a),n.setAttribute("lang",t)):this.once(i,e.bind(this._setLang,this,t)),t},_instanceLoaded:function(t){this._instance=t,this._onContentReady();var n=this._instance.config.doc;if(!e.UA.ie)try{n.execCommand("styleWithCSS",!1,!1),n.execCommand("insertbronreturn",!1,!1)}catch(r){}},_validateLinkedCSS:function(e){return n.isString(e)||n.isArray(e)},use:function(){var t=this.getInstance(),r=e.Array(arguments),i=!1;return n.isFunction(r[r.length-1])&&(i=r.pop()),i&&r.push(function(){i.apply(t,arguments)}),t.__use.apply(t,r)},delegate:function(e,t,n,r){var i=this.getInstance();return i?(r||(r=n,n=this.get(a)),i.delegate(e,t,n,r)):!1},getInstance:function(){return this._instance},render:function(t){var n,i,s;return this._rendered?this:(t&&this.set(a,t),container=this.get(a),container||(container=r.create(b.HTML),e.one("body").prepend(container),this.set(a,container)),this._rendered=!0,this._container.setAttribute(f,!0),n=e.clone(this.get(y)),s=e.bind(function(){i=YUI(),i.host=this.get(h),i.use("node-base",e.bind(this._instanceLoaded,this))},this),n.push(s),e.use.apply(e,n),this)},focus:function(){return this._container.focus(),this},show:function(){return this._container.show(),this.focus(),this},hide:function(){return this._container.hide(),this}},{THROTTLE_TIME:100,DOM_EVENTS:{click:1,dblclick:1,focusin:1,focusout:1,keydown:1,keypress:1,keyup:1,mousedown:1,mouseup:1,paste:1},HTML:"<div></div>",NAME:"contentEditable",NS:f,ATTRS:{dir:{lazyAdd:!1,validator:n.isString,setter:"_setDir",valueFn:"_getDir"},container:{setter:function(t){return this._container=e.one(t),this._container}},content:{getter:"_getHTML",lazyAdd:!1,setter:"_setHTML",validator:n.isString,value:"<br>"},defaultblock:{validator:n.isString,value:o,valueFn:"_getDefaultBlock"},extracss:{lazyAdd:!1,setter:"_setExtraCSS",validator:n.isString,valueFn:"_getExtraCSS"},id:{writeOnce:!0,getter:function(t){return t||(t="inlineedit-"+e.guid()),t}},lang:{validator:n.isString,setter:"_setLang",lazyAdd:!1,value:"en-US"},linkedcss:{setter:"_setLinkedCSS",validator:"_validateLinkedCSS"},node:{readOnly:!0,value:null,getter:function(){return this._container}},use:{validator:n.isArray,writeOnce:!0,value:["node-base","editor-selection","stylesheet"]}}}),e.namespace("Plugin"),e.Plugin.ContentEditable=b},"3.16.0",{requires:["node-base","editor-selection","stylesheet","plugin"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("editor-inline",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)};e.extend(n,e.EditorBase,{initializer:function(){this.plug(e.Plugin.ContentEditable)}}),e.InlineEditor=n},"3.16.0",{requires:["editor-base","content-editable"]});
YUI.add("mail-services-message-service",function(B){function A(){var D=arguments[0]||{},C=D.stopwatch||null,F=D.cacheKey||"Prime",E=D.truncateAt||null;return{get:function(H,G){return(new Promise(function(J,I){if(C){C.CMGStart=new Date();}B.mail.Controller.Messages.get({fid:G,msg:{mid:H},cachekey:F,ovparams:{truncateAt:E}},{success:function(L,K){if(C){C.CMGEnd=new Date();C.wasCached=K.respProps.wasCached;}if(!L||!L.mid){I();}J(L);},failure:function(){I();}});}));}};}B.namespace("mail.Services").MessageService=A;},"1.0.0",{requires:["mail-controller-messages"]});YUI.add("comms-ui-dialog-base",function(H){var E=H.Node,C=E.one,G,D,F="dlg-show";function A(I){var J=I.get("id");if(!J){J=H.stamp(I);I.set("id",J);}return J;}function B(R){R=R||{};R.visible=R.visible||0;R.zIndex=R.zIndex||15500;var Q=this,U=R.contentBox||null,V=R.template||null,K=R.cssPrefix||null,I=R.focusedNode||null,M=R.clearMask||false,T=R.hideMask||false,S=R.restoreFocusNode,J=R.suppressRestoreFocus||false,L=R.suppressActive,O=R.maskId||null,N=R.noScroll||false,P=R.disableEsc||false;this._evt=[];if(!U&&V){Q.CONTENT_TEMPLATE=V;}B.superclass.constructor.apply(this,arguments);if(!D&&L){if(G){D=G;G.set("visible",false);}else{L=false;}}Q.addAttrs({cssPrefix:{value:K,readOnly:true},focusedNode:{value:I},clearMask:{value:M},hideMask:{value:T},restoreFocusNode:{valueFn:function(){var W=S;if(!((W instanceof H.Node)||H.Lang.isNull(W))){W=document.activeElement;}return W;}},suppressRestoreFocus:{value:J},suppressActive:{value:L,readOnly:true},maskId:{value:O},noScroll:{value:N},disableEsc:{value:P}});}B.NAME="dialog";B.CSS_PREFIX="yui3-overlay";B.ATTRS={role:{value:"dialog"}};H.extend(B,H.Overlay,{maskEl:null,prevMaskElId:null,centerEl:null,_haltShow:false,initializer:function(){this.set("visible",false);this.on("render",this.onBeforeRender);},destructor:function(){H.one("html").removeClass(F);var J,K=this.get("restoreFocusNode"),M=this.get("suppressRestoreFocus"),I=this.get("contentBox").get("id");this.get("boundingBox").purge(true);if(this.get("centered")){this.centerEl&&this.centerEl.remove(true);}else{this.get("boundingBox").remove(true);}for(J in this._evt){H.detach(this._evt[J]);}if(!this._haltShow){if(D&&this.get("suppressActive")){D.set("visible",true);D=null;this.prevMaskElId&&this.maskEl&&this.maskEl.set("id",this.prevMaskElId);this.prevMaskElId=null;}else{if(this.get("maskId")){this.maskEl.remove(true);}else{this.maskEl&&this.maskEl.setStyle("display","none");}G=null;if(!M){try{if(!(H.Lang.isNull(K)||K.tagName=="IFRAME")){K.focus();}}catch(L){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:1",L,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:1");}}H.fire("dialog:hide",I);}}else{this._haltShow=false;}},renderUI:function(){var P=this.get("cssPrefix"),K=this.get("contentBox"),O=this.get("role"),I,N,M,J,L;K.set("role",O);if(P){I=["#"+K.get("id")," .",P].join("");M=H.one(I+"-hd");J=H.one(I+"-bd");L=H.one(I+"-ft");if(M){K.set("aria-labelledby",A(M));if((N=M.one(".close"))){N.set("role","presentation");}if(!M.hasClass("yui3-widget-hd")){M.addClass("yui3-widget-hd");}}if(J){if(O==="alertdialog"||O==="dialog"){K.set("aria-describedby",A(J));}if(!J.hasClass("yui3-widget-bd")){J.addClass("yui3-widget-bd");}}if(L){if(!L.hasClass("yui3-widget-ft")){L.addClass("yui3-widget-ft");}}}K.setStyle("display","block");K.set("tabIndex",0);K.all(".btn a").each(function(R,Q){R.set("role","button");});},show:function(){if(!G){B.superclass.show.call(this);!this.get("suppressActive")&&H.fire("dialog:show",this);this.get("contentBox").setStyle("opacity",1);}else{this._haltShow=true;this.destroy();}},bindUI:function(){var J=H.one("html"),O=J.all(".yui3-overlay-content .btn"),I=O.size()-1,M=J.one(".yui3-overlay-content"),P=this.get("focusedNode"),L;if(this.get("centered")){this.after("renderedChange",this.center);}this._evt.push(this.after("visibleChange",function(){var R={display:"none"},Q=this.get("contentBox");if(this.get("visible")){Q&&Q.setStyle("display","block");R.display=this.get("hideMask")?"none":"block";G=this;if(!this.get("clearMask")){J.addClass(F);}}else{Q&&Q.setStyle("display","none");G=null;if(!this.get("clearMask")){J.removeClass(F);}}this.maskEl&&this.maskEl.setStyles(R);if(G){N(true);}H.fire("ToolTips:hideTooltips");}));function N(R){if(!G){return;}if(!(P instanceof H.Node)){R&&H.UA.gecko&&M.focus();P=M.one(P);}try{if(P){P.focus();}else{M.focus();}}catch(Q){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:2",Q,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:2");}}this._evt.push(M.on("blur",function(){L=true;}));this._evt.push(M.on("focus",function(R){var Q="#"+M.get("id");if(L&&!R.target.ancestor(Q,true)){N();}L=false;}));function K(S){var Q,R=S.target;switch(S.keyCode){case 8:case 46:return;case 9:if(I>-1){if(S.shiftKey){if(M==R){S.halt();O.item(I).focus();}}else{if(O.item(I)==R){S.halt();M.focus();}}}break;case 27:if(!this.get("disableEsc")){this.fire("dialog:action",{dataAction:"cancel"});S.preventDefault();}break;case 32:if(R.getAttribute("role")=="button"){S.preventDefault();H.use("node-event-simulate",function(){R.simulate("click");});}break;case 37:case 39:if((I>0)&&(Q=O.indexOf(R))>-1){if(S.keyCode==37){O.item((Q==0)?I:Q-1).focus();}else{O.item((Q==I)?0:Q+1).focus();}}break;}S.stopPropagation();}M.on("keydown",K,this);},onBeforeRender:function(O){var P=this.get("zIndex"),I=this.get("hideMask"),L=this.get("clearMask"),Q=this.getClassName((L?"clearmask":"mask")),J="position:fixed;top:50%;left:50%;height:1px;",K,M=this.get("maskId"),N,R;if(M){this.maskEl=C("#"+M);}if(!this.maskEl){if(!M){M=H.guid();}if(!(this.maskEl=H.one("."+Q))&&!I){N=['<DIV id="',M,'" class="',Q,'" style="z-index:',(P-2),'"></DIV>'].join(""),C("body").prepend(N);this.maskEl=C("#"+M);}else{if(this.maskEl){this.prevMaskElId=this.maskEl.get("id");this.maskEl.set("id",M);this.maskEl.setStyle("zIndex",P-2);}}}if(this.get("centered")){K=H.guid();R=['<DIV id="',K,'" style="',J,"z-index:",(P-1),'"></DIV>'].join("");C("body").prepend(R);this.centerEl=H.one("#"+K);O.parentNode=this.centerEl;this.get("boundingBox").setStyle("position","relative");}},center:function(){var J,K,I=this.get("boundingBox");J=-(I.get("offsetWidth")/2)+"px";K=-(I.get("offsetHeight")/2)+"px";I.setStyles({"marginLeft":J,"top":K,"left":0});}});H.namespace("comms.ui");H.comms.ui.Dialog=B;
},"0.0.1",{requires:["node","overlay"]});YUI.add("_shared_module_offscreen_bin_modal_close_icon",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_close_icon={base:'<span class="icon close" data-action="cancel" title="{{str_btn_close}}"></span>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_modal",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal={base:'<div id="modalOverlay" class="modal {{modal_classes}}"> <h2 class="modal-hd"> {{modal_header}} {{_shared_module_offscreen_bin_modal_close_icon}} </h2> <div class="frontpanel"> <div class="modal-bd">{{modal_body}}</div> <div class="modal-ft">{{modal_ft}}</div> </div> {{modal_back_panel}}</div>',modal_back_panel:'<div class="backpanel back hidden"> <div class="modal-bd">{{modal_body_back}}</div> <div class="modal-ft">{{modal_ft_back}}</div> </div> '};},"1.0.0",{requires:["_shared_module_offscreen_bin_modal_close_icon"]});YUI.add("_shared_module_offscreen_bin_modal_btn_ok",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_btn_ok={base:'<button id="okayModalOverlay" class="btn left right default" title="{{str_ok}}" role="button" data-action="ok">{{str_ok}}</button> '};},"1.0.0");YUI.add("common-ui-dialog-helper",function(C){var A=C.common.Utils.substitute,B=C.ui.Templates,E="alertdialog",D;D=function(){var H={modal_header:function(M){return M.hd;},modal_body:function(M){return M.bd;},modal_ft:function(M){return A(M.ft,0,0,0,strings);},_shared_module_offscreen_bin_modal_btn_ok:function(M){return M.ok;},_shared_module_offscreen_bin_modal_btn_cancel:function(M){return M.cancel;},_shared_module_offscreen_bin_modal_close_icon:function(M){return(M.hideClose)?"":A(B._shared_module_offscreen_bin_modal_close_icon.base,0,0,0,strings);},global_path_img:function(){return NeoConfig.globalPathImg+"/u/assets/img";},antivirus_logo_path_img:function(){return NeoConfig.avLogoUrl;}};function L(N,O,M){N.ft=B._shared_module_offscreen_bin_modal_btn_ok.base||"";N.role=E;if(O&&O.ok&&O.ok.text){N.ft=A(N.ft,0,0,0,{str_ok:O.ok.text});}F(N,O,M);}function K(N,O,M){C.use("_shared_module_offscreen_bin_modal_btn_cancel",function(){var P={cancel:B._shared_module_offscreen_bin_modal_btn_cancel.base};N.ft=A(B._shared_module_offscreen_bin_modal_btn_cancel.base,P,H,0,strings);N.focusedNode='.modal-ft [data-action="cancel"]';N.role=E;F(N,O,M);});}function G(N,O,M){C.use("_shared_module_offscreen_bin_modal_btns_ok_cancel",function(){var P={ok:B._shared_module_offscreen_bin_modal_btn_ok.base,cancel:B._shared_module_offscreen_bin_modal_btn_cancel.base};if(O&&O.ok&&O.ok.text){P.ok=A(P.ok,0,0,0,{str_ok:O.ok.text});}if(O&&O.cancel&&O.cancel.text){P.cancel=A(P.cancel,0,0,0,{str_btn_cancel:O.cancel.text});}N.ft=A(B._shared_module_offscreen_bin_modal_btns_ok_cancel.base,P,H,0,strings);N.role=E;F(N,O,M);});}function J(N,O,M){N.ft=A(N.ft,0,H,0,strings);F(N,O,M);}function F(N,O,M){N=N||{};if(!N.template){var Q=N.rawTemplate||B._shared_module_offscreen_bin_modal.base;N.template=A(Q,N,H,0,strings);}N.centered=true;N.cssPrefix="modal";N.focusedNode=N.focusedNode||".yui3-widget-ft button.default";function P(R){R.get("contentBox").set("aria-live","polite");R.show();if(M){M(R);}}I(N,O,P);}function I(N,P,M){var O=new C.comms.ui.Dialog(N);P=P||{};O.render();O.get("contentBox").on("click",function(S){var T=C.common.Utils.getDataAction(S),R=T.action,Q=T.node;if(R){if(!N.allowDefault){S.preventDefault();}O.fire("dialog:action",{dataAction:R,item:Q});}});O.after("dialog:action",function(T){var R=T.dataAction,Q;if(R){Q=P[R];try{if(!Q||!Q.stopDestroy){O.destroy();}Q&&Q.handler&&Q.handler.call(this,T,O);}catch(S){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-dialoghelper-dialoghelper:1",S,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-dialoghelper-dialoghelper:1");}}});if(M){M(O);}}C.mix(this,{alert:L,cancelDialog:K,confirm:G,create:I,custom:J,createCommon:F});};C.namespace("common.ui");C.common.ui.DialogHelper=new D();},"1.0.0",{requires:["common-utils","modal_css","comms-ui-dialog-base","_shared_module_offscreen_bin_modal","_shared_module_offscreen_bin_modal_btn_ok"]});YUI.add("common-ui-notification-v2",function(e){var t=e.common.Utils,n;n=function(){function r(t,n){var r=this,i=n.type,s="opacity: 0",o=e.one("html");n.customClass&&(i=i+" "+n.customClass),n.speed&&(i=i+" "+n.speed),n.close?r.container=e.Node.create('<div tabindex="0" role="alert" id="notification-v2" class= "boss-hideable yui3-overlay-loading '+i+'" style="'+s+'"><div class= "notification-text close-true">'+t+'<a class="icon close btn-cancel-notification" data-action="closeNotification"></a> </div></div>'):r.container=e.Node.create('<div tabindex="0" role="alert" id="notification-v2" class= "boss-hideable yui3-overlay-loading '+i+'" style="'+s+'"><div class= "notification-text">'+t+"</div></div>"),e.one("body").prepend(r.container),r.overlay=new e.Overlay({srcNode:"#notification-v2",visible:!0,shim:!0,zIndex:100}),r.overlay.set("align",{node:"#shellinner",points:[e.WidgetPositionAlign.TC,e.WidgetPositionAlign.TC]}),r.overlay.get("boundingBox").addClass("notification-overlay"),n.customPositionClass&&r.overlay.get("boundingBox").addClass(n.customPositionClass),n.modal&&(r.htmlmask=e.Node.create('<div class="yui3-overlay-mask" style="z-index: 99; display:block"></div>'),e.one("body").prepend(r.htmlmask),o.addClass("dlg-show")),n.closeOnExternalClick&&e.Lang.later(500,r,function(){r.overlay.get("boundingBox").on("clickoutside",function(e){r.clearAll("fast",n.cbkOnDestroy)},r)}),n.closeOnNavClick&&e.Lang.later(3e3,r,function(){r.overlay.get("boundingBox").on("clickoutside",function(e){(e.target.ancestor("#storm-listnav")||e.target.ancestor(".listnav"))&&r.clearAll("fast",n.cbkOnDestroy)},r)}),r._bindUI(n.cbk,n.context,n.args,n.cbkOnClose,n.cbkOnDestroy),r._show(n.duration,n.cbkOnDestroy)}function i(n,r,i,s,o){var u=this,a="fast",f={},l,c,h,p;o&&(h=t.wcopy(i),u.container.on("notification-hidden",function(t){typeof n=="function"&&(h?h.splice(0,0,t,"destroyNotification"):h=[t,"destroyNotification"],r=r?r:Window,e.Lang.later(1,u,function(){n.apply(r,h)}))})),u.container.delegate("click",function(o){l=t.getDataAction(o),c=l&&l.action,p=t.wcopy(i),c?(o.preventDefault(),c==="closeNotification"&&s!==!0?u.clearAll(a):c==="expand-inline"?(u.container.all(".nf-inline").toggleClass("collapse").toggleClass("expand"),o.target.ancestors(".tae-info").size()>0&&!f[o.target.get("id")]&&(f[o.target.get("id")]=!0,e.fire("util:ymstats",{name:"tae_notifications",tags:{action:"expanded"}}))):(u.clearAll(a),typeof n=="function"&&(p?p.splice(0,0,o,c):p=[o,c],r=r?r:Window,e.Lang.later(1,u,function(){n.apply(r,p)})),u.fire("clickEvent",{action:c}))):o.target.ancestors(".tae-info").size()>0&&!f[o.target.get("id")]&&(f[o.target.get("id")]=!0,e.fire("util:ymstats",{name:"tae_notifications",tags:{action:"external_link_clicked"}}))},"a")}function s(t,n){var r=this,i="destroy-fast",s=0;t==="slow"&&(i="destroy-slow",s=3e3),r.htmlmask&&(r.htmlmask.remove(!0),e.one("html").removeClass("dlg-show")),r.hideTimer&&(r.hideTimer.cancel(),delete r.hideTimer),r.container&&r.container._node?(r.container.removeClass("destroy-slow"),r.container.removeClass("destroy-fast"),r.container.addClass(i),r._hide(s,n)):(r.showingNotification=!1,r.fire("notification-destroyed"))}function o(t,n){var r=this,i="slow",s=!1;r.overlay.render(),r.container.setStyles({opacity:100,display:"none"}),e.Lang.later(1,r,function(){r.container.setStyle("display","block")}),t&&(r.container.on("mouseenter",function(){s=!0}),r.container.on("mouseleave",function(){s=!1}),r.hideTimer=e.Lang.later(t,r,function(){s?r.container.on("mouseleave",function(){r.clearAll(i,n)}):r.clearAll(i,n)}))}function u(t,n){var r=this,i,s;i="opacity",s=0,r.container&&r.container._node&&r.overlay&&(r.container.setStyle(i,s),r.destroyTimer&&(r.destroyTimer.cancel(),delete r.destroyTimer),r.destroyTimer=e.Lang.later(t,r,function(){r.overlay.hide(),r._destroy()})),n&&r.container.fire("notification-hidden")}function a(){var e=this;e.container&&e.container._node&&e.container.remove(!0),e.overlay&&e.overlay.destroy(),e.showingNotification=!1,e.fire("notification-destroyed")}function f(t,n){var r=this;r.showingNotification?(r.once("notification-destroyed",function(){e.common.ui.NotificationV2.notify(t,n)},r),r.clearAll()):(r.showingNotification=!0,n.type==="info"||n.type==="attention"||n.type==="error"?r._create(t,n):n.type==="dialog"?e.common.ui.DialogHelper.createCommon(t):r.showingNotification=!1)}var n=this;n.showingNotification=!1,e.mix(this,{_show:o,notify:f,_hide:u,clearAll:s,_destroy:a,_create:r,_bindUI:i})},e.augment(n,e.EventTarget),e.namespace("common.ui"),e.common.ui.NotificationV2=new n},"1.0.0",{requires:["common-utils","common-ui-dialog-helper","overlay","event-outside","event-mouseenter"]});
YUI.add("_shared_module_offscreen_bin_notification_single_inline_text",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_notification_single_inline_text={base:'{{nf_text}}<div class="nf-inline collapse"> {{inline_text}}</div>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_notification_tae_text",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_offscreen_bin_notification_tae_text={base:"{{tae_nf_text_generic}}{{contact_us}}{{contact_us_sbc}}",fix_internet:"<a href=\"#\" class='fix-internet expand-inline' data-action=\"expand-inline\"> <span class='icon nf-inline collapse'></span> {{fix_internet}} </a> ",hidden_text_mid:"<div class='nf-inline collapse'>{{hidden_text_mid}}</div> ",external_help:'<a href="{{url}}" target="_blank" class="external-help">{{external_help}}</a> ',more:'<a href="#" data-action="expand-inline" class="more expand-inline"> <span class=\'icon nf-inline collapse\'></span> {{more}} </a> ',hidden_text_end:"<div class='nf-inline collapse'>{{hidden_text_end}}</div> ",tae_nf_text_generic:'<div class="nf-hd">{{tae_hd}}</div> <div class="nf-bd">{{tae_bd}} {{fix_internet}} {{hidden_text_mid}} </div> <div class="nf-ft"> {{external_help}} {{more}} {{hidden_text_end}} <div class="tae-num">{{tae_num}}</div> </div>',contact_us:'<div class="contact-us"> {{str_tae_stillneedhelp}} <a href="https://{{lang_help_link}}.yahoo.com/kb/{{partner_id}}{{page_id}}.html?impressions=true" target="_blank">{{str_tae_contactus}}</a> </div>',contact_us_sbc:'<div class="contact-us"> {{str_tae_stillneedhelp}} <a href="{{url}}" target="_blank">{{str_tae_contactus}}</a> </div>'}},"1.0.0");
YUI.add("mail-errormap",function(e){e.namespace("mail.Errormap");var t=e.common.net.Error,n={BatchItemError:{},AccountVerificationRequired:{tae:0,message:"AccountVerificationRequired"},ComposeErrorBadFrom:{tae:0,message:"BadFrom"},InvalidFromAddress:{tae:0,message:"BadFrom"},ComposeErrorBadRecipient:{tae:0,message:"BadRecipient"},InvalidRecipientAddress:{tae:0,message:"BadRecipient"},MessageContentReject:{tae:0,message:"ContentRejected"},ExceededMaxDailyMessages:{tae:0,message:"DailyLimitExceeded"},FolderNameNotAllowed:{tae:0,message:"folder_name_is_reserved"},FolderNameTooLong:{tae:0,message:"folder_name_too_long"},FolderNameExists:{tae:0,message:"FolderAlreadyExists"},FolderIdIsSystemFolder:{tae:0,message:"FolderIdIsSystemFolder"},FolderNameIllegalCharacter:{tae:0,message:"FolderNameIllegalCharacter"},ExceededMaxHourlyMessages:{tae:0,message:"ExceededMaxHourlyMessages"},WrongInput:{tae:0,message:"HumanVerificationFailed",suppressStat:!0},HumanVerificationRequired:{tae:0,message:"HumanVerificationRequired",suppressStat:!0},ExceededMaxBcc:{tae:0,message:"MaxBCCAddressesExceeded"},ExceededMaxCc:{tae:0,message:"MaxCCAddressesExceeded"},ExceededMaxTo:{tae:0,message:"MaxToAddressesExceeded"},ExceededMaxRecipients:{tae:0,message:"MaxTotalAddressesExceeded"},MessageTooLarge:{tae:0,message:"MessageToLarge"},MessageTooLargeSomeRecipients:{tae:0,message:"MessageTooLargeForSomeRecipients"},NoRecipientsSpecified:{tae:0,message:"MissingRecipients"},NicknameExpansionFailed:{tae:0,message:"NicknameExpansionFailed"},NoSenderSpecified:{tae:0,message:"NoSenderSpecified"},TooManyFolders:{tae:0,message:"TooManyFolders"},ExceededAttachmentLimit:{tae:0,message:"uploadNumFiles"},ParentalControlsNoAttachments:{tae:0,message:"ypcUploadDisallowed"},GetUserDataFailed:{tae:1,message:"UserDataFetchFailed"},FarmNameNotFound:{tae:1,message:"FarmNameNotFound"},UserOpenFailed:{tae:1,message:"ServerError"},SetUserDataFailed:{tae:1,message:"SetUserDataFailed"},UserDataFetchFailed:{tae:1,message:"UserDataFetchFailed"},MaxAttempts:{tae:12,message:"HumanVerificationFailed"},SendMessageAttachmentFailed:{tae:13,message:"SendAttachmentFailed"},SendMessageFailed:{tae:13,message:"SendMessageFailed"},SendMessageFailedSomeRecipients:{tae:13,message:"SendMessageFailedForSomeRecipients"},ComposeErrorBadMIME:{tae:14,message:"BadMime"},ComposeErrorAttachment:{tae:14,message:"ComposeAttachFailed"},ComposeErrorMessage:{tae:14,message:"ComposeError"},ComposeErrorServiceError:{tae:14,message:"ComposeError"},ComposeErrorUnknown:{tae:14,message:"ComposeError"},ComposeFailed:{tae:14,message:"ComposeFailed"},EmptyFolderFailed:{tae:14,message:"EmptyFolderFailed"},FolderEmptyFailed:{tae:14,message:"EmptyFolderFailed"},FolderCreateFailed:{tae:14,message:"FolderCreateFailed"},FolderFetchFailed:{tae:14,message:"FolderFetchFailed"},FolderIdDoesntExist:{tae:14,message:"FolderIdDoesntExist"},FolderNameIllegalCharset:{tae:14,message:"FolderNameIllegalCharacter"},FolderRemoveFailed:{tae:14,message:"FolderRemoveFailed"},FolderRenameFailed:{tae:14,message:"FolderRenameFailed"},InputTooEarly:{tae:14,message:"HumanVerificationFailed"},InvalidYID:{tae:14,message:"HumanVerificationFailed"},TimedOut:{tae:14,message:"HumanVerificationFailed"},WrongUser:{tae:14,message:"HumanVerificationFailed"},MissingApplicationID:{tae:14,message:"MissingApplicationID"},MissingCredentials:{tae:14,message:"MissingCredentials"},ServerError:{tae:14,message:"ServerError"},FailedDependency:{tae:14,message:"ServerError"},SpamReportingFailed:{tae:14,message:"SpamReportingFailed"},SpamTrainingFailed:{tae:14,message:"SpamTrainingFailed"},TooManyCallsBatched:{tae:14,message:"TooManyCallsBatched"},TooManyMessagesRequested:{tae:14,message:"TooManyMessagesRequested"},ComposeError:{tae:14,message:"ComposeError"},CannotSendThisMessage:{tae:19,message:"CannotSendThisMessage"},UserSuspended:{tae:19,message:"UserSuspended"},UserOverQuota:{tae:19,message:strings.str_cfg_tog_hasUnlimitedStorage?"UserTempSuspended":"UserOverQuota"},TooManyUserRequests:{tae:19},UserAbuseDetected:{tae:1,message:"UserTempSuspended"},SetMetaData:{tae:2,message:"BadRequest"},"ListMessagesFailed.SearchMessages":{tae:2,message:"error_searching_messages"},FolderListFetchFailed:{tae:2,message:"FolderListFetchFailed"},ListMessagesFailed:{tae:2,message:"ListMessagesFailed"},MailboxOpenFailed:{tae:2,message:"MailboxOpenFailed"},MailboxUnreachable:{tae:2,message:"MailboxOpenFailed"},MailboxNotFound:{tae:2,message:"MailboxOpenFailed"},MessageDeleteFailed:{tae:2,message:"MessageDeleteFailed"},MessageSaveFailed:{tae:2,message:"MessageSaveFailed"},MetaDataMissingPath:{tae:2,message:"MetaDataMissingPath"},ResetSpamFilterFailed:{tae:2,message:"ResetSpamFilterFailed"},SaveMessageFailed:{tae:2,message:"SaveMessageFailed"},MetaDataFetchFailed:{tae:2,message:"ServerError"},MetaDataSaveFailed:{tae:2,message:"ServerError"},MetaDataTooLarge:{tae:2,message:"ServerError"},UserPreferenceFetchFailed:{tae:2,message:"UserPreferenceFetchFailed"},SearchProgramFailed:{tae:20,message:"error_searching_messages"},ServiceTemporarilyUnavailable:{tae:21},OperationNotAllowedCurrently:{tae:24,message:"OperationNotAllowedCurrently"},GetMessageInvalidId:{tae:4,message:"GetMessageInvalidId"},GetCidsInvalidMids:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageIdsDeleted:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageNotFoundInNonBulk:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageFetchFailed:{tae:4,message:"MessageFetchFailed"},MessageIdsNotFound:{tae:4,message:"MessageIdsNotFound"},MessageNotFound:{tae:4,message:"MessageNotFound"},ERROR:{tae:4,message:"MessageFetchFailed"},MessageSelectionNotFound:{tae:4,message:"MessageSelectionNotFound"},MoveMessagesInvalidId:{tae:4,message:"MoveMessagesInvalidId"},MalformedConvId:{tae:46,message:"MoveMessagesInvalidId"},ConvIdCouldNotBeFound:{tae:46,message:"MoveMessagesInvalidId"},InvalidConvId
:{tae:46,message:strings.str_msg_deleted_error},"MailboxOpenFailed.Busy":{tae:5,message:"MailboxBusy"},BadCharset:{tae:6,message:"download_message_viewing_error"},GetDisplayMessageFailed:{tae:6,message:"GetDisplayMessageFailed"},GetPartContentFailed:{tae:6,message:"GetDisplayMessageFailed"},GetMessageFailed:{tae:6,message:"GetMessageFailed"},EmptyPostBody:{tae:8,message:"BadRequest"},InvalidRequest:{tae:8,message:"BadRequest"},InputInvalid:{tae:8,message:"ServerError"},"EC-4001":{tae:8,message:"BadRequest",suppressNotification:!0,overrides:{GetDisplayMessage:{suppressStat:!0}}},"EC-4002":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4004":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4005":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4006":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4007":{tae:8,message:"BadRequest",suppressNotification:!0},"EP-4010":{tae:19,suppressNotification:!0},"EC-4999":{tae:14,message:"ServerError",suppressNotification:!0},"EP-5000":{tae:14,message:"ServerError"},"EP-5001":{tae:8,message:"BadRequest",suppressNotification:!0},"EP-5002":{tae:8,message:"BadRequest",suppressNotification:!0},"ET-5003":{tae:1,message:"UserDataFetchFailed"},"ET-5004":{tae:4,message:"MessageFetchFailed"},"ET-5005":{tae:2,message:"ServerError"},"ET-5006":{tae:14,message:"ServerError"},"EP-5007":{tae:19,message:strings.str_cfg_tog_hasUnlimitedStorage?"UserTempSuspended":"UserOverQuota"},"ET-5008":{tae:2,message:"MailboxOpenFailed"},"ET-5009":{tae:5,message:"MailboxBusy"},"ET-5010":{tae:5,message:"MailboxBusy"},"ET-5011":{tae:2,message:"MailboxOpenFailed"},"ET-5012":{tae:14,message:"ServerError"},"ET-5013":{tae:14,message:"ServerError"},999:{tae:19},429:{tae:19},2:{tae:18,message:"Offline",title:"OfflineTitle"},conn:{tae:18,message:"Connect"},"Malformed-unk":{tae:14},"Malformed-mail":{tae:14},"HTMLResponse-unk":{tae:14},"HTMLResponse-mail":{tae:14},"NoResponse-unk":{tae:14},"NoResponse-mail":{tae:14},"EmptyResponse-mail":{tae:14},"EmptyResponse-unk":{tae:14},MalformedFault:{tae:14},timeout:{tae:18},invalidwssid:{tae:14},loginfail:{tae:14},unknown:{tae:14},timeoutClient:{tae:18},virusDetected:{tae:0,suppressNotification:!0},batchCaptcha:{tae:0,suppressNotification:!0,suppressStat:!0}};e.mix(e.mail.Errormap,{getNfTemplate:function(t){var n=e.ui.Templates._shared_module_offscreen_bin_notification_tae_text,r=e.common.Utils.substitute,i,s;switch(t.length){case 5:s={tae_hd:t[0],tae_bd:t[1],tae_num:t[3],more:r(n.more,{more:t[2]},null,null,null,strings),hidden_text_end:r(n.hidden_text_end,{hidden_text_end:t[4]},null,null,null,strings)};break;case 6:s={tae_hd:t[0],tae_bd:t[1],external_help:r(n.external_help,{url:t[2],external_help:t[3]},null,null,null,strings),tae_num:t[4],url_help_tae19:t[5]};break;case 7:s={tae_hd:t[0],tae_bd:t[1],fix_internet:r(n.fix_internet,{fix_internet:t[2]},null,null,null,strings),hidden_text_mid:r(n.hidden_text_mid,{hidden_text_mid:t[6]},null,null,null,strings),external_help:r(n.external_help,{url:t[3],external_help:t[4]},null,null,null,strings),tae_num:t[5]};break;default:return}return i=r(n.tae_nf_text_generic,s,null,null,null,strings),i},getNotificationText:function(t){var n=e.common.Utils.substitute,r=e.common.Utils.settings,i=r.value("langHelpUrl")?r.value("langHelpUrl"):"help",s=r.value("partnerHelpUrl")?r.value("partnerHelpUrl"):"",o=e.ui.Templates._shared_module_offscreen_bin_notification_tae_text,u={1:"SLN3538",2:"SLN3554",4:"SLN3560",5:"SLN3561",6:"SLN3562",8:"SLN3564",13:"SLN22329",14:"SLN3543",15:"SLN3549",18:"SLN3552",19:"SLN3553",20:"SLN3555",21:"SLN3556",46:"SLN22331"},a="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/browser-troubleshooting-steps-sln3223.html",f="http://www.att.com/esupport/article.jsp?sid=KB401516",l="https://"+i+".yahoo.com/kb/"+s+"yahoo-mail-system-requirements-sln3257.html",c="http://www.att.com/esupport/article.jsp?sid=KB401516",h="https://"+i+".yahoo.com/kb/"+s+"web-browsers-cache-cookies-sln4525.html",p="http://www.att.com/esupport/article.jsp?sid=KB401516",d="https://"+i+".yahoo.com/kb/"+s+"SLN3552.html?impressions=true",v="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/SLN2080.html?impressions=true",m="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/SLN3553.html?impressions=true",g="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/search-messages-yahoo-mail-sln16065.html?impressions=true",y={list_start_1:'<ol class="tae-steps-ol">',list_end_1:"</ol>",item_start:"<li>",item_end:"</li>",url_help_browser:s==="sbc"?c:l,url_help_cache:s==="sbc"?p:h},b={list_start_2:'<ul class="tae-steps-ul">',list_end_2:"</ul>",item_start:"<li>",item_end:"</li>"},w={page_id:u[t],lang_help_link:i,partner_id:s},E="http://www.att.com/esupport/article.jsp?sid=KB415047",S={menu_start:"<b>",menu_end:"</b>",gt:">",line_start:'<div class="tae-dialog network-help">',line_end:"</div>"},x={menu_start:"<b>",menu_end:"</b>",list_start:"<ol>",list_end:"</ol>",item_start:"<li>",item_end:"</li>",line_start:"<div>",line_end:"</div>"},T={url_browser_trblshoot:s==="sbc"?f:a},N=strings.str_tae_issuewillresolveitself+"&nbsp"+strings.str_tae_thesestepssolvefaster,C=n(strings.str_tae_fourstepsolution,y,null,null,null,strings),k=n(o.contact_us,w,null,null,null,strings),L=n(o.contact_us_sbc,{url:E},null,null,null,strings),A=N+C+(s==="sbc"?L:k),O=e.UA.userAgent,M,_,D="error";switch(t){case 1:case 2:case 8:case 14:case 15:case 21:_=[strings.str_techglitch,strings.str_tae_waitandreload,strings.str_tae_stillcannotaccess,strings["str_tae"+t],A];break;case 4:_=[strings.str_tae_unabletoloadmsg,strings.str_tae_clickoutoffolder,strings.str_tae_stillcannotviewmessage,strings.str_tae4,A],D="attention";break;case 6:_=[strings.str_tae_unabletoloadmsg,strings.str_tae_waitandreload,strings.str_tae_stillcannotviewmessage,strings.str_tae6,A];break;case 46:_=[strings.str_tae_unabletoloadmsgs,strings.str_tae_tryviewagain,strings.str_tae_stillcannotviewmessage,strings.str_tae46,A],D="attention";break;case 18:O.indexOf("Win")!==-1&&O.indexOf("NT 5.")!==-1?
A=n(strings.str_tae_winxpnetworkresolution,x,null,null,null,null):O.indexOf("Win")!==-1&&O.indexOf("NT 6.0")!==-1?A=n(strings.str_tae_winvistanetworkresolution,S,null,null,null,null):O.indexOf("Win")!==-1?A=n(strings.str_tae_win7networkresolution,S,null,null,null,null):O.indexOf("Mac")!==-1&&(A=n(strings.str_tae_macnetworkresolution,S,null,null,null,null)),D="attention",_=[strings.str_tae_unabletoconnect,strings.str_tae_checkinternetorreload,strings.str_tae_howdoIfixinternet,s==="sbc"?E:d,strings.str_tae_connectedcannotaccess,strings.str_tae18,A];break;case 5:A=n(strings.str_tae_accountaccessedfrommultipleplaces,null,null,null,null,strings)+n(strings.str_tae_accessplaceList,b,null,null,null,null)+strings.str_tae_thesestepssolvefaster+C+k,_=[strings.str_tae_mailtemplocked,strings.str_tae_multiplelocationsLock,strings.str_tae_howdoiunlock,strings.str_tae5,A];break;case 13:A=strings.str_tae_programspreventRTE+n(strings.str_tae_plaintextsteps,y,null,null,null,null)+n(strings.str_tae_continuefollowsteps,T,null,null,null,null)+k,D="attention",_=[strings.str_tae_unabletosendmsg,strings.str_tae_waittrysendagain,strings.str_tae_stillcannotsend,strings.str_tae13,A];break;case 19:_=[strings.str_tae_accounttempLocked,strings.str_tae_templockwaitreloadcontactUs,s==="sbc"?E:v,strings.str_tae_tipsonaccountsecure,strings.str_tae19,s==="sbc"?E:m];break;case 20:_=[strings.str_tae_searchtempunavailable,strings.str_tae_waitandsearchagain,s==="sbc"?E:g,strings.str_tae_learnmoreaboutsearch,strings.str_tae20,""],D="attention";break;default:return}return M=this.getNfTemplate(_),{nfText:M,type:D}},normWSError:function(e){var t=e&&(e.match(/Client\.([\w\W]+)$/)||e.match(/Server\.([\w\W]+)$/));return t&&t[1]||e},normHttpError:function(e){var n,r=new RegExp(t.base+"([\\w\\W]+)$");return(n=e.match(r))&&n[1]||e},getNormalizedErrorCode:function(e){var n=t.isHttp(e);return n?this.normHttpError(e):this.normWSError(e)},getErrorInfo:function(n){var r=n.code,i=this.getNormalizedErrorCode(r),s={},o={},u=n.method,a=this.errorMap[i]||{},f=a.overrides||{},l=e.common.Utils.features,c=l.enabled("TaeNotification");return s=e.merge(a,f[u]),o.tae=typeof s.tae!="undefined"?s.tae:t.isHttp(r)?18:14,o.message=strings["str_error_"+s.message]||n.message||"",s.title=strings["str_error_"+s.title]||n.title||"",o.suppressStat=n.suppressStat||s.suppressStat||!1,o.suppressNotification=n.suppressNotification||s.suppressNotification||!1,c&&(o.nfInfo=this.getNotificationText(o.tae)),o},errorMap:n})},"1.0.0",{requires:["common-utils","mail-common-utils-features","json-stringify","common-net-error","_shared_module_offscreen_bin_notification_tae_text","mail-common-utils-settings"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("escape",function(e,t){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},r={html:function(e){return(e+"").replace(/[&<>"'\/`]/g,r._htmlReplacer)},regex:function(e){return(e+"").replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")},_htmlReplacer:function(e){return n[e]}};r.regexp=r.regex,e.Escape=r},"3.16.0",{requires:["yui-base"]});
YUI.add("_shared_module_offscreen_bin_modal_launch_error_rollup",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_launch_error_rollup={base:'<p>{{error_message}}</p><ul> <li><a href="{{link_goto_latest}}" class="more">{{str_refresh_page}}</a></li> <li><a href="{{link_goto_tae_help}}" class="more" target="_blank">{{str_rough_visit_help_page}}</a></li> </ul> <br/><span>{{str_rough_errlaunch_troubleshoot}}</span>'};},"1.0.0");YUI.add("mail-error",function(B){var H=B.common.net.Error,M=B.common.Utils,R=B.mail.Errormap,K=B.JSON.stringify,G="45",F=46;B.namespace("mail.Error");function D(V,X){var W=null;if(/SendMessage/.test(X)||/SendMessage/.test(V.postdata)){W=B.clone(V);W.postdata="<filtered>";}else{if(/SaveMessage/.test(X)||/SaveMessage/.test(V.postdata)){W=B.clone(V);W.postdata=W.postdata.replace(/"html":.*","attachment"/g,'"attachment"');}}return W||V;}function Q(W,X){var Z=W.fault&&W.fault.code,V=W.status,Y=[401];function a(b){return(Z.toString().search(b)!==-1)||((V+"")===b);}return H.suppress(X.suppressCodes,Y.concat(X.exceptCodes||[]),a);}function J(V){V.suppressStat=true;V.suppressNotification=true;}function N(Y,W){var b=W.fault,X=b.code,d=W.callback||{},V=d.method,c=this.isErrorSuppressed(W,d),Z=R.getErrorInfo({code:X,method:V,suppressNotification:c||d.suppressNotification,suppressStat:c||d.suppressStat}),f={yid:NeoConfig.loginId||"",tae:Z.tae,method:V,request:this.filterRequest(Y.request,V),response:W.responseText||W.responseTextBatch||"",headers:W.allHeadersText||W.allHeadersTextBatch||"",fault:X,nfInfo:Z.nfInfo||"",message:Z.message||b.message||"",title:Z.title,suppress:c,suppressStat:Z.suppressStat,suppressNotification:Z.suppressNotification,http:[W.status,W.statusText].join(" "),duration:Y.end?(Y.end-Y.start):"X",ua:navigator.userAgent,conv:NeoConfig.hasConvView?1:0,pp:NeoConfig.previewPanePref?1:0,host:NeoConfig.hostName};try{if(!f.response){B.fire("MailLog",{m:"Invalid error detail response",detail:f});return f;}f.response=B.JSON.parse(f.response);}catch(a){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:1",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:1");f.response=f.response;}return f;}function I(b){var Y=B.common.Utils.features,V=Y.enabled("TaeNotification"),W,a,Z,X,c;if(V&&b.nfInfo&&b.nfInfo.nfText){W=b.nfInfo;c="nf-multiline tae-info tae"+b.tae;B.common.ui.NotificationV2.notify(W.nfText,{type:W.type,closeOnExternalClick:true,close:true,customClass:c,speed:"show-medium"});B.fire("util:ymstats",{name:"tae_notifications",tags:{action:"invoked"}});return;}if(strings.str_tog_TAESupported){if(b.tae===G&&strings["str_cfg_url_yahoo_mail_help_tae"+G]){Z=strings["str_cfg_url_yahoo_mail_help_tae"+G];}else{Z=strings.str_cfg_url_TAEHelpPages+"mltamtae"+b.tae+".html";}}else{Z=strings.str_cfg_url_contact_customer_care;}a={error_message:b.message||strings.str_rough_errlaunch_message,link_goto_latest:"launch?reason=ignore&rs=1",launch_error_code:b.tae,link_goto_tae_help:Z};X=M.substitute(B.ui.Templates._shared_module_offscreen_bin_modal_launch_error_rollup.base,a,null,null,strings);H.show(null,X,strings.str_error_MailErrorTitle,{modal_classes:"lg"});}function U(){return(NeoConfig.mailEnv==="prod")?NeoConfig.hostName.split(".")[3]:"";}function O(a){var Z=/"id":"(.*?)",/g,W={},Y=[],V;while((V=Z.exec(a))!==null){W[V[1].replace(/[0-9]|_/g,"")]=1;}for(var X in W){Y.push(X);}return Y;}function S(c,X){var Z,V,a=c.method,Y,W,b={"convpane":"CONVREAD","messagepane":"MESSAGEREAD","search":"SEARCH","convlist":"CONVLIST","messagelist":"MESSAGELIST"};V=B.mail.Tabs.getActiveTab().widgetType;Z=b[V]?b[V]:V;W=this.getColo();if(a==="BatchExecute"&&X.request.postdata){Y=this.extractBatchMethods(X.request.postdata);if(Y.length){a+="_"+Y.join("_");}}if(c.suppressStat){B.fire("util:ymstats",{"name":"client_error","tags":{"api":a,"tae":c.tae,"code":(c.customCode||X.code||c.fault),"farm":NeoConfig.farm.substr(1),"colo":W,"httpStatusCode":X.status}});B.fire("stat:webservice_fail",{"tab":Z,"tae":c.tae,"api":a,"message":(X.code||c.fault),"visible":"no"});}else{B.fire("util:ymstats",{"name":"ue_client_error","tags":{"api":a,"tae":c.tae,"code":(c.customCode||X.code||c.fault),"farm":NeoConfig.farm.substr(1),"colo":W,"httpStatusCode":X.status}});B.fire("stat:webservice_fail",{"tae":c.tae,"tab":Z,"api":a,"message":(X.code||c.fault),"visible":"yes"});}}function E(a,V){var W=(a.suppressStat?"":"UE_")+"DEBUG_TAE:"+(a.tae||"null")+":"+(a.method||"null")+":"+(a.fault||"null")+":"+NeoConfig.farm+" ",Z=new Date().getTime(),X;this.stat(a,V);if(a.tae===0){return;}try{a.tid=Z;if(NeoConfig.sessionTracer){if(a.tae===2||a.tae===4||a.tae===13){B.mail.model.DataStore.Sessions.log(Z);}}if(V.status!==13030&&!/Credentials/.test(a.fault)&&parseInt(NeoConfig.log_error_response,10)!==1){delete a.response;}X={m:W,api:(a.method||"null")+" ",reason:(a.fault||"null")+" ",errinfo:a};if(B.UA.chrome>0){X.online=navigator.onLine;}B.fire("MailLog",X,1,"tae"+a.tae);}catch(Y){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:2",Y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:2");}}function A(V,W){return W.indexOf("Client.FailedDependency")!==-1||(V>0&&W==="EC-4001");}function T(V){var W;if(!V){return"UNKNOWN";}if(V.match(/Error getting attachment:/g)){W="ERROR_GETTING_ATTACHMENT";}else{if(V.match(/Failed to fetch message ID:/g)){W="FAILED_TO_FETCH_MESSAGE_ID";}else{if(V.match(/Failed to get msg/g)){W="FAILED_TO_GET_MSG";}else{if(V.match(/Error deleting previous copy of message/g)){W="ERROR_DELETING_PREVIOUS_COPY_OF_MESSAGE";}else{if(V.match(/Error saving message when calling appendMsg/g)){W="ERROR_SAVING_MESSAGE_WHEN_CALLING_APPENDMSG";}else{if(V.match(/Error opening mailbox/g)){W="ERROR_OPENING_MAILBOX";}else{if(V.match(/fetchBody error/g)){W="FETCHBODY_ERROR";}else{if(V.match(/Error fetching message list/g)){W="ERROR_FETCHING_MESSAGE_LIST";}else{if(V.match(/folder id(.*)doesn't exist/g)){W="FOLDER_ID_DOESNOT_EXIST";}else{if(V.match(/Error sending message/g)){W="ERROR_SENDING_MESSAGE";}else{W="UNKNOWN";}}}}}}}}}}return W;}function C(AA,m,o,n){function x(e,AC,i){AA.callDefault(e,AC,i);}o.fault.code+="";M.assert(o.fault);try{var f=o.fault,r=o.status,V=f.code,t=V==="BatchItemError",b,s,z=o.callback||{},W=z.method,p,h,X=/xhrsend/.test(V),j,Y,c,Z,a=o.callback,q=a.retry?"1":"0",l=f&&f.message&&f.message.match("Content-Length:0"),g,w,AB,v,d=z.retryCodes||[],k={"Server.Malformed-mail":true,"Client.EmptyPostBody":true};
if(NeoConfig.hasConvV3&&r===400&&!o.body){o.body=B.JSON.parse(o.responseText);V=o.body.error.code;j=o.body.error.message;}if(k[V]||l||d.indexOf(V)!==-1){if(!a.retry){B.mix(a,{retry:true});Y=o.request;Z=B.common.net.SessionMgr;c=Z.request(Y.url,Z.formatQueryParams(Y.urlparams,Y.enc),a,Y.mthd,Y.enc,null,m.multipart);if(Y.mthd==="POST"){c.request.post=Y.postdata;}c.send();if(V==="Server.Malformed-unk"){B.fire("util:ymstats",{name:"malformed_retry"});}return;}else{if(V==="Server.Malformed-unk"){B.fire("util:ymstats",{name:"malformed_retry_failed"});}}}if(t){for(var u=0;u<f.detail.length;u++){h=f.detail[u];h.code+="";h.allHeadersTextBatch=o.allHeadersText||"";h.responseTextBatch=o.responseText||"";if(!this.isDependencyFailure(u,h.code)){this.handle(AA,m,h,z);}}return;}p=this.getErrorInfo(m,o);g=K(p.response)||"";M.assert(z.service==="mail");if(g&&(p.tae===2||p.tae===13)){if(p.method==="SaveMessage"||p.method==="SendMessage"){p.customCode=this.getSendSaveCustomErrorCode(g);}}if(p.tae===46||p.method==="GetDisplayMessage"){w=m.request.url;AB=p.fault.substr(p.fault.lastIndexOf(".")+1);if(/prime=/.test(w)){if(/prime=0/.test(w)){this.forceSuppressError(p);p.prime="0";}else{if(/prime=1/.test(w)){p.prime="1";}}}if(/InvalidConvId/.test(V)||p.prime==="0"){this.forceSuppressError(p);}}if(r===429){x(429,f.detail&&f.detail.token);}if(r===404){this.forceSuppressError(p);}if(r===307){if(o.responseText){v=JSON.parse(o.responseText).error.code;if(v==="EP-4009"){x(401,{msg:b,url:"https://mail.yahoo.com",stat:V+"_"+W});}}}if(r===500||t||r===400||r===590||f.partialFault){if(/SessionIdReissue/.test(V)||V==="EC-4003"||/Reissuing session ID/.test(j)){x(402);}else{if(/Credentials/.test(V)||V==="EC-4008"||/Credentials/.test(j)){x(401,{stat:V+"_"+W});}else{if(/ClientRedirect/.test(V)||/ClientRedirect/.test(j)){b=M.substitute(strings.str_error_reload_account_migrated,null,null,null,strings);if(/HostCorrection/.test(V)||/HostCorrection/.test(j)){x(401,{msg:b,url:"https://mail.yahoo.com",stat:V+"_"+W});}else{x(310,{msg:b,stat:V+"_"+W});}}else{if(/999/.test(V)||/999/.test(j)){x(999,f.detail&&f.detail.token);}else{if((/ServiceTemporarilyUnavailable/.test(V)||/ServiceTemporarilyUnavailable/.test(j))&&f.detail&&f.detail.displayUrl){window.location=f.detail.displayUrl;return;}if(!p.suppressNotification&&!(n&&n.suppressNotification)&&!f.partialFault){if(!z||!z.taeUiCbk||!z.taeUiCbk(p)){this.showTae(p);}}}}}}}else{if(V.indexOf("-unk")>-1){s={};s.message=strings.str_error_Unk;s.title=strings.str_error_Unk_title;x(null,s,X);}else{if(!p.suppress){s={};s.message=p.message;s.title=p.title;x(null,s,X);}}}if(p.tae===46){p.convOrigin=z.convOrigin;if(z.openedFrom){p.openedFrom=z.openedFrom;}}if(!AA.retry){this.log(p,o);}}catch(y){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:3",y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:3");M.assert(0,"mail:controller:error - "+y.message);}if(!AA.isdone()){AA.done();}}function L(W){var X={},V;for(V in W){if(W.hasOwnProperty(V)){X[V]=B.Escape.html(W[V]);}}return X;}function P(Y){var W,X="",V="";M.netError("FetchExternalAccount Error"+K(Y));for(W=0;W<Y.length;W++){V=Y[W].status;X=strings["str_error_extFetch_"+Y[W].status];if(!X){X=strings.str_error_extFetch_unknownError;}X=M.substitute(X,L(Y[W]));X+="<br/><br/>";}H.showConfirm(function(){B.fire("openOptions",B.mix(this,{params:{section:"accounts"}}));},0,X);}B.mix(B.mail.Error,{handle:C,extFetchError:P,extractBatchMethods:O,stat:S,log:E,showTae:I,getColo:U,isDependencyFailure:A,getSendSaveCustomErrorCode:T,isErrorSuppressed:Q,getErrorInfo:N,filterRequest:D,forceSuppressError:J});B.fire("mailerrormodule:loaded");},"1.0.0",{requires:["common-net-error","mail-common-utils-features","mail-errormap","ymma-stats","json-stringify","escape","_shared_module_offscreen_bin_modal_launch_error_rollup","common-ui-notification-v2"]});YUI.add("mail-error-v3",function(B){var C=B.mail.Errormap,A=false;B.namespace("mail.Error");B.mix(B.mail.Error,{handleV3:function(D){var H,E,G,I=D||[];for(var F=0;F<I.length;F++){E=I[F];if(B.mail.Error.isDependencyFailure(F,E.code)){continue;}E.method=E.id||this.extractMethod(E.resource);H=C.getErrorInfo(E);A=this.getErrorType(E.code);if(!G){G={"code":E.code,"message":H.message,"tae":H.tae,"type":A,"notificationDisplayed":false};}if(!H.suppressNotification&&A!==this.errorType.TEMPORARY&&A!==this.errorType.CLIENT){B.mail.Error.showTae(H);G.notificationDisplayed=true;}this.statV3(H,E);E.url=E.url?E.url:D.url;this.logV3(H,E);}return G;},extractMethod:function(F){var D,E;if(!F){return"unknown";}D=F.split("?");E=D[0].split("/");return(E.length&&E[E.length-1])||"unknown";},isFailedDependency:function(){return false;},statV3:function(I,F){var G,D,E,H={"convpane":"CONVREAD","messagepane":"MESSAGEREAD","search":"SEARCH","convlist":"CONVLIST","messagelist":"MESSAGELIST"};D=B.mail.Tabs.getActiveTab().widgetType;G=H[D]?H[D]:D;E=B.mail.Error.getColo();if(I.suppressStat){B.fire("util:ymstats",{"name":"client_error","tags":{"api":F.method,"tae":I.tae,"code":(I.customCode||F.code),"farm":NeoConfig.farm.substr(1),"colo":E,"httpStatusCode":F.status}});B.fire("stat:webservice_fail",{"tab":G,"tae":I.tae,"api":F.method,"message":F.code,"visible":"no"});}else{B.fire("util:ymstats",{"name":"ue_client_error","tags":{"api":F.method,"tae":I.tae,"code":(I.customCode||F.code),"farm":NeoConfig.farm.substr(1),"colo":E,"httpStatusCode":F.status}});B.fire("stat:webservice_fail",{"tab":G,"tae":I.tae,"api":F.method,"message":F.code,"visible":"yes"});}},logV3:function(G,D){var E=(G.suppressStat?"":"UE_")+"DEBUG_TAE:"+(G.tae||"null")+":"+(D.method||"null")+":"+(D.code||"null")+":"+NeoConfig.farm+":"+D.url+":NewV3",F={m:E,api:(D.method||"null")+" ",reason:(D.code||"null")+" ",errinfo:G,yid:NeoConfig.loginId,response:D};B.fire("MailLog",F,1,"tae"+G.tae);},getErrorType:function(E){var D;if(E&&E.match(/.+-.+/)){D=E.split("-")[0];switch(D){case"EP":return this.errorType.PERMANENT;case"EC":return this.errorType.CLIENT;case"ET":return this.errorType.TEMPORARY;}}return this.errorType.UNKNOWN;},errorType:{PERMANENT:"perm",TEMPORARY:"temp",CLIENT:"client",UNKNOWN:"unknown"},platform:{isAvailable:function(){return A!==B.mail.Error.errorType.PERMANENT;}},cleanUpOnSuceess:function(){A=false;}});},"1.0.0",{requires:["mail-error","common-ui-tabs-base","common-net-error","mail-errormap","ymma-stats","json-stringify","_shared_module_offscreen_bin_modal_launch_error_rollup"]});YUI.add("mail-ui-mailcompose-v3",function(e){function h(){var e=this;c.superclass.ondestroy.call(e,arguments)}function p(){var e=this;return e.dirty}function d(t,n,r,i,s){var o=this,u=t?t:strings.str_comp_dialogheader;if(o.suppressDialog===!0){r();return}e.use("common-ui-dialog-helper",function(e){var t={hd:u,bd:n,suppressRestoreFocus:!0};e.common.ui.DialogHelper.confirm(t,{ok:{text:s,handler:r},cancel:{handler:function(){o._restoreFocus(),i&&i()}}})}),o.hiliteCP&&o.hiliteCP.hide(),o.textCP&&o.textCP.hide()}function v(){var e=this;return e.draft.isUploadingAttachments()?1:0}function m(e){var t=this;t.focusNode=e,t.neoFire("composeEvent",{action:"setFocusNode",focusNode:e})}function g(){var e=this;e.setFocus(e.focusNode)}function y(){this.controller.edited(),this.dirty=!0,this.resetSaveTimer()}function b(){var e=this;e.controller.isEdited()&&(e.controller.unedited(),e.dirty=!1,e._cancelSaveTimer())}function w(){var t=this,n,r;return t.isRichText!==null?t.isRichText:(r=e.common.persist.UserData.get("userUIPref.useRichText"),n=r&&r!=="plain",t.isRichText=n,n)}function E(t){var n=this;n.isRichText!==t&&(n.isRichText=t,e.common.persist.UserData.set("userUIPref.useRichText",t?"dynamic":"plain"),setTimeout(function(){e.common.persist.UserData.saveOne("userUIPref.useRichText")},10),n.fire("isRichTextChanged"))}function S(){var t=this,n=!0,r=e.mail.Error.platform.isAvailable(),i=new Date-t.lastAutoSaveTime,s=Math.max(0,t.autoSaveTimePeriod-i);t._cancelSaveTimer(),r&&!NeoConfig.isAMT&&(t.saveTimer=e.later(s,t,function(){t.isAutoSave=!0,t.lastAutoSaveTime=new Date,t.save(),t._cancelSaveTimer()},[],!n))}function x(){var e=this;e.saveTimer&&(e.saveTimer.cancel(),e.saveTimer=null)}function T(t,n){var r=this,i=t?t:strings.str_comp_dialogheader;r.allowSend?e.use("common-ui-dialog-helper",function(e){r.allowSend=!1;var t={hd:i,bd:n,suppressRestoreFocus:!0},s=function(){r.allowSend=!0,r._restoreFocus()};e.common.ui.DialogHelper.alert(t,{ok:{handler:s},cancel:{handler:s}})}):r._restoreFocus()}function N(){this._cancelSaveTimer(),this.controller.save(this.isAutoSave)}function C(){return}function k(){var e=this;if(e.draft===null)return;e.updateSaveText(!0)}function L(){var e=this,t=e.richFontInfo,r=t.fontFamily,i=t.fontSize;return r||(r=n.getStyleFontFamily(!1)),i||(i=n.getStyleFontSize(!1)),{fontFamily:r,fontSize:i,foreColor:t.foreColor,backColor:t.backColor}}function A(){var e=this;e.isAutoSave=!1,e.save(),e.header&&e.header.hideACWidget(),e.dirty="ForceClose",e._closeAfterWarning(!0)}function O(){var n=this,r=n.areAttachmentsPending(),i='<button id="{{btnID}}ModalOverlay" class="btn left right {{default}}" role="button" data-action="{{btnID}}">{{btnLabel}}</button>';e.use("common-ui-dialog-helper",function(e){var s=t(i,{btnID:"SaveDraft","default":"default",btnLabel:strings.str_comp_savetodrafts_fresh}),o=t(i,{btnID:"DontSave",btnLabel:r?strings.str_comp_closewithoutsaving:strings.str_comp_abandon}),u=t(i,{btnID:"Continue","default":r?"default":"",btnLabel:r?strings.str_comp_returntomessage:strings.str_comp_keepwriting}),a=r?u+o:s+o+u,f=r?strings.str_comp_close_attachmentprocessing:strings.str_comp_close_confirm,l={modal_classes:"lg saveDraftDialog",hd:strings.str_comp_close,bd:f,ft:a,suppressRestoreFocus:!0},c={SaveDraft:{handler:function(){n.doSaveAndClose()}},DontSave:{handler:function(){n.header&&n.header.hideACWidget(),n.dirty="ForceClose",!n.hasHardDraft&&n.getDraftMID()&&e.use("mail-ui-proxyevents",function(){e.mail.ui.MailEventsProxy.handleUI({action:"delete"},"Draft",null,[{fid:"Draft",mid:n.getDraftMID(),force:!0}])}),n._closeAfterWarning(!1)}},Continue:{handler:function(){n.blockAutoSave=!1,n.cancelDialogLoad=!1,n._restoreFocus()}}},h=function(t){n.blockAutoSave=!0,t&&n.setFocus("to"),e.common.ui.DialogHelper.createCommon(l,c,function(e){e.set&&e.set("adAction","disableRetriggerOnOk")})};n.neoFire("composeEvent",{action:"showSaveDialog",sdcbk:e.bind(h,n),sdinline:n.type==="inlineCompose"})})}function M(){return this.draft.mid}function _(n){function o(){var t=e.common.Utils.features,n=t.enabled("NotificationsV2"),i=t.enabled("deleteDraftIcon"),s,o,u,a;r.getDraftMID()?e.use("mail-ui-proxyevents",function(){e.mail.ui.MailEventsProxy.handleUI({action:"delete"},"Draft",null,[{fid:"Draft",mid:r.getDraftMID(),force:!0}])}):i&&n&&r.dirty===!0&&(s=function(){},o={},a=[{fid:"Draft",mid:null,force:!0}],u=["Trash","Draft",a,null,"msg"],e.use("mail-ui-proxyevents",function(){e.mail.ui.MailEventsProxy.showMoveNotification(s,o,u)}))}var r=this,i=r.areAttachmentsPending(),s='<span id="{{btnID}}ModalOverlay" class="btn left right {{default}}"><a href="#" data-action="{{btnID}}">{{btnLabel}}</a></span>';if(!n){o();return}e.use("common-ui-dialog-helper",function(e){var n=t(s,{btnID:"Discard","default":"default",btnLabel:strings.str_comp_discard}),u=t(s,{btnID:"Continue","default":i?"default":"",btnLabel:strings.str_comp_keepwriting}),a=i?u+n:n+u,f=i?strings.str_comp_discard_attachmentprocessing:strings.str_comp_discard_confirm,l={modal_classes:"lg",hd:strings.str_comp_deletedraft,bd:f,ft:a,suppressRestoreFocus:!0},c={Discard:{handler:function(){r.header&&r.header.hideACWidget(),r.dirty="ForceClose",o(),r._closeAfterWarning(!1)}},Continue:{handler:function(){r.blockAutoSave=!1,r.cancelDialogLoad=!1,r._restoreFocus()}}},h=function(){r.blockAutoSave=!0,e.common.ui.DialogHelper.createCommon(l,c,function(e){e.set&&e.set("adAction","disableRetriggerOnOk")})};r.neoFire("composeEvent",{action:"showDeleteDraftDialog",sdcbk:e.bind(h,r)})})}function D(t){var n=this,r=n.baseNode&&n.baseNode.one(".attachment-button-attach"),i=n.baseNode&&n.baseNode.one("#rtetext");e.UA.gecko>0&&i&&(i.focus(),i.blur()),n.cancelDialogLoad=!0,n.hiliteCP&&n.hiliteCP.hide(),n.textCP&&n.textCP.hide();if(n.dirty==="ForceClose")return!0;var s=n.isDirty()||n.getDraftMID()&&!n.hasHardDraft&&!t,o=n.areAttachmentsPending();return o&&(s=n.dirty=1),n.get("isQuickReply")?n.doDiscardDraft(s):s?f.enabled("deleteDraftIcon")&&!o?n.doSaveAndClose():n.showSaveDraftDialog
():r&&r.fire("compose:close"),!s}var t=e.common.Utils.substitute,n=e.mail.Controller.ReplyProcessor,r=e.common.Utils,i=e.mail.model.DataStore,s=r.log,o=e.ui.Templates,u={reply_sender:strings.str_reply,reply_all:strings.str_reply,edit:strings.str_reply,forward:strings.str_forward},a=o._shared_module_compose_message_header_fresh,f=r.features,l=!1,c=function(n,r,h){var p=this,d=h&&h.showSubject;p.controller=r,p.header=new e.mail.Views.ComposeHeader(n,p),p.draft=n,p.isDraft=!p.draft.isFresh(),p.title=strings.str_comp_nosubject,p.parent=null,p.baseNode=null,p.compArea=null,p.loadingArea=null,p.type="compose",p.dirty=!1,p.focusNode=null,p.attachmentsLoading=[],p.attView=null,p.loadingTimer=null,p.allowEdit=!1,p.allowSend=!0,p.richFontInfo={fontFamily:null,fontSize:null},p.saveTimer=null,p.lastAutoSaveTime=new Date,p.hasHardDraft=!1,p.blockAutoSave=!1,p.lastSave=null,p.lastSaveType=null,p.isSending=!1,p.isRichText=null,p.isAutoSave=!1,i.Sessions.reset(),s("#SS: mailcompose init"),p.cancelDialogLoad=!1,p.contentLoaded=!1,p.stopwatch=h?h.stopwatch:null,p.origMsgFID=h?h.fid:null,p.suppressDialog=!1,l=f.enabled("rtePopoutToolbar"),l?p.formatTmpl=o._shared_module_rte_well_content_format_pop_out:p.formatTmpl=o._shared_module_rte_well_content_format_fresh,p.handles=[],p.autoSaveTimePeriod=(NeoConfig.autoSaveInSec||120)*1e3,p.formatters={page_well_email:function(){return t(o._shared_module_rte_well_tabs_compose.base,{},p.wellTabFormatters,null,strings,o)},page_well_format:function(){return t(p.formatTmpl.base,{},p.formatters,null,strings,o)},page_well_format_fresh:function(){return t(p.formatTmpl.base,{},p.formatters,null,strings,o)},page_well_emoticons:function(){return t(o._shared_module_rte_well_content_emoticons.base,{},p.formatters,null,strings,o)},page_well_attachments:function(){return t(o._shared_module_rte_well_content_attachments.base,{},p.formatters,null,strings,o)},quick_reply_card_actions:function(){if(f.enabled("deleteDraftIcon")){var e=p.parent&&p.parent.hasClass("quickReply");return e?null:t(a.quick_reply_card_actions,{},p.formatters,0,strings,o)}return t(a.quick_reply_card_actions,{},p.formatters,0,strings,o)},show_delete_draft_icon:function(){if(f.enabled("deleteDraftIcon"))return t(o._shared_module_compose_fresh_conv.show_delete_draft_icon,{},null,null,strings,o)},inConvReplyBucketBorder:function(){return f.enabled("convReplyBucket")?o._shared_module_compose_fresh_conv.inConvReplyBucketBorder:""},quickCompose:function(){if(p.get("isQuickReply"))return t(a.quickCompose,{},0,0,strings,o)},make_reply_all:function(){if(p.get("isQuickReply"))return;var e=p.draft.origin,n=e.action,r={title:n==="reply_all"||e.fid==="Sent"?strings.str_comp_btn_reply_sender:strings.str_comp_btn_reply_all};return n!=="reply_all"&&n!=="reply_sender"?"":t(a.make_reply_all,r,0,0,strings)},make_reply_all_qr:function(){var e=p.draft.origin,n=e.action,r={title:n==="reply_all"||e.fid==="Sent"?strings.str_comp_btn_reply_sender:strings.str_comp_btn_reply_all};return n!=="reply_all"&&n!=="reply_sender"?"":t(a.make_reply_all_qr,r,0,0,strings)},spellCheckEnabled:function(){return f.enabled("spellCheck")?t(p.formatTmpl.spellCheckEnabled,{},p.formatters,null,strings,o):""},is_rtl:function(){var e;return NeoConfig.bidi?(e=strings.str_tog_loadRTLCss?p.formatTmpl.is_rtl:p.formatTmpl.is_rtl_else,t(e,{},p.formatters,null,strings,o)):""},bidi:function(){return NeoConfig.bidi?t(p.formatTmpl.bidi,{},p.formatters,null,strings,o):""},page_compose_conversation:function(){return""},compose_from_address:function(){return t(a.compose_from_address,{},p.formatters,null,strings,o)},timestamp_id:function(){return(new Date).getTime()},fromSelected:function(e){return e.isDefault?' selected="selected" class="nsel"':""},fromAddress:function(e){return typeof e=="string"?e:typeof e=="object"&&typeof e.address=="string"?e.address:""},global_path_img:function(){return NeoConfig.globalPathImg+"/u/assets/img"},display_av_logo:function(){return NeoConfig.avLogoUrl?t(o._shared_module_rte_well_content_file_count.display_av_logo,{},p.formatters,null,strings,o):""},antivirus_logo_path_img:function(){return NeoConfig.avLogoUrl},page_compose_email_else:function(){return"hidden"},reply_type:function(){var e=p.draft.origin.action;return e?u[e]:strings.str_reply},smartscroll:function(){return e.common.Utils.features.enabled("smartscroll")?o._shared_module_compose_fresh_conv.smartscroll:""},intl_fonts:function(){function n(e,n){var r=o._shared_module_rte_well_content_fontnamesize_fresh;return t(r.intl_fonts,{},{font_value:function(){return e},font_name:function(){return n}},null,strings,o)}var r="";if(strings.str_cfg_intl_fonts){var i=e.JSON.parse(strings.str_cfg_intl_fonts);e.Array.each(i,function(e){r+=n(e.value,e.name)})}return r},show_formatter_well:function(){return l?"":t(o._shared_module_rte_well_fresh_conv.show_formatter_well,{},p.formatters,null,strings,o)},show_popout_toolbar:function(){return l?t(o._shared_module_rte_well_fresh_conv.show_popout_toolbar,{},p.formatters,null,strings,o):""},show_attachment_icon:function(){return NeoConfig.useAttComposerTT?t(o._shared_module_rte_well_fresh_conv.show_attachment_icon,{},p.formatters,null,strings,o):""},ca_icon:function(){return f.enabled("richcompose")&&(!p.get("isQuickReply")||f.enabled("richcomposeInQuickReply"))?t(o._shared_module_rte_well_fresh_conv.ca_icon,{},p.formatters,null,strings,o):""},bottomToolbar:function(){return t(o._shared_module_compose_fresh.bottomToolbar,{},p.formatters,null,strings,o)},subject_hidden:function(){return p.get("isQuickReply")&&!d?a.subject_hidden:""},less_than_IE10:function(){var n=e.UA.ie>0&&e.UA.ie<10;return n?t(a.less_than_IE10,{},p.formatters,null,strings,o):""},is_underline:function(){return NeoConfig.enableUnderline?t(p.formatTmpl.is_underline,{},p.formatters,null,strings,o):""},has_quote:function(){var e=p.draft.origin.action;if(NeoConfig.hasConv&&(e==="reply_sender"||e==="reply_all"||e==="edit"))return t(o._shared_module_compose_message_body.has_quote,{},p.formatters
,null,strings,o)},ca_active:function(){return f.enabled("richcompose")&&(!p.get("isQuickReply")||f.enabled("richcomposeInQuickReply"))?o._shared_module_compose_fresh_conv.ca_active:""}},c.superclass.constructor.call(p),p.addChild(p.header),p.header.on("HeaderBase:updateSubject",function(){p.neoFire("composeEvent",{action:"updateSubject"})}),p.header.on("HeaderBase:qrCancel",function(){p.neoFire("composeEvent",{action:"qrCancel"})})};e.extend(c,e.mail.ui.BaseWidget),e.mix(c.prototype,{NAME:"MailCompose",isDirty:p,_setDirty:y,_setClean:b,getHeader:function(){return this.header.getHeader()},_setHeader:function(e){this.header.setHeader(e)},areAttachmentsPending:v,resetSaveTimer:S,canClose:D,showSaveDraftDialog:O,doSaveAndClose:A,doDiscardDraft:_,getRichFontInfo:L,saveProgress:k,getDraftMID:M,_alertProblem:T,_invokeSaveDraft:C,save:N,_cancelSaveTimer:x,_closeAfterWarning:function(){},_registerFocus:m,_restoreFocus:g,_getTextMode:w,_setTextMode:E,confirm:d,ondestroy:h},!0),e.namespace("mail.Views").MailCompose=c},"1.0.0",{requires:["autocomplete_css","common-persist-user-data","mail-persist-meta-data","mail-controller-messages","mail-model-datastore","mail-controller-reply-processor","_shared_module_compose_message_header_fresh","mail-ui-mailcompose-base-header-v3","comms-utils","mail-ui-basewidget","editor-inline","mail-services-message-service","mail-error-v3","mail-common-utils-features"]});
YUI.add("comms-ui-menu-base",function(e){function h(s){function A(){o._link=s.host,p=o._root=D(s.menu),o.dontFocus=s.dontFocus||!1,o.dontFocus||o._root.setAttribute("tabIndex",-1),o._evt=[],o._tmFocus=null,o._fixedMenuGroup=s.fixedMenuGroup,o._overlap=s.overlap||!1,o._offset=s.offset||{x:0,menuUpY:0,menuDownY:0},o.closeMenu=e.Lang.isUndefined(s.closeMenu)?!0:s.closeMenu,G(),_(p,o._link),o.setAriaAttrs(p),J(s.keys),K(s.enterAccel),O()}function O(e){var t=p.all("li");(e||t&&t.size()!==T||w[0]&&!w[0].inDoc())&&M(t)}function M(e){var t=e.size(),r=0,i,s,o,u,a,f;T=0,w=[];for(u=0;u<t;u++)a=e.item(u),T++,a.getStyle("display")!=="none"&&!a.ancestor().hasClass("disabled")&&(a.hasClass("disabled")?a.one(".icon-help")&&a.one(".help-text")&&w.push(a.one(".icon-help")):(f===undefined&&a.hasClass(n)&&(f=r),w.push(a),x&&(i=a.one("em"),i&&(s=i.get("childNodes"),s&&(o=s.item(0),o&&x===o.get("text")&&(S=a)))),r++));p.all("li."+n).removeClass(n),E=typeof f=="undefined"?-1:f}function _(e,t){t.set("aria-haspopup","true"),e.setAttrs({role:"menu","aria-labelledby":t.getAttribute("id"),"aria-hidden":"true"})}function D(t){var n,r=t instanceof e.Node;if(r||typeof t=="string")r?n=t:(f("body").append(t),n=f("body").get("lastChild"));return n.setStyles({position:"absolute",zIndex:u}),n}function P(e,t){var n=f("window"),r=n.get("winHeight"),i=o._fixedMenuGroup,s=null,u="",a=t,p,v,b,w,S,x,T,C,k;if(e===o._root&&(!d||d())&&o._link.inDoc()){p=o._link.get("region");if(m)y&&(j(o._link),a=null),r>c&&(T=r-c),T<l&&(T=l),e.setStyles({maxHeight:T,overflowX:"hidden",overflowY:"auto",opacity:0}),v=F(a),g=t&&t.target||g;else{i&&(s=e.one("#"+i.menu),s.setStyle("maxHeight",i.height+"px")),e.setStyles({visibility:"hidden",display:"block",top:0,maxHeight:"none",opacity:0}),b=e.get("region").height,w=n.get("scrollTop"),C=p.top-w,k=r-(p.bottom-w),k>=C?u="below":b>k&&(u="above"),T=o._setMaxHeight(C,k,b,u),v=o._setPosition(p,u,b,T),e.setStyles({maxHeight:T,overflowX:"hidden",overflowY:"auto"}),s&&T<e.get("scrollHeight")&&s.setStyle("maxHeight","none"),S=e.get("winWidth"),S&&p.left+e.get("region").width>S&&(v.left="auto",v.right="0px");if(h||N)x=Math.max(p.left+p.width-e.get("region").width,0),v.left=x+"px",S>p.left+p.width&&(v.right="auto");v.visibility="visible"}O(),E=-1,e.setStyles(v),e.setStyle("opacity",1),o.dontFocus||e.focus()}}function H(e,t,n,r){var i={top:e.bottom,left:e.left,right:"auto"},s;return t==="below"?(o._overlap&&(i.top=e.top+o._offset.menuDownY),i.left+=o._offset.x):t==="above"?(o._overlap?s=e.bottom+o._offset.menuUpY:s=e.top,i.left+=o._offset.x,i.top=s-(n<r?n:r)+"px"):(o._overlap&&(i.top=e.top),i.left+=o._offset.x,i.top+=o._offset.menuDownY),i}function B(e,t,n,r){var i;return r==="below"?(i=t-c,i<l&&(i=l)):r==="above"?(i=e-c,i<l&&(i=l)):i=n,i}function j(t){var n=t.getXY(),r=parseInt(t.getStyle("height"),10)||20;return v=e.Lang.isNumber(r)?[n[0],n[1]+r]:n,v}function F(e){var t=o._root,n,r,i,s,u,a=15,f,l=o._link.get("winHeight"),c=0;return r=e?e.clientX:v[0],i=e?e.clientY:v[1],t.setStyles({display:"block",bottom:"auto",left:-1e3,right:"auto"}),f=parseInt(t.get("region").height,10),s=l-a-i<f,u=o._link.get("winWidth")-a-r<parseInt(t.get("region").width,10),n={top:i+c,left:r},s&&(n.top=l+c-f-a),u&&(n.left="auto",n.right=a+"px"),n}function I(e){e.setStyle("display","none"),e.removeClass(r),e.hasClass(t)&&e.removeClass(t),e!==o._root&&e.get("parentNode").removeClass(i),w[E]&&w[E].removeClass(n)}function q(t){var n;if(t){n=e.Node.getDOMNode(e.one(t)).nodeName,n=n.toUpperCase();switch(n){case"LI":return t;default:return t.ancestor("li")}}}function R(t){var n,r;n=q(t.target);if(!n)return;r=E,E=e.Array.indexOf(w,n),E>=0?X(r,E):E=r}function U(t){var n=E,r=t.target,i=e.one(document.activeElement),s,u,a;L=!0;switch(t.keyCode){case 38:case 40:t.halt(),W(t,n),s=w[E];if(!i||!i.hasClass("focus-node")){a=s&&s.one(".focus-node");if(!a||a.getStyle("display")==="none")a=s.one("a")||s;a&&a.focus()}break;case 27:o.hide(),t.halt(),m||(u=o._link.one("a")||o._link,u&&u.focus());break;case 13:e.use("node-event-simulate",function(){r.get("nodeName").toLowerCase()==="a"?(r.simulate("click"),t.halt(),o.hide()):r.hasClass("icon-help")?(r.simulate("click"),t.halt()):S&&(S.one("a").simulate("click"),o.hide())});break;default:b.length>0&&V(t)?o.hide(t):t.halt()}}function z(e){if(L){L=!1;return}switch(e.keyCode){case 38:case 40:e.halt()}}function W(e,t){e.keyCode===40?(E=E===w.length-1?0:E+1,X(t,E,!0)):e.keyCode===38&&(E=E<=0?w.length-1:E-1,X(t,E,!0))}function X(e,t,r){var i=this,s,o;if(s=w[e]){s.removeClass(n);if(!i.dontFocus){o=s.one(".focus-node");if(!o||o.getStyle("display")==="none")o=s.one("a")||s;o&&o.set("tabIndex",-1)}}if(s=w[t]){s.addClass(n);if(!i.dontFocus){o=s.one(".focus-node");if(!o||o.getStyle("display")==="none")o=s.one("a")||s;o&&(o.set("tabIndex",0),r&&o.scrollIntoView())}}}function V(t){var n,r,i,s,o,u,f;if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey){for(s=0;s<b.length;s++)if((r=(b[s]+"").split("+"))&&r.length>1){u=0;for(o=0;o<r.length;o++){i=r[o],f=i.toLowerCase()==="cmd"?"metaKey":i.toLowerCase()+"Key";if(a.isNumber(i*1)&&i*1!==t.keyCode||!a.isNumber(i*1)&&!t[f])break;u++}if(r.length===u){n=!0;break}}}else e.Array.indexOf(b,t.keyCode)>-1&&(n=!0);return n}function $(e){b=e}function J(e){a.isArray(e)?$(e):a.isFunction(e)?e.call(this,$):a.isString(e)&&$([e])}function K(e){e&&(a.isFunction(e)?e.call(this,Q):a.isString(e)&&Q([e]))}function Q(e){x=e}function G(){function t(){if(!o.isVisible())return;o.tmFocus&&o.tmFocus.cancel(),o._tmFocus=a.later(0,o,function(){try{var t=e.one("document").get("activeElement"),n=t.get("nodeName"),r;n!=="EMBED"&&n!=="OBJECT"&&(r=t.getAttribute("embed-type"),r!=="menu"&&o.hide())}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-ui-menu-js-menu:1",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-ui-menu-js-menu:1")}})}m?(o._evt.push(o._link.on("mousedown",function(){o.hide()},o)),o._evt.push(o._link.
on("contextmenu",function(e){o.toggle(e)},o))):(o._evt.push(o._link.on("mousedown",function(e){e.halt(),o.toggle(e)},o)),o._evt.push(o._link.on("keydown",function(e){if(e.keyCode===13||e.keyCode===32)e.preventDefault(),o.toggle(e)},o))),o._evt.push(o._root.on("blur",t,o)),o._evt.push(e.on("windowresize",function(){var n=e.one("body").get("clientWidth"),r=e.one("body").get("clientHeight");if(n!==C||r!==k)C=n,k=r,t()},o)),o._evt.push(o._root.on("focus",function(){o._tmFocus&&o._tmFocus.cancel()},o)),o._evt.push(o._root.on("keydown",U,o)),o._evt.push(o._root.on("keypress",z,o)),o._evt.push(o._root.on("mouseover",R,o)),o._evt.push(o._root.on("menu:changed",function(){M(p.all("li"))}))}function Z(){return p}function et(){return g}var o=this,h=f("body").getStyle("direction")==="rtl",p,d=s.button_enabled,v=s.xy||[0,0],m=s.isContext||!1,g=s.contextTarget||null,y=s.alignToTarget||!1,b=[],w=[],E,S=null,x=null,T=-1,N=s.flushLeft,C=e.one("body").get("clientWidth"),k=e.one("body").get("clientHeight"),L=!1;A(),e.mix(o,{setVisible:P,_setPosition:H,_setMaxHeight:B,hideMenu:I,checkDescendants:O,getMenuNode:Z,getContextTarget:et,selectMenuItem:function(){this.simulate&&this.simulate("mouseover")},getHost:function(){return o._link}})}var t="menu-active",n="menu-active-item",r="menu-visible",i="menu-visible-path",s="role",o="aria-hidden",u=15500,a=e.Lang,f=e.one,l=80,c=40;h.prototype={_detachHdlr:null,setAriaAttrs:function(e){var t=this;e.all("ul").set(s,"group"),e.all("li,div,h4").each(function(e){e.get(s)||e.set(s,"presentation")});var n=e.all("a");n.set(s,"menuitem"),t.dontFocus&&n.set("tabIndex",-1)},show:function(e){var n=this,r=n._root,i;n.isVisible()||(r.addClass(t),n.setVisible(r,e),r.set(o,!1),n.attachClickHdlr(!0),r.fire("menu:state",{state:"show",link:n._link,context:e&&e.context}))},hide:function(e){var t=this,n,r=t._root,i=e?e.type:null;t.isVisible()&&t.closeMenu&&(r.set(o,!0),!t.dontFocus&&(n=r.one('a[tabindex="0"]'))&&n.set("tabIndex",-1),t.hideMenu(r),r.fire("menu:state",{state:"hide",link:t._link,origEvtType:i})),t._detachHdlr&&t.closeMenu&&t.attachClickHdlr(!1)},toggle:function(e){this[this.isVisible()?"hide":"show"](e)},attachClickHdlr:function(t){var n=this;n._detachHdlr&&(n._detachHdlr.detach(),n._detachHdlr=null);if(t===!1)return;n._detachHdlr=e.on("click",function(t){var r=t.target,i=e.Node.getDOMNode(r),s=n._link.contains(r)||n._link===r,o=!1;e.UA.webkit&&!e.UA.chrome&&i.nodeName==="UL"&&(o=!0),t.preventDefault(),!o&&!s&&(n._tmFocus&&n._tmFocus.cancel(),n._root&&n._root._node&&n.hide())},document),e.UA.webkit&&!e.UA.chrome&&n._root.on("mousedown",function(t){var n=t.target,r=e.Node.getDOMNode(n).nodeName;r!=="A"&&(n=n.ancestor("a")),n&&n.focus()})},destroy:function(){var t,n=this;n.attachClickHdlr(!1);for(t in n._evt)e.detach(n._evt[t])},isVisible:function(){var t=this._root;return!t._node&&e.one(".dummy_menu_node")&&(t=e.one(".dummy_menu_node").menu._root),t._node?t.getStyle("display")!=="none":!1}},h.NAME="Menu",h.NS="menu",e.namespace("Plugin").Menu=h},"1.0.0");
YUI.add("_shared_module_offscreen_bin_menus_loading",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_menus_loading={base:'<div role = "menu" id = "loadingMenu" class="optionMenu" aria-live="polite"> <ul> <li><a href="#"><span>{{str_galaxy_status_loading}}</span></a></li> </ul></div>'};},"1.0.0");YUI.add("common-ui-menu-helper",function(e){e.namespace("common.ui");var t=function(){function t(t,n,r){var i,s=e.one("#loadingMenu");t.menu&&t.unplug(e.Plugin.Menu),n.menu&&n.menu instanceof e.Node&&n.menu.detachAll(),n=n||{},s&&s.remove(),t.plug(e.Plugin.Menu,n),t.menuCreated=!0;if(t.menu){t.menu._root.on("menu:state",function(t){e.fire("menu:display-state",{state:t.state,intl:NeoConfig.intl})}),e.on("menu:display-menu-close",function(){t&&t.menu&&t.menu.hide()}),i=t.menu.getMenuNode(),i.delegate("click",function(r){var s=e.common.Utils.getDataAction(r),o=s.action,u,a=s.node,f=r.currentTarget.one("a");if(!o||a&&a.hasClass("disabled")){r.halt();return}f&&(!f.getAttribute("href")||"#"===f.getAttribute("href"))&&r.preventDefault();if(r.target.hasClass("icon-help")){u=r.target.get("parentNode").get("parentNode").one(".help-text");if(u){e.Node(r._currentTarget).all(".help-text").each(function(e){e!==u&&e.addClass("hidden")}),u.toggleClass("hidden"),r.halt();return}}n.allowSimClick&&i._node.click(),i.fire("menuSelected",{dataAction:o,item:a});try{t.menu&&t.menu.hide(),n.isContext?i.blur():n.blur||(t.one("a")?t.one("a").focus():t.focus())}catch(l){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-menuhelper-menuhelper:1",l,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-menuhelper-menuhelper:1")}},"li, dd a"),e.fire("menu:created",i),!n.cbafter&&r&&r(),t.menu.show();if(!n.cbafter)return}r&&r()}function n(t,n){e.Lang.later(500,this,function(){var i=n?n.isContext?!0:!1:!1,s=t.get("region"),o=NeoConfig.isRTL,u=e.ui.Templates._shared_module_offscreen_bin_menus_loading,a=e.one("window"),f,l,c,h,p,d;if(e.one("#loadingMenu")||t.menuCreated)return;e.one("body").append(e.common.Utils.substitute(u.base,null,0,0,strings)),c=e.one("body").get("lastChild"),i?(f=n.xy||t.getXY(),l=r(t,c,f)):(c.setStyles({position:"absolute",visibility:"hidden",display:"block",top:0}),l={top:s.bottom,left:s.left,right:"auto"},h=c.get("region").height,p=a.get("scrollTop"),d=a.get("winHeight"),h>d-(s.bottom-p)&&h<s.top-p&&(l.top=s.top-h+"px"),o&&(l.left=s.left+s.width-c.get("region").width+"px"),l.visibility="visible"),l.zIndex=4e3,c.setStyles(l)})}function r(t,n,r){var i,s=r[0],o=r[1],u,a,f=15,l,c=t.get("winHeight"),h=e.one("window").get("scrollTop")||0;return n.setStyles({display:"block",bottom:"auto",left:-1e3,right:"auto",position:"absolute"}),l=parseInt(n.get("region").height,10),u=c-f-o<l,a=t.get("docWidth")-f-s<parseInt(n.get("region").width,10),i={top:o+h,left:s},u&&(i.top=c+h-l-f),a&&(i.left="auto",i.right=f+"px"),i}e.mix(this,{create:t,createLoadingMenu:n})};e.common.ui.MenuHelper=new t},"1.0.0",{requires:["common-utils","comms-ui-menu-base","_shared_module_offscreen_bin_menus_loading"]});
YUI.add("mail-services-plugins",function(B){var A={};function C(){}B.mix(C.prototype,{get:function(D){return(A[D]||[]).slice(0);},register:function(D,E){if(!A[D]){A[D]=[];}A[D].push(E);this.fire("added:"+D,E);},unregister:function(F,G){if(!A[F]){return;}var D=A[F],E=D.indexOf(G);D.splice(E,1);this.fire("removed:"+F,G);if(D.length===0){delete A[F];}}});B.augment(C,B.EventTarget);B.namespace("Mail.Services").Plugins=new C();},"1.0.0",{requires:["event-custom"]});