YUI.add("minty_module_offscreen_bin_hovercard_callout",function(A){A.namespace("ui.Templates");A.ui.Templates.minty_module_offscreen_bin_hovercard_callout={base:"<div id=\"hovercardCallout\" class='hovercardTooltip yui3-tooltips'> <div class='arrow'> </div> <div class=\"bd\" tabindex='0'> <label>{{str_hovercard_new_callerid}}</label> </div></div>"};},"1.0.0");YUI.add("contacts-ui-hovercard-onboard",function(A){var D,I=A.common.Utils,H=I.ezSub,B=A.mail.persist.MetaData,J="hasHovercardCalloutShown",F=["Draft","Sent","%40B%40Bulk","Trash"],E,C,G;D=function(){var K=this;A.on("hideHoverCardCallout",A.bind(K.closeCallout,K));};D.prototype={mailPane:null,callOutDataAddress:null,callOutNode:null,call:function(K){var L=this;L.callOutNode=null;L.callOutDataAddress=null;if(L.canDisplayCallout(K)){L.setupTriggerNode(K);if(L.isKnownContact(L.callOutDataAddress)){L.callOutNode.addClass("callout");L.showCallout();L.setCalloutShown();A.fire("util:ymstats",{name:"hovercard",tags:{action:"callout"}});}}},canDisplayCallout:function(K){var L=this;return(F.indexOf(K.mailpane.fid)<0&&L.hasCalloutShown()!=="true"&&L.callOutDataAddress!==NeoConfig.emailAddress);},hasCalloutShown:function(){return B.get(J);},setCalloutShown:function(){B.set(J,"true");B.save();},showCallout:function(){var M=this,S=A.ui.Templates.minty_module_offscreen_bin_hovercard_callout,Q=H(S.base),R=M.callOutNode,L=R.get("clientHeight"),P=R.get("clientWidth"),K=(P<175)?160:175,O=(K-P)/2,N=L+22;A.fire("onboard:tip",{node:M.callOutNode,template:Q,offset:[-O,-N]});M.callOutNode.setStyle("opacity",1);A.one("#hovercardCallout").setStyle("opacity",1);R.once("mouseenter",A.bind(M.closeCallout,M));A.one("document").once("click",A.bind(M.closeCallout,M));if(C===true){M.mailPane.getRoot().one(".thread-item-list").once("scroll",A.bind(M.closeCallout,M));}if(G===true){M.mailPane.getRoot().one(".base-card").once("scroll",A.bind(M.closeCallout,M));}},closeCallout:function(){var L=this,K=L.callOutNode||A.one(".hcard.callout");if(K){K.removeClass("callout");}A.fire("onboard:tipclose");},setupTriggerNode:function(K){var M=this,L;M.mailPane=K.mailpane;C=A.mail.ui.ConvPane&&M.mailPane instanceof A.mail.ui.ConvPane;G=A.mail.ui.MessagePane&&M.mailPane instanceof A.mail.ui.MessagePane;if(C===true){L=M.mailPane.getRoot().one(".thread-item.expanded");M.callOutNode=L&&L.one(".from.hcard");}if(G===true){M.callOutNode=M.mailPane.getRoot().one(".from-loz .hcard");}M.callOutDataAddress=M.callOutNode&&M.callOutNode.getAttribute("data-address");},isKnownContact:function(K){var L=A.contacts&&A.contacts.utils.getContactsByEmail(K)||[false];if(L[0]&&L[0].id>=0){return L[0].id;}return false;}};A.namespace("mail.ui");A.mail.ui.HoverCardOnboard=new D();},"0.0.1",{requires:["event-mouseenter","mail-ui-onboarding","contacts-api-utils","contacts-api","mail-persist-meta-data","hovercard_css","minty_module_offscreen_bin_hovercard_callout"]});