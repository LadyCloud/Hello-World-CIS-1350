YUI.add("mail-ui-sidekick-model",function(e){var t=e.common.net.SessionMgr,n=e.common.Utils.settings.value("sidekickClientTimeout",2e3),r="/neo/sidekick",i={execute:function(i,s,o){var u=r+"?fetchads="+(s?1:0),a=o?n+1e3:n;t.requestProxy(u,{on:{success:function(t,n){var r=!1;switch(n&&n.status){case 200:try{r=e.JSON.parse(n.responseText)}catch(s){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-sidekick-sidekickModel:1",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-sidekick-sidekickModel:1")}break;case-1:break;default:}i(!0,r)},failure:function(e,t,n){i(!1,t)}},method:"GET",service:"sk",serviceCredType:"loose",timeout:a})}};e.namespace("mail.ui"),e.mail.ui.sidekickModel=i},"1.0.0",{requires:["event-base","common-net-sessionmgr","json-parse","common-utils"]});
YUI.add("mail-ui-sidekick-view",function(e){var t="lst-tag",n=e.common.Utils,r=function(e,t,n){this.darlaAPI=e,this.adContainerNode=t,this.sidekickContainerId=n};r.prototype={prepareView:function(t){var n,r,i,s;typeof React!="undefined"&&(t.html&&(s=e.Node.create(t.html),i=s.one("style"),i&&e.one("head").appendChild(i)),t.js&&(n=e.Node.create(t.js),n.all("script").each(function(e){r=e.get("text"),this.addScriptToDOM(r)}.bind(this))))},renderComponent:function(t){var r,i=!1,s=NeoConfig.expBucketId,o=e.one("#"+this.sidekickContainerId);return typeof SidekickModuleHandler!="undefined"&&(n.features.enabled("sidekickRR")&&o&&(this.clean(),o=!1),e.fire("sidekick:render"),o?i=!0:(r=e.Node.create('<div id="'+this.sidekickContainerId+'"></div>'),i=SidekickModuleHandler.renderComponent(e,r,this.adContainerNode,t,s),i&&this.updateRapid())),i},addScriptToDOM:function(e){var t=document.createElement("script");try{t.text=e,document.body!==null&&document.body.appendChild(t)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-sidekick-sidekickView:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-sidekick-sidekickView:1"),console.log("Sidekick: Error adding script to DOM"+n.message)}},isSidekickPresent:function(){return typeof Sidekick!="undefined"&&typeof SidekickModuleHandler!="undefined"&&typeof sidekickConfig!="undefined"?!0:!1},updateRapid:function(){n&&n.Rapid&&(n.Rapid.isModuleTracked(this.sidekickContainerId)?n.Rapid.refreshModule(this.sidekickContainerId):n.Rapid.registerModule(this.sidekickContainerId,t))},clean:function(){var t=e.one("#"+this.sidekickContainerId);t&&(typeof SidekickModuleHandler!="undefined"&&SidekickModuleHandler.unMountComponent(),t.get("parentNode").removeChild(t))}},e.namespace("mail.ui"),e.mail.ui.sidekickView=r},"1.0.0",{requires:["event-base","common-utils"]});
YUI.add("mail-ui-sidekick-controller",function(e){var t=e.mail.ui.sidekickModel,n=!1,r=!1,i=!1,s=!1,o="#theAd",u="td-applet-react-sidekick_container",a=["LREC","MON","SKY"],f=function(){};f.prototype={init:function(o){this.darlaAPI=o,this.initView(),e.once("core-modules-loaded",function(){r||this.execute()},this),e.on("darla:blankAdLoaded:sidekick",function(e,t){var o=n&&!i;s=!0,!r||o?(i=o,this.execute(function(){this.render(e,t)}.bind(this))):this.render(e,t)},this),e.on("sidekick:fetchads",function(){var e=!0;t.execute(function(e,t){e&&this.view.prepareView(t)}.bind(this),e)},this)},render:function(t,r){var o=!1,u="unknown",f=r&&r.rightRailAdPos;!n&&f&&s&&a.indexOf(f)>=0&&(o=this.view.renderComponent(f),u=o?u:"component_failed"),o?e.fire("util:ymstats",{name:"sidekick_rendered",tags:{bkt:NeoConfig.expBucketId,ad_pos:f,retry:i?"true":"false"}}):(this.view.clean(),s&&e.fire(this.darlaAPI.blankAdLoadedDefaultEvent,t,r),e.fire("util:ymstats",{name:"sidekick_render_failed",tags:{bkt:NeoConfig.expBucketId,ad_pos:f,reason:this.getFailureKey(u)}}))},getFailureKey:function(e){var t;return n?t="init_failed":s?typeof React=="undefined"?t="react_undefined":t=e:t="not_safe",t},initView:function(){var t=e.one(o);this.view=new e.mail.ui.sidekickView(this.darlaAPI,t,u),e.on(["adReturned:LREC","adReturned:MON","adReturned:SKY","showTrendingModule"],function(){s=!1,this.view.clean()},this)},execute:function(e){r=!0,t.execute(function(t,r){t?(this.view.prepareView(r),this.view.isSidekickPresent()?n=!1:this.statFailure(!1)):this.statFailure(!0,r),e&&e()}.bind(this),!1,i)},statFailure:function(t,r){var s=!1;n=!0,r&&r.status&&(s=r.status),e.fire("util:ymstats",{name:"sidekick_init_failed",tags:{bkt:NeoConfig.expBucketId,reason:t?"api":"client",status:s?s:"none",retry:i?"true":"false"}})}},e.namespace("mail.ui"),e.mail.ui.sidekickController=new f},"1.0.0",{requires:["event-base","mail-ui-sidekick-model","mail-ui-sidekick-view"]});
