YUI.add("mail-models-draft",function(e){function o(e){return!!r[e]}function u(e){var t={};return e.name&&(t.name="Doe"),e.email&&(t.email="doe@x.com"),t}function a(t,n){switch(t){case"simpleBody":n.html&&(n.html="<html-filtered>"),n.text&&(n.text="<text-filtered>");break;case"to":case"cc":case"bcc":case"from":case"replyTo":e.Lang.isArray(n)&&e.Array.each(n,function(e){n=u(e)})}return n}function f(){this.csid=null,this.mid=null,this.cid=null,this.state="uninitialized",this.captcha=null,this.to=[],this.cc=[],this.bcc=[],this.replyto={name:"",email:""},this.from={name:"",email:""},this.subject="",this.body={html:"",text:""},this.origin={action:null,fid:null,oMsg:null,yqtdPrefix:"",ctxReq:null,forwardAsAttachment:!1,errInfo:null},this.folder={id:""},this.attachments=[],this.inreplyto="",this.references=[],this.spame="U",this.draftModelId=i++,this.publish("stateChanged"),this.isRead=!0}var t=e.common.Utils.verify,n=e.common.Utils.guid,r=e.Array.hash(["uninitialized","saved","unsaved","saving","savingAndSending","sending","captchaing","sent","final"]),i=1,s=e.Array.hash(["Y","N","C","U"]);e.mix(f.prototype,{fireEvent:function(t,n){try{this.fire.apply(this,arguments)}catch(r){e.fire("MailLog",{m:"ComposeV3: Draft: Exception occured while firing event : "+t,exp:r})}},addAttachment:function(e){this.attachments.push(e);if(!e.contentId()){var t="<"+n()+"@yahoo.com"+">";e.setContentId(t)}this.fireEvent("attachmentAdded",e)},removeAttachment:function(e){var t=0,n=this.attachments;for(t=0;t<n.length;t++)if(n[t].contentId()===e){n[t].setState("deleted");break}},isFresh:function(){return!this.origin.oMsg||this.origin.oMsg.sourceFolderInfo.fid!=="Draft"},generateCsid:function(){var e;this.hasCsid()||(e="000000000"+(Math.floor(Math.random()*1e9)+(new Date).getTime()%1e9).toString(),this.csid=e.substr(e.length-10))},hasCsid:function(){return!!this.csid},hasMid:function(){return!!this.mid},isInConv:function(){return e.common.Utils.getVal(this,"origin.oMsg.cid",null)!==null},isRejectedOnCaptcha:function(){return!!e.common.Utils.getVal(this,"captcha.captchaPayload")},isUploadingAttachments:function(){return(this.state==="saving"||this.state==="savingAndSending"||this.state==="unsaved")&&this.attachments.filter(function(e){return e.state()==="uploading"}).length>0},isUploadingInlineImages:function(){return(this.state==="saving"||this.state==="savingAndSending"||this.state==="unsaved")&&this.attachments.filter(function(e){return(e.state()==="uploading"||e.state()==="pending")&&e.isInline()&&e.isImage()}).length>0},hasAttachmentsToReconcile:function(){return this.attachments.filter(function(e){return e.state()==="saved"||e.state()==="uploaded"||e.state()==="pending"&&e.size()!==0}).length>0},_createAttachJson:function(t,n,r){var i=[],s=2;return t=t||{},e.Array.each(n,function(e){var n=e.state(),o=e.size(),u={disposition:e.disposition()},a=n==="saved"||n==="uploaded",f=n==="pending"&&o!==0||r&&n==="uploading";if(a||f)a?(u.messageReference={id:e.mid(),pid:e.partId()},u.contentId=e.contentId()):f&&(e.setPartId("multipart://att"+s),t.iframeUpload&&e.setPartId("multipart://"+t.iframeUpload.multipartName),u.multipartName=e.partId(),u.contentId=e.contentId(),s++),i.push(u)}),i},jsonifyObj:function(t,n){var r=this,i,s=["subject","to","cc","bcc"],o=["folder"],u={actions:{responseMessage:!0,responseMessageV2:!0},message:{csid:r.csid,captcha:r.captchaAnswer,flags:{spam:!1,read:this.isRead},headers:{}},simpleBody:{}};return t=t||{},r.body.html!==""?u.simpleBody.html=r.body.html:u.simpleBody.text=r.body.text,this.attachments.length>0&&(u.simpleBody.attachments=this._createAttachJson(t,this.attachments,n)),r.body.html?u.simpleBody.html=r.body.html:u.simpleBody.text=r.body.text,e.Array.each(o,function(e){u.message[e]=r[e]}),e.Array.each(s,function(e){u.message.headers[e]=r[e]}),i=r.makeInReplyTo(),i?(u.message.inReplyTo=i,u.message.newMessage=!1):u.message.newMessage=!0,r.replyto.email&&(u.message.headers.replyTo=[r.replyto]),u.message.headers.from=[r.from],u},setRead:function(e){this.isRead=e},jsonify:function(t){return e.JSON.stringify(this.jsonifyObj(t),null,4)},getLogInfo:function(t){var n=this.jsonifyObj(t,!0);return n.draftModelId=this.draftModelId,e.JSON.stringify(n,a)},setState:function(n,r){var i={prev:this.state,next:n};t(o(n),"Draft: Illegal model state: "+n);if(i.prev==="final"||i.prev==="sent"&&i.next!=="final")return;i.next!==i.prev&&e.fire("MailLog",{m:"v3 draft state change",info:"modelID: "+this.draftModelId+", next: "+i.next+", prev: "+i.prev}),this.state=n,r&&(i.err=r),this.fireEvent("stateChanged",i)},setSpame:function(e){t(!!s[e],"Draft: Illegal spame code: "+e),this.spame=e},setHeader:function(e){this.to=e.to||[],this.cc=e.cc||[],this.bcc=e.bcc||[],this.from=e.from||{},this.replyto=e.replyto||{},this.subject=e.subject||""},setOrigin:function(e){this.origin=e;var t=this.origin.oMsg,n,r;t&&(n=this.origin.action==="edit",r={from:t.from,subject:t.subject,cc:n?t.cc:this.cc,bcc:n?t.bcc:this.bcc},this.setHeader(r)),this.fireEvent("originChanged")},setBody:function(e,t){var n=this.body.text!==e||this.body.html!==t;n&&this.state==="saved"&&this.setState("unsaved"),this.body.text=e||"",this.body.html=t||""},notifyBodyChanged:function(e){this.fireEvent("bodyChanged",e)},notifyHeaderChanged:function(e){this.fireEvent("headerChanged",e)},isSaved:function(){return this.state==="saved"},isSpame:function(){return this.spame==="N"},makeInReplyTo:function(){var t,n,r=!1;return t=e.common.Utils.getVal(this,"origin.oMsg",null),t&&(this.origin.action==="edit"?(n=e.common.Utils.getVal(t,"inReplyToV3MsgRef",null),n&&n.messageReference&&(r={replied:n.replied?!0:!1,forwarded:n.forwarded?!0:!1,messageReference:{id:n.messageReference.id}})):r={replied:this.origin.action==="reply_sender"||this.origin.action==="reply_all",forwarded:this.origin.action==="forward",messageReference:{id:this.origin.oMsg.mid}}),r&&r.messageReference&&r.replied^r.forwarded?r:undefined}}),e.augment(f,e.EventTarget,!0,null,{prefix:"draft"}),e.namespace("Mail.Models"
).Draft=f},"1.0.0",{requires:["common-utils","event-custom","json","oop"]});
YUI.add("comms-utils",function(e){e.namespace("comms");var t={},n=e.Lang,r=n.trim,i=/{{([^{}]*)}}/g;e.mix(t,{substitute:function(e,n,r,s,o,u,a){if(typeof e!="string")return;return a&&(e=a.str||e,n=a.obj||n,r=a.formatters||r,s=a.args||s,o=a.strings||o,u=a.templates||u),e.replace(i,function(e,f){var l,c,h=t.substitute;return r&&(l=a&&a.formatters?a.formatters[f]:r[f])?l(n,s,a)||"":n&&f in n?(c=n[f],typeof c=="string"&&c.match(i)?h(c,n,r,s,o,u,a):c):o&&f in o?(c=o[f],c.match(i)?h(c,n,r,s,o,u,a):c):u&&f in u?h(u[f].base||u[f],n,r,s,o,u,a):""})},escapeHtml:function(e){return e===null?null:(e=""+e,e=e.replace(/&(?!(amp|lt|gt|quot|#39|#92);)/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\\/g,"&#92;"),e)},unescapeHtml:function(e){return e===null?null:(e=""+e,e=e.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&quot;/g,'"'),e=e.replace(/&#39;/g,"'"),e=e.replace(/&#92;/g,"\\"),e)},createAddress:function(e){var n=!1,i=null,s=null,o=/(<[^<>]+@[^<>]+\.[^<>]+>)|(\([^\(\)]+@[^\(\)]+\.[^\(\)]+\))|(\[[^\[\]]+@[^\[\]]+\.[^\[\]]+\])/,u,a=e.replace(/\".*\"/g,"");return!r(a)||a.indexOf("@")<0?{fail:!0,email:e,name:t.escapeHtml(e)}:(o.test(e)?(u=e.match(o),s=u[0],i=r(e.replace(s,"")),s=s.substring(1,s.length-1)):s=i=r(e),t.isValidEmail(s)||(n=!0),{fail:n,email:s,name:t.escapeHtml(i)})},isValidEmail:function(e){if(!e)return!1;var t=0,n=e,r=e.lastIndexOf("@"),i=e.substr(0,r),s=i.replace(/\\\\/g,""),o=e.substr(r+1),u=o.length,a=/^(\\.|[A-Za-z0-9!#%&`_=\/$'*+?^{}|~.-])+$/,f=/^"(\\"|[^"])+"$/,l=/^[A-Za-z0-9\-]+$/;!a.test(s)&&!f.test(s)&&(n=!1),o=o.split("."),u=o.length,u<2&&(n=!1);while(t<u)l.test(o[t++])||(n=!1);return n},splitName:function(e){var t={},n,i,s=r(e),o,u,a=[],f=strings.str_name_format.replace(/\{|\}/g,"").split(" "),l=!1,c=!0;f[0]==="family_name"&&(l=!0),f.length<3&&(c=!1);while(s){o=s.match(/([^\u3000\s]*)[\u3000\s]+/);if(!o||o.length!==2||!o[0]){a.push(s);break}a.push(o[1]),s=s.substring(o[0].length)}n=a.length;for(i=0;i<n;i+=1){u=a[i];switch(i){case 0:t[l?"familyName":"givenName"]=u;break;case 1:c&&2<n?t.middleName=u:t[l?"givenName":"familyName"]=u;break;case 2:c?t[l?"givenName":"familyName"]=u:t[l?"givenName":"familyName"]+=" "+u;break;default:t[l?"givenName":"familyName"]+=" "+u}}return t}}),e.comms.Utils=t},"1.0.0",{requires:[]});
YUI.add("mail-model-attachment",function(e){var t=e.common.Utils,n=t.verify,r=t.escapeHtml,i=t.unescapeHtml,s=e.Array.hash(["saved","pending","uploading","failed","infected","deleted","uploaded"]),o=function(t,u){var a=u,f=t,l="pending",c=u.partId,h=u.contentId,p=!0,d=null,v={prefix:"attachment"},m,g,y,b,w=function(){e.use("tictac-att-filter",function(e){var t=m.getFileExtension();y=e.Tictac.att.filter.map(a.type,t),b=!!o.DOC_PREVIEW_TYPES[y]})};return a&&a.partId&&(l="saved"),m={getFilename:function(){return a.filename},getFileExtension:function(){var e=a.filename.match(/[^.]+$/)[0]||"";return e.toLowerCase()},getFileType:function(){return y==="undefined"&&w(),y},isImage:function(){var e=this.getFileExtension();return!!o.IMAGE_EXTENSIONS[e]},isViewableDoc:function(){return typeof b=="undefined"&&w(),b},contentId:function(){return h},deleted:function(){var e=this;e.fire("deleted"),e.destroySlideshow()},disposition:function(){return a.disposition||"attachment"},getDownloadUrl:function(){return a.downloadUrl},getThumbnailUrl:function(){return a.thumbnailurl},file:function(){return a.file},isInline:function(){return a.referencedInline===!0||a.disposition==="inline"},inputEl:function(){return a.inputEl},mid:function(){return f},size:function(){return a.size||0},state:function(){return l},partId:function(){return c},setContentId:function(e){h=e},setData:function(t){a=e.clone(t),a.partId&&this.setPartId(a.partId)},setMid:function(e){f=e},setPartId:function(e){c=e},setProgress:function(e){this.loaded=e,this.fire("progress",this.loaded)},setState:function(t){var r=!!s[t];n(r,"Attachment: Illegal model state: "+t),t!==l&&e.fire("MailLog",{m:"v3 attach state change",info:"contentId: "+(h?h:"none")+", filename: "+(a.filename?a.filename:"none")+", next: "+t+", prev: "+l}),l=t,this.fire(l),this.fire("changedState",l)},setSavedInfo:function(e){this._savedInfo=e},getSavedInfo:function(){return this._savedInfo},isViewable:function(){var e=this;if(e.getThumbnailUrl()||e.isViewableDoc())return!0},getHumanReadableSize:function(){var e=a.size||0,t=1024,n=t*t;return e>=n?(e/n).toPrecision(4)+"MB":e>=t?(e/t).toPrecision(3)+"KB":e+"B"},convertThumbnailURL:function(e,t,n){var r="&w="+t+"&h="+(n||t),i=/&w=\d*&h=\d*$/;return e?e.match(i)?e.replace(i,r):e+r:""},destroySlideshow:function(){g&&g.destroy()},openSlideshow:function(n){var s=this;g?g.show(0,!0):e.use("tictac-att-slideshow","ymma-stats").then(function(e){var o=a.filename,u=o.lastIndexOf(".")>0?o.lastIndexOf("."):o.length,f=o.substr(0,u),l=o.substr(u)||"",h=a.thumbnailurl,p={aid:c,mid:t,fullsize:h?s.convertThumbnailURL(h,3e3):"",thumbnailurl:h,has_thumbnail:!!h,filename:a.filename,filenameWithoutExtension:f,filenameExtension:l,filesize:s.getHumanReadableSize(),filetype:s.getFileType(),isDoc:s.isViewableDoc(),isViewable:s.isViewable(),getAttachmentUrl:a.downloadUrl},d={attachments:[p],position:0,showDropboxLinK:!0,stats:e.common.Utils.ymmastats};g=new e.Tictac.att.Slideshow(d),g.on("download:single",function(){e.use("mail-services-plugins",function(e){var t=e.Mail.Services.AttachIO,o=s;t.getDownLoadUrl(o).then(function(e){return n.download([{filename:r(i(o.getFilename())),url:e}])})["catch"](function(){g._showError()})})}),g.on("dropbox:single",function(){e.use("mail-services-plugins",function(e){var t=e.Mail.Services.Plugins.get("attachmentDownloader"),n=e.Mail.Services.AttachIO,o=s;n.getDownLoadUrl(o).then(function(e){return t[0].download([{filename:r(i(o.getFilename())),url:e}])})["catch"](function(){g._showError()})})}),g.show(0,!0)})}},e.augment(m,e.EventTarget,p,d,v)};o.IMAGE_EXTENSIONS=e.Array.hash(["jpg","jpeg","gif","png","bmp","tiff","tif","jif","jfif","jp2","jpx","j2k","j2c","pcd"]),o.DOC_PREVIEW_TYPES=e.Array.hash(["pdf","xls","doc","ppt"]),e.namespace("mail.Models").Attachment=o},"1.0.0",{requires:["common-utils","event-custom"]});
YUI.add("mail-controller-text-processor",function(D){function A(){}var C=D.common.Utils,B={address:1,blockquote:1,body:1,caption:1,center:1,col:1,colgroup:1,dd:1,dir:1,div:1,dl:1,dt:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,li:1,menu:1,ol:1,p:1,pre:1,table:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,ul:1};D.mix(A.prototype,{convertToPlain:function(H,I,G){var J=H.cloneNode(true),F=D.Node.getDOMNode(J),E=this.convertGuts(F);if(I){E=this._formatPlaintextForDisplay(E,true);}if(G){E=this.clearNonBreakingSpaces(E);}return E;},convertHTMLToPlain:function(G,I){var E=D.Node.create("<div>"+G+"</div>"),H=D.Node.getDOMNode(E),F=this.convertGuts(H);if(I){F=this._formatPlaintextForDisplay(F);}return F;},clearNonBreakingSpaces:function(E){return E.replace(/\xA0/g," ");},convertGuts:function(F){var E=D.UA.ie;if(!E){this._removeIrrelevantTextNodes(F);}else{F.innerHTML=F.innerHTML.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,"<BR/>");}return this._richToPlain(F,false,"").replace(/\n[\s\xA0]+$/,"");},_richToPlain:function(H,L,M){var O=D.one(H),J,P;if(O.hasClass("compose-ignore")){return"";}else{if(H.nodeType===1||H.nodeType===11){var G=H.tagName;if(D.UA.ie&&H.tagName==="DIV"&&H.getAttribute("class")&&H.getAttribute("class")!==null&&H.getAttribute("class").indexOf("hr")!==-1){G="HR";}switch(G){case"SCRIPT":case"STYLE":case"LINK":case"OBJECT":case"EMBED":return"";case"HR":P=H.previousSibling;return(this._isLineBreak(P)?"":"\n")+M+"________________________________\n"+M;case"BR":return"\n"+M;case"BLOCKQUOTE":M+=">";default:J=[];var E=H.firstChild;var K=0;while(E!==null){var N=this._richToPlain(E,E.tagName==="PRE",M);if(E.nodeType===1){if(this._getDisplayType(E)==="block"&&J.length>0&&E.tagName!=="TD"){var I=N.match(/^[ \t\r\n\v\f]*$/);if(!I||E.tagName==="LI"){J.push("\n"+M);}}switch(E.tagName){case"LI":K++;J.push("\t"+(E.parentNode.tagName==="OL"?K+".":"*")+" ");break;}}if(N){J.push(N);}if(E.nodeType===1){switch(E.tagName){case"TD":J.push(" ");break;}}E=E.nextSibling;}return J.join("");}}else{if(H.nodeType===3){J=H.nodeValue;if(!L){P=H.previousSibling;var F=P?this._getDisplayType(P):null;J=this._isLineBreak(P)?J:J.replace(/\n[ \t\r\n\v\f]+/g," ");if(P===null||this._isLineBreak(P)){J=J.replace(/^[ \t\r\n\v\f]+/,"");}else{if(F==="block"){J=J.replace(/^[ \t\r\n\v\f]+/,"\n");}else{if(F==="inline"){J=J.replace(/^[ \t\r\n\v\f]+/," ");}}}J=J.replace(/[ \t\r\n\v\f]+$/," ");}return J;}else{return"";}}}},_isLineBreak:function(E){if(E===null||E.nodeType!==1){return false;}return E.tagName==="BR";},_getDisplayType:function(E){if(E===null||E.nodeType!==1){return null;}if(E.style.display){if(E.style.display==="block"){return"block";}else{if(E.style.display==="inline"){return"inline";}}}return B[E.tagName.toLowerCase()]?"block":"inline";},_removeIrrelevantTextNodes:function(H){if(H.nodeType===1||H.nodeType===11){var F=H.firstChild;while(F!==null){var J=F.nextSibling;this._removeIrrelevantTextNodes(F);F=J;}}else{if(H.nodeType===3){var G=H.nodeValue;if(G.match(/^[ \t\r\n\v\f]*$/)){var E=H.previousSibling;var I=E?this._getDisplayType(E):"inline";if(I==="inline"&&!this._isLineBreak(E)){H.nodeValue=H.nodeValue.replace(/\n.*/," ");}else{H.parentNode.removeChild(H);}}}}},_formatPlaintextForDisplay:function(F,E){F=C.escapeHtml(F);if(E){F=F.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");F=F.replace(/( ){2}/g,"&nbsp;&nbsp;");}F=F.replace(/\n/ig,"<br />");return F;},_removeControlCharacters:function(F){var G=F,E=/[\x01-\x08\x0B-\x0C\x0E-\x1F\x7F-\x84\x86-\x9F]/ig;G=G.replace(E,"");return G;},process:function(E){var F=this.convertToPlain(E,false,true);F=this._removeControlCharacters(F);return F;}});D.namespace("mail.Controller").TextProcessor=new A();},"1.0.0",{requires:["common-utils","node"]});YUI.add("mail-models-serializers-draft-gdm-unserializer",function(e){var t=function(e,t,n){for(var r in n){var i=n[r];if(t.hasOwnProperty(i.contentId)){var s=t[i.contentId];s.setMid(e.mid),s.setData(n[r]),s.setProgress(1),s.setState("uploaded")}}},n=function(e,t){var n,r=t.length,i;for(n=0;n<r;n++){var s=t[n];e.hasOwnProperty(s.contentId)&&(i=e[s.contentId],i.setSavedInfo(s))}},r=function(e){e.attachments.filter(function(e){e.state()==="uploaded"&&e.setState("saved")})},i=function(e,t){e.mid=t.mid,e.cid=t.cid},s=function(){};e.mix(s.prototype,{update:function(s,o,u){var a=u.result.messageV2,f=u.result.simpleBody.attachments||[];i(s,a),o&&e.Object.size(o)>0?(n(o,f),t(s,o,a.part.slice(1))):r(s)},addAttachments:function(t,n,r){if(n.attachments){var i,s,o=!0;for(s=0;s<n.attachments.length;s++)o=r?r(n.attachments[s]):!0,o&&(i=new e.mail.Models.Attachment(n.mid,n.attachments[s]),t.addAttachment(i))}},addNonInlineAttachments:function(e,t){this.addAttachments(e,t,function(e){return e.referencedInline!==!0&&e.disposition!=="inline"})},hasNonInlineAttachments:function(e){var t,n;if(e.attachments)for(t=0;t<e.attachments.length;t++){n=e.attachments[t];if(n.referencedInline!==!0&&n.disposition!=="inline")return!0}return!1},addIds:function(e,t){i(e,t),e.csid=t.csid,e.csid||(e.draftToDelete=t.mid)}}),e.namespace("Mail.Models.Serializers").DraftGdmUnserializer=s},"1.0.0",{requires:["mail-model-attachment"]});
YUI.add('calendar_strings', function(Y) {
Y.namespace("mail");
Y.mix(strings,{"str_cal_fmt_addEvent_date":"{MM}\/{dd}\/{yyyy}","str_cal_fmt_add_event_time":"{h}:{mm}{tt}","str_cal_dateformat_AM":"AM","str_cal_dateformat_PM":"PM","str_cal_ae_never":"Never","str_cal_ae_daily":"Daily","str_cal_ae_weekly":"Weekly","str_cal_ae_monthly":"Monthly","str_cal_ae_yearly":"Yearly","str_cal_err_title_length":"Length of the title should be less than 1024 characters","str_cal_err_title":"Please specify a title for the event","str_event_saved":"Event Saved","str_cal_err_date":"Enter a valid date in the format","str_cal_err_email_id_title":"Please enter a valid email address in format: name@domain.com","str_cal_err_enddate":"Start Date should be before the End Date","str_cal_err_frequency":"The duration of the event must be shorter than how frequently it occurs. Shorten the duration or change the repeat pattern.","str_cal_err_invite":"There is a formatting problem with email address you entered. Be sure to use this format: user@example.com","str_cal_err_name":"Please specify a display name for the calendar","str_cal_err_reminder":"Please select at least one way to receive reminders","str_cal_err_time":"Enter a valid time in the format","str_cal_err_title_calendar":"Please specify a title for the calendar","str_cal_err_title_friends_id":"Please specify your friend's Email address","str_cal_err_title_ical":"Please enter a valid ical address","str_cal_err_title_todo":"Please specify a title for the ToDo","str_cal_err_title_todo_list":"Please specify a title for the ToDo List","str_cal_err_weekly_repeat":"Select at least a day for weekly repeat.","str_cal_mod_addevent":"New Event","str_event_title":"Title","str_event_AllDay":"All-Day","str_event_remindMe":"Remind Me","str_cal__label_repeat":"Repeat:","str_event_location":"Location","str_event_notes":"Notes","str_event_added_to_calendar":"This event has been added to your Calendar."});
}, '1.0.0');YUI.add("mail-ui-common-fonts",function(D){var A=D.mail.persist.MetaData,B="cg.pref.general.plaintextcomposefont",E={"1":"str_mailopt_fontvalue_1","2":"str_mailopt_fontvalue_2","3":"str_mailopt_fontvalue_3","4":"str_mailopt_fontvalue_4","5":"str_mailopt_fontvalue_5","6":"str_mailopt_fontvalue_6","7":"str_mailopt_fontvalue_7","8":"str_mailopt_fontvalue_8","9":"str_mailopt_fontvalue_9"};function C(){return A.get(B);}D.namespace("mail.ui.common").Fonts={getPlainTextOption:function(){var H=C(),G,F;if(H){G=Math.floor(H/100);F=[strings[E[G]],(H%100),"pt"];}return F;}};},"1.0.0",{requires:["mail-persist-meta-data"]});YUI.add("_shared_module_compose_reply",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_reply={base:"{{reply_rich}} {{reply_plain}} {{cchdr}} {{fwdhdr}} {{qthdr}} {{qtftr}} {{subject}} {{origHeader}} {{rulerHeader}} {{reply_rich_short}} {{reply_plain_short}} ",reply_rich:'<br> {{quotetext_header}} <div style="font-family: {{fontfamily}}; font-size: {{fontsize}};"> <div style="font-family: {{deffontfamily}}; font-size: {{deffontsize}};"> <div {{headerDir}}> {{reply_rich_header}} <font size="2" face="Arial"> <b><span style="font-weight:bold;">{{str_comp_reply_from}}</span></b> {{from_data}}<br> <b><span style="font-weight: bold;">{{str_comp_reply_to}}</span></b> {{to_data}} {{cchdr}}<br> <b><span style="font-weight: bold;">{{str_comp_reply_date}}</span></b> {{date_data}}<br> <b><span style="font-weight: bold;">{{str_comp_reply_subject}}</span></b> {{subject_data}}<br> </font> </div> <div class="y_msg_container"><br>{{reply_rich_body}}<br><br></div> </div> </div> {{quotetext_footer}} ',reply_plain:"<div> <br> <div>{{reply_plain_header}}<br> {{quoteprefix}}{{str_comp_reply_from}} {{from_data}}<br> {{quoteprefix}}{{str_comp_reply_to}} {{to_data}}<br> {{quoteprefix}}{{str_comp_reply_cc}} {{cc_data}}<br> {{quoteprefix}}{{str_comp_reply_date}} {{date_data}}<br> {{quoteprefix}}{{str_comp_reply_subject}} {{subject_data}}<br> {{quoteprefix}}<br>{{reply_plain_body}} </div> </div> ",cchdr:'<br><b><span style="font-weight: bold;">{{str_comp_reply_cc}}</span></b> {{cc_data}} ',fwdhdr:"{{str_comp_reply_fwdHeader}}<br> ",qthdr:'<blockquote style="border-left: 2px solid rgb(16, 16, 255); margin-left: 5px; margin-top: 5px; padding-left: 5px;"> ',qtftr:"</blockquote> ",subject:"{{subject_prefix}} {{subject_data}} ",origHeader:"{{str_comp_reply_origHeader}}<br> ",rulerHeader:'<hr size="1"> ',forward_rich_body:'<div class="qtdSeparateBR"><br><br></div> ',reply_rich_short:'{{forward_rich_body}} <div class="yahoo_quoted"> <div style="font-family: {{fontfamily}}; font-size: {{fontsize}};"> <div style="font-family: {{deffontfamily}}; font-size: {{deffontsize}};"> <div {{headerDir}}> <font size="2" face="Arial"> {{str_comp_reply_short}}<br> </font> </div> {{quotetext_header}} <br><br> <div class="y_msg_container">{{reply_rich_body}}<br><br></div> {{quotetext_footer}} </div> </div> {{quotetext_footer}} </div> ',reply_plain_short:"<div> <br> <br> <div> {{quoteprefix}}{{str_comp_reply_short}}<br> {{quoteprefix}}{{reply_plain_body}} </div> </div> "};},"1.0.0");YUI.add("mail-controller-signature-processor",function(D){var A=D.common.persist.UserData,B=D.common.Utils;function C(){}D.mix(C.prototype,{insertSignature:function(E,F){var I=this,H,G=I.getSignature(A.get("userSendPref.defaultID"));if(G){H=this.injectSignature(E.body.html,F,G);if(H){E.setBody(null,H);}}},getSignature:function(I){var J=A.get("userSendPref"),F,E,H;if(strings.str_cfg_tog_use_accountbased_signature&&I&&I!==J.defaultFromAddress){E=A.get("aliases.alias");for(var G=0;G<E.length;++G){H=E[G];if(I===H.address){F={text:H.signature,isRich:H.signatureType==="d",isActive:H.addSignature};break;}}}else{F={text:J.signatureText,isRich:J.richTextSignature==="plainhtml"||J.richTextSignature==="dhtml",isActive:J.signatureActive};}return F&&F.isActive&&F.text?F:null;},injectSignature:function(J,G,K){var H=this,F,E,M=K&&K.isRich,L=K&&K.text;if(!L){return"";}L=H._getSignatureText(L,M);L="<div class='signature'>"+L+"</div>";if(!M){L=H._cleanAndEscapeSignature(L);}else{if(!G||G==="plain"){try{E="<br>";L=L.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,E);L=L.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,E);L=L.replace(/((<p\s+[^>]*>)|(<p\s*>)&nbsp;<\/p>)/gi,E);L=L.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,E);L=L.replace(/(<br\s+[^>]*>)|(<br\s*>)/gi,E);L=L.replace(/(<br\/\s+[^>]*>)|(<br\/\s*>)/gi,E);L=L.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"");L=L.replace(/<\/p>/gi,E);L=L.replace(/(<hr\s*>)/gi,E+"________________________________"+E);L=D.mail.Controller.TextProcessor.convertHTMLToPlain(L,true);}catch(I){}}}J=J||"";F=J!=="";if(L!==""){if(D.UA.ie||D.UA.webkit){if(F){J=J+"<div></div><div>&nbsp;</div>"+L;}else{J="<div></div><div>&nbsp;</div>"+L+J;}}else{if(F){J=J+"<div>&nbsp;</div>"+L;}else{J="<div>&nbsp;</div>"+L+J;}}}return J;},_getSignatureText:function(F,E){if(F!==null){if(!E){F=F.replace(/<vbr>|\n/gi,"<br />");return"<div>"+F+"</div>";}else{F=F.replace(/<vbr>/gi,"");}}return F||"";},_cleanAndEscapeSignature:function(G){var F,E;G=B.unescapeHtml(G);G=G.replace(/<hr\s*[^>]*>/gi,"<div><hr></div>");G=G.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,"endptagpblanklineppblanklinepstartptag");G=G.replace(/((<br\s+[^>]*>)|(<br\s*>))((<br\s+[^>]*>)|(<br\s*>))/gi,"endptagpblanklinepstartptag");G=G.replace(/((<p\s+[^>]*>)|(<p\s*>)&nbsp;<\/p>)/gi,"endptagpblanklinepstartptag");G=G.replace(/(((<div\s+[^>]*>)|(<div\s*>))&nbsp;<\/div>)/gi,"endptagpblanklinepstartptag");G=G.replace(/(<br\s+[^>]*>)|(<br\s*>)/gi,"brtag");G=G.replace(/(<br\/\s+[^>]*>)|(<br\/\s*>)/gi,"brtag");G=G.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"startptag");G=G.replace(/(<p\s+[^>]*>)|(<p\s*>)/gi,"startptag");G=G.replace(/<\/p>/gi,"endptag");F=G.replace(/<div\s+[^>]*dir\s*=\s*[\'|\"]ltr[\'|\"]\s*[^>]*>/gi,"ltrstartptag");F=F.replace(/<div\s+[^>]*dir\s*=\s*[\'|\"]rtl[\'|\"]\s*[^>]*>/gi,"rtlstartptag");F=F.replace(/(<div\s+[^>]*>)|(<div\s*>)/gi,"startptag");G=F.replace(/<\/div>/gi,"endptag");E=B.escapeHtml(G);E=E.replace(/brtag/g,"<br />");E=E.replace(/ltrstartptag/g,"<div dir='ltr'>");E=E.replace(/rtlstartptag/g,"<div dir='rtl'>");E=E.replace(/startptag/g,"<div>");E=E.replace(/endptag/g,"</div>");E=E.replace(/pblanklinep/g,"<br/><br/>");return E;}});D.namespace("mail.Controller").SignatureProcessor=new C();},"1.0.0",{requires:["mail-controller-text-processor","common-persist-user-data","common-utils"]});YUI.add("mail-ui-mailcompose-header-form-list-helper",function(e){function l(){var e=new f,t,n,i=r?r.getCurrentAccount():null;return e.init(),t=e.getFromList(),n=e.getSelectedIndex(),i&&i!==r.getPrimaryAccount()?{name:i.description,email:i.email}:{name:t[n].name,email:t[n].addr}}function c(e,t){return!t&&e.header.replyto&&e.header.replyto.length>0?e.header.replyto[0]:e.header.from}function h(e){var n,r={email:t.get("userSendPref.defaultFromAddress"),name:t.get("userSendPref.defaultFromName")};return e.fid==="Sent"?c(e.oMsg):(n=p(e.oMsg.header.to,r),n||(n=p(e.oMsg.header.cc,r)),n||(n=p(e.oMsg.header.bcc,r)),n||(n=l()),n)}function p(n,r){var i,s=null,o={},u=(t.get("externalAccounts")||{}).extAccount||[],a=(t.get("aliases")||{}).alias||[],f=(t.get("disposableAddresses")||{}).deaName||[],l=function(e){if(e&&e.address&&e.address===o.email)return s={email:e.address,name:e.fromName},!0};for(i=0;!s&&i<n.length;i++){o=n[i];if(o.email===r.email)return r;e.Array.some([].concat(u,a,f),l)}return s}function d(){var e={},n=(t.get("externalAccounts")||{}).extAccount||[],r=(t.get("aliases")||{}).alias||[],i=(t.get("disposableAddresses")||{}).deaName||[],s=n.concat(r,i),o=t.get("userSendPref"),u,a,f=s.length;o.defaultID&&(e[o.defaultID]=1),o.defaultFromAddress&&(e[o.defaultFromAddress]=1);for(a=0;a<f;a++)if(u=s[a].address)e[u]=1;return e}function v(){var e=(t.get("externalAccounts")||{}).extAccount||[],n=(t.get("aliases")||{}).alias||[],r=(t.get("disposableAddresses")||{}).deaName||[];return[].concat(e,n,r)}function m(n){var r=n,i=t.get("userSendPref.defaultFromAddress");return i===n?r=t.get("userSendPref.defaultReplyToAddress")||i:e.Array.some(v(),function(e){var t=e&&e.address&&e.address;return t===n?(r=e.replyTo||e.address,!0):!1}),r=e.Lang.trim(r),e.comms.Utils.isValidEmail(r)?r:n}var t=e.common.persist.UserData,n=NeoConfig.accounts,r=e.mail.model.DataStore.Accounts,i="imapIn",s="externalAccounts",o="disposableAddresses",u="aliases",a="default",f=function(){this._init=!1,this._fromAddrList=[],this._selectedItemIndex=0,this._visible=!1};f.prototype={_buildAddresListItem:function(e,n){var r=t.get("userSendPref")&&t.get("userSendPref").defaultFromName||"";return{addr:e.address||e.email,name:e.fromName||r,source:n,isRTL:e.fromNameDir==="rtl",isDefault:!!e.isDefault}},_verifyInit:function(){if(!this._init)throw"FromOptionList is not initialized."},_populateAddressList:function(){var r,f,l,c=[],h,p,d=(t.get("externalAccounts")||{}).extAccount||[],v=(t.get("disposableAddresses")||{}).deaName||[],m=(t.get("aliases")||{}).alias||[],g=n.imapInAccounts?n.imapInAccounts.length:0,y=g>0?n.imapInAccounts:[],b=t.get("userSendPref"),w;for(r=0;r<g;r++)if(y[r].isPrimary){y.splice(r,1),g--;break}w=[{list:y,length:g,type:i,allowedAsFrom:function(e){return e.status==="ENABLED"}},{list:d,length:d.length,type:s,allowedAsFrom:function(e){return!!e&&!!e.mailFromAllowed}},{list:v,length:v.length,type:o,allowedAsFrom:function(e){return!(!e||!!strings.tog_check_active_compos&&!e.activeComposition)}},{list:m,length:m.length,type:u,allowedAsFrom:function(e){return!!e}}];for(f=0;f<w.length;f++){p=w[f];for(r=0;r<p.length;r++)l=p.list[r],p.allowedAsFrom(l)&&(h=this._buildAddresListItem(l,p.type),e.comms.Utils.isValidEmail(h.addr)&&c.push(h))}b&&(h=this._buildAddresListItem({address:b.defaultFromAddress,fromName:b.defaultFromName,isDefault:!0},a),e.comms.Utils.isValidEmail(h.addr)&&c.push(h)),this._fromAddrList=c},_sortAddressList:function(){this._fromAddrList=this._fromAddrList.sort(function(e,t){var n=e.name+e.addr,r=t.name+t.addr;return n<r?-1:n>r?1:0})},changeSelection:function(e){var t=0;for(t=0;t<this._fromAddrList.length;t++)if(this._fromAddrList[t].addr===e)return this._selectedItemIndex=t,!0;return!1},getSelectedIndex:function(){return this._verifyInit(),this._selectedItemIndex},getFromList:function(){return this._verifyInit(),e.clone(this._fromAddrList)},getVisible:function(){return this._verifyInit(),this._visible},init:function(){var e=t.get("userSendPref");this._populateAddressList(),this._sortAddressList(),this._fromAddrList.length>(e?1:0)&&(this._visible=!0),this.changeSelection(e.defaultID||e.defaultFromAddress),this._init=!0}},e.namespace("mail.Controller").mailComposeFromListHelper={FromOptionList:f,getReplyFromAddress:h,getDefaultFromAddress:l,getAllAccountEmails:d,getReplyTo:m}},"1.0.0",{requires:["comms-utils","common-persist-user-data","mail-persist-meta-data"]});
YUI.add("mail-controller-reply-processor",function(e){function x(){return strings.str_cfg_tog_compose_autoattach_prefix||T(m)==="yes"}function T(e){return d.get("cg.pref."+e)}function N(e,t){var n=i.getVal(e,"origin.action"),r=i.getVal(e,"origin.parentMsg"),s=i.getVal(e,"origin.parentMsg.fid"),o,u,a;return n!=="edit"&&!t.fetchGDM?Promise.resolve(e.origin.oMsg):t.fetchGDM?(o={fid:s||"Inbox",msg:r||e,cachekey:"Prime"},a=this.requestMessage(r,o),a.then(function(t){return t},function(t){return t}),a):(u=i.getVal(e,"origin.parentMsg.part"),u&&u.length>0?Promise.resolve(e.origin.parentMsg):Promise.resolve())}function C(n,r){var i,s,o=t&&t.Controller?t.Controller.Messages:{},u=n?n.mid||0:0;if(u&&r.fid)return s=new Promise(function(t,n){function s(e){t(e)}function u(e){n(e)}var i={success:s,failure:u,suppressCodes:"[*]"};r.fid&&r.msg?o.get(r,i):e.fire("MailLog",{m:"GDM failed in attach in reply",fid:r.fid,msg:r.msg},1,"attachInReplyFailure")}),s}function k(e){var t=0,n=e.attachments;for(t=0;t<n.length;t++)n[t].setState("deleted")}function L(t,n){var r=this,s=t.origin.action,o,u,a=i.getVal(t,"origin.parentMsg.flags.hasAttachment");return a&&(o=new e.Mail.Models.Serializers.DraftGdmUnserializer,u=r.getParentMsg(t,n),u.then(function(n){o.addNonInlineAttachments(t,n)},function(t){})),u}function A(e,t){var n=e.to.concat(e.cc),r,s,o=t.to.concat(t.cc),u={};for(r=0;r<o.length;r++){var a=i.getVal(o[r],"email");u[a]||(u[a]=1)}for(s=0;s<n.length;s++){var f=i.getVal(n[s],"email");if(!u[f])return{hasNewRecipients:!0}}return{hasNewRecipients:!1}}function O(e){var t=v+e.replace(/\r?\n|(.{0,80})\r?\n|(.{1,80})$|(.{1,80} +)/mg,"$1$2$3<br />"+v);return t=t.replace(/(^[\>|(?:&gt;)]+|\<br \/\>(?:\>|\&gt\;)*)/mgi,"$1 "),t.substring(0,t.length-v.length)}function M(t,n){var r,i=document.createElement("div");return i.innerHTML=t,r=e.mail.Controller.Compose.convertGuts(i),n||(r=s(r)),i.innerHTML="",i=null,r}function _(e){var t=e.oMsg.part;if(t)for(var n=0;n<t.length;n++)if(t[n].subtype==="html")return!0;return!1}function D(e){return e&&(e=e.replace(y,"$1"),e=e.replace(b,"$1"),e=e.replace(w,"")),e}function P(e){var t,n;return e?{fontFamily:t=B(!0),fontSize:n=j(!0)}:H()}function H(){var e,t;return t=p.get("userUIPref.composeFontFamily"),t=t.split("|"),t.length>1?t=t[0]:(t=B(!1),p.set("userUIPref.composeFontFamily",t+"|1")),t||(t=B(!1),p.set("userUIPref.composeFontFamily",t+"|1")),e=p.get("userUIPref.composeFontSize"),e?e+="px":e=j(!1),{fontFamily:t,fontSize:e}}function B(e){return e?F()[0]:strings.str_rte_default_font}function j(e){if(e){var t=F();return""+parseInt(t[1],10)+t[2]}return parseInt(strings.str_rte_default_font_size,10)+"px"}function F(){return e.mail.ui.common.Fonts.getPlainTextOption()||[strings.str_comp_plaintext_default_font,strings.str_comp_plaintext_default_font_size,"px"]}function I(e,t){var n=0,r=t.length,i=new Array(r);while(r--)i[n]=e(t[n++]);return i}function q(e){return e.name?e.name:e.email}function R(e){var t="";return e.name&&(t=U(e.name)?'"'+e.name+'"':e.name),e.email&&(t+=t.length?" <"+e.email+">":e.email),t}function U(e){return e.match(/[;,"<>@]/)!==null}function z(e,t){return!t&&e.header.replyto&&e.header.replyto.length>0?e.header.replyto[0]:e.header.from}function W(e,t,n){return e=X(e,n),I(t?R:q,e).join("; ")}function X(e,t){return V(e,t)}function V(e,t){var n,r,i,s=[],o;for(n=0;n<e.length;n++){o=!1;if(!e[n].email)continue;i=e[n].email.toLowerCase();if(t)for(r=0;r<t.length;r++)if(i===t[r].email.toLowerCase()){o=!0;break}o||(s.push({name:e[n].name,email:e[n].email}),t&&t.push(e[n]))}return s}function $(){return new RegExp("(^re:\\s?)|(^fw:\\s?)|(^"+strings.str_comp_reply_spRE+"\\s?)|"+"(^"+strings.str_comp_reply_spFWD+"\\s?)","i")}function J(){}var t=e.mail,n=e.mail.Controller.Messages,r=e.common,i=r.Utils,s=i.escapeHtml,o=i.unescapeHtml,u=i.substitute,a=t.Controller.mailComposeFromListHelper,f=a.getReplyFromAddress,l=a.getDefaultFromAddress,c=e.ui.Templates,h=c._shared_module_compose_reply,p=r.persist.UserData,d=t.persist.MetaData,v=">",m="general.prefixreplyquotetype",g=null,y=new RegExp(/<a[^>]*href="([^\s]*?)"[^>]*>[\s]*<span[^>]*id="?lw_\d*?_\d*?"?[^>]*>http(([\s]|[^\s])*?)<\/span>[\s]*<\/a>/ig),b=new RegExp(/<span[^>]*id="?lw_\d*?_\d*?"?[^>]*>(([\s]|[^\s])*?)<\/span>/ig),w=new RegExp(/<script[^>]*[^>]*>(([\s]|[^\s])*?)<\/script>/ig),E={subject_prefix:function(e){return strings[e.action==="forward"?"str_comp_reply_spFWD":"str_comp_reply_spRE"]},subject_data:function(e){return g||(g=$()),e.oMsg.header.subject.replace(g,"")}},S={quotetext_header:function(){return x()?h.qthdr:""},quotetext_footer:function(){return x()?h.qtftr:""},fontfamily:function(){return H().fontFamily},fontsize:function(){return H().fontSize},deffontfamily:function(){return B(!1)},deffontsize:function(){return j(!1)},from_data:function(e){return s(o(R(z(e.oMsg,!0))))},to_data:function(e){return s(o(W(e.oMsg.header.to,!0)))},cchdr:function(e){return e.oMsg.header.cc.length>0?u(h.cchdr,e,S,null,strings):""},cc_data:function(e){return s(o(W(e.oMsg.header.cc,!0)))},date_data:function(e){return s(i.dateFormatter(new Date(e.oMsg.header.receivedDate*1e3),strings.str_tog_dateformat_header_l10n))},subject_data:function(e){return s(o(e.oMsg.header.subject))},reply_rich_body:function(e){return D(e.oMsg.body.display)},forward_rich_body:function(e){return e.action==="forward"?h.forward_rich_body:!1},reply_rich_header:function(e){var t=NeoConfig.hasConv?"":h.rulerHeader,n=e.action==="forward"?h.fwdhdr:t;return u(n,null,null,null,strings)},reply_plain_body:function(e){var t=D(e.oMsg.body.display);if(x()){try{t=M(t)}catch(n){}t=O(t)}return t},reply_plain_header:function(e){return strings[e.action==="forward"?"str_comp_reply_fwdHeader":"str_comp_reply_origHeader"]},quoteprefix:function(){return x()?v+" ":""},headerDir:function(){return NeoConfig.isRTL?' dir="rtl" ':' dir="ltr" '}};e.mix(J.prototype,{fetchOrigin:function(t,r,i,s,o){var u=this,a=t.origin;if(a.action&&a.fid&&a.oMsg){a.ctxReq&&e.mail.Controller.Messages&&n.abort(a.ctxReq);
var f,l={truncateAt:null},c={success:function(e,t){u._fetchSuccess(e,t),o&&o()},failure:function(e,t){u._fetchFailure(e,t)},draft:t,isDraft:r,isRichText:i,stopwatch:s};f={fid:a.fid,msg:a.oMsg,cachekey:"Prime",ovparams:l},s&&!s.CMGStart&&(s.CMGStart=new Date),e.use("mail-controller-messages",function(){e.mail.Controller.Messages.get(f,c)})}},_fetchSuccess:function(e,t){var n=this,r=t.draft,i=r.origin,s=t.stopwatch,o={};e.mid?(s&&(s.CMGEnd||(s.CMGEnd=new Date,t.respProps&&(s.wasCached=t.respProps.wasCached)),s.CMGSize=e.body.display.length),i.oMsg=n.validateMsg(e),i.ctxReq=null,i.errInfo="ok",i.yqtdPrefix=e.yivPrefixNumber,r.setOrigin(i),n._updateFromOrigin(i,r,t.isDraft,t.isRichText,o)):n._fetchFailure({msg:this.message},t)},validateMsg:function(t){var n,r;if(t&&t.header&&t.header.replyto&&t.header.replyto.length>0){r=t.header.replyto;for(n=r.length-1;n>=0;n--)!e.comms.Utils.isValidEmail(r[n].email)&&r.splice(n,1)}return t},_fetchFailure:function(e,t){var n=t.draft,r=n.origin;r.errInfo=e,n.setOrigin(r)},_updateFromOrigin:function(t,n,r,i,s){var o=this,u,a;o._markAsRead(n),u=o._transformOrigin(t,n,r,i);if(!r){var l=f(t),c=e.mail.Controller.SignatureProcessor.getSignature(l.email),h,p=!0;s&&s.noSig&&(p=!1),c&&p&&(h=e.mail.Controller.SignatureProcessor.injectSignature(null,u.isRichText,c),u.prolog=strings.str_cfg_tog_insert_signature_bottom?u.prolog+h:h+u.prolog)}n.setOrigin(t),a=new e.Mail.Models.Serializers.DraftGdmUnserializer,r&&a.addIds(n,t.oMsg),t.action==="forward"||t.action==="edit"?a.addAttachments(n,t.oMsg):a.addAttachments(n,t.oMsg,function(e){return e.referencedInline===!0||e.disposition==="inline"}),n.cc&&n.cc.length>0&&(u.header.cc||(u.header.cc=[]),u.header.cc=u.header.cc.concat(n.cc)),n.bcc&&n.bcc.length>0&&(u.header.bcc||(u.header.bcc=[]),u.header.bcc=u.header.bcc.concat(n.bcc)),o.updateDraft(n,u)},updateDraft:function(e,t){e.setHeader(t.header),e.setBody(null,t.prolog),e.notifyHeaderChanged({reply:!0}),e.notifyBodyChanged({reply:!0,isRichText:t.isRichText})},_markAsRead:function(t){e.use("mail-controller-messages-ops",function(){var n=t.origin,r={},i=new Array(n.oMsg);r.read=1,e.mail.Controller.Messages.flag({fid:n.fid,mid:i,setFlags:r},{failure:function(){},suppressCodes:["Client.MessageIdsNotFound"]})})},_transformOrigin:function(e,t,n,r){var i=this,s,o=e,u={prolog:null,header:null,attachments:null,isRichText:r};return n?(u.header=o.oMsg.header,u.prolog=D(o.oMsg.body.display),u):(u.header=i.getHeaderContent(o),s=i.getBody(t,o,r),u.prolog=s.markup,u.isRichText=s.isRichText,u)},getBody:function(e,t,n){var r=_(t),i;return NeoConfig.hasConv?i=u(n||r?h.reply_rich_short:h.reply_plain_short,t,S,e,strings):i=u(n||r?h.reply_rich:h.reply_plain,t,S,e,strings),!n&&r&&(n=!0),{markup:i,isRichText:n}},getHeaderContent:function(t){var n=this,r,i=t.action==="reply_sender"||t.action==="reply_all",s={from:null,to:null,cc:null,subject:null},u=[],a=[],c=t.fid==="Sent"||t.fid==="%40S%40Search"&&t.oMsg.sourceFolderInfo.fid==="Sent";return s.from=i?f(t):l(),i&&(r=z(t.oMsg),t.action==="reply_sender"?(a.push(r),s.to=a):(c||a.push(r),u.push(r),u.push(s.from),s.to=a.concat(X(t.oMsg.header.to,u)),s.cc=X(t.oMsg.header.cc,u),c&&s.to.length===0&&s.cc.length===0&&(s.to=t.oMsg.header.to,s.to.length===0&&(s.cc=t.oMsg.header.cc)))),s.subject=o(n.seedSubject(t)),c||e.Array.each(t.oMsg.header.replyto||[],function(t){var n=s.to;n&&e.Array.indexOf(n,t)<0&&e.Array.indexOf(a,t)<0&&s.to.push(t)}),s},seedSubject:function(e){var t=e.action==="reply_sender"||e.action==="reply_all"||e.action==="forward";return t?(e.oMsg.header.subject===strings["str_msg-view_no_subject"]&&(e.oMsg.header.subject=""),u(h.subject.replace(/\s+$/,""),e,E,null,strings)):e.oMsg.header.subject}}),e.mix(J.prototype,{getDefaultFromAddress:l,htmlToText:M,getStyleFontFamily:B,getStyleFontSize:j,getDefaultFontInfo:P,matchRecipients:A,getParentMsg:N,requestMessage:C,includeAttachment:L,excludeAttachment:k}),e.namespace("mail.Controller").ReplyProcessor=new J},"1.0.0",{requires:["mail-models-draft","comms-utils","mail-model-attachment","mail-controller-messages","mail-controller-text-processor","common-persist-user-data","mail-persist-meta-data","mail-models-serializers-draft-gdm-unserializer","mail-ui-common-fonts","_shared_module_compose_reply","mail-controller-signature-processor","mail-ui-mailcompose-header-form-list-helper"]});
YUI.add("_shared_module_compose_title",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_title={base:"<span class='compose'><span>{{str_comp_title}}</span>{{compose_title}}</span>"};},"1.0.0");YUI.add("_shared_module_compose_quick_reply_card_actions",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_quick_reply_card_actions={base:'<div class="qr-card-actions {{tallCompose}}"> <span class="right"><a tabindex="0" data-action="qr-cancel" role="button" class="icon icon-close" title="{{str_btn_discard}}"></a></span></div>',tallCompose:"tallCompose"};},"1.0.0");YUI.add("_shared_module_compose_message_header_fresh",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_compose_message_header_fresh={base:'<div class="compose-header fresh"> {{show_full_header}} {{more_recipients_str}} </div> ',quick_reply_card_actions:"{{_shared_module_compose_quick_reply_card_actions}} ",compose_from_address:'<option value="{{fromAddress}}"{{fromSelected}}>{{fromAddress}}</option> ',quickCompose:'<span class="menu" data-action="menu"> <a href="#" aria-haspopup="true" role="button" class="icon arrow-down" title="{{str_comp_btn_menu_reply_options}}"><b></b></a></span>',make_reply_all:'<span class="small makereplyall-btn replyall-toggle-btn hidden" data-action="make-replyall"> <a id="btn-switch-reply-mode" tabindex="-1" role="button">{{title}}</a> </span>',conversation_user:'<li role="presentation" class="recipient"> <span class="small lozenge {{lozengeerror}}"><a>{{conversation_user}}</a></span> </li> ',subject_hidden:"hidden",conversation_user1:"Our conversation on {{timestamp}}",less_than_IE10:'<span class="IEplaceholder cm-subject-field"> {{str_comp_add_subject}} </span> ',show_full_header:'{{quick_reply_card_actions}} <div class="field account-select hidden"> <label for="from-field" class="compose-label">{{str_msg_hdr_label_from_fresh}}</label> <div class="custom-select from-selector"> <select id="from-field" class="cm-from-field from-select"> {{compose_from_address}} </select> </div> </div> {{quickCompose}} <div id="to-group" role="group" class="field contact-search cm-to-group"> <a class="compose-label label-to-field choose-contact" tabindex="-1" id="to_add_contacts" title="{{str_comp_btn_to_add_attr}}">{{str_comp_label_to_fresh}}</a> <div class="address-btns"> <span id="btn-show-cc-in-to" class="cm-btn-show-cc cc-btn small" tabindex="-1"><a role="button" href="cc-group&amp;btn-show-cc=0" id="cc_show_btn_in_to" tabindex="-1" data-action="toggle-visibility">{{str_comp_btn_show_cc_bcc}}</a></span> {{make_reply_all}} </div> <div id="to" class="cm-to ac-input" data-action="autocomplete" tabindex="-1"> <ul role="presentation"> {{conversation_user}} <li role="presentation" class="recipient-input"> <input role="textbox" aria-autocomplete="list" aria-expanded="false" aria-label="{{str_to_cap}}" id="to-field" name="to-field" class="cm-to-field" value=""> </li> </ul> <span class="hidden compose-hide-recpts" data-action="hide-recpts" title="{{str_thread_hdr_hide_recipients_attr}}" aria-label="{{str_thread_hdr_hide_recipients_attr}}">{{str_hdr_hide_recipients}}</span> </div> </div> <div id="cc-group" class="cm-cc-group field contact-search hidden"> <a class="compose-label label-cc-field choose-contact" id="cc_add_contacts" title="{{str_comp_btn_to_add_attr}}" tabindex="-1">{{str_comp_label_cc_fresh}}</a> <div class="address-btns"> <span class="cc-btn small"><a role="button" href="cc-group&amp;btn-show-cc=1" id="cc_hide_btn" tabindex="-1" data-action="toggle-visibility">{{str_comp_btn_hide_cc_bcc}}</a></span> <span id="btn-show-bcc-in-cc" tabindex="-1" class="cm-btn-show-bcc bcc-btn small btn-bcc-in-cc"><a role="button" href="bcc-group&amp;btn-show-bcc=0" id="bcc_show_btn_in_cc" tabindex="-1" data-action="toggle-visibility">{{str_comp_btn_show_bcc_fresh}}</a></span> </div> <div id="cc" class="cm-cc ac-input" data-action="autocomplete" tabindex="-1"> <ul role="presentation"> <li role="presentation" class="recipient-input"> <input role="textbox" aria-autocomplete="list" aria-expanded="false" id="cc-field" name="cc-field" class="cm-cc-field" aria-label="{{str_cc}}"> </li> </ul> <span class="hidden compose-hide-recpts" data-action="hide-recpts" title="{{str_thread_hdr_hide_recipients_attr}}" aria-label="{{str_thread_hdr_hide_recipients_attr}}">{{str_hdr_hide_recipients}}</span> </div> </div> <div id="bcc-group" class="cm-bcc-group field contact-search hidden"> <a class="compose-label label-bcc-field choose-contact" tabindex="-1" id="bcc_add_contacts" title="{{str_comp_btn_to_add_attr}}">{{str_comp_label_bcc_fresh}}</a> <div id="bcc" class="cm-bcc ac-input" data-action="autocomplete" tabindex="-1"> <ul role="presentation"> <li role="presentation" class="recipient-input"> <input role="textbox" aria-autocomplete="list" aria-expanded="false" id="bcc-field" name="bcc-field" class="cm-bcc-field" aria-label="{{str_bcc}}"> </li> </ul> <span class="hidden compose-hide-recpts" data-action="hide-recpts" title="{{str_thread_hdr_hide_recipients_attr}}" aria-label="{{str_thread_hdr_hide_recipients_attr}}">{{str_hdr_hide_recipients}}</span> </div> </div> <div class="field subject {{subject_hidden}}"> <div id="subject" class="cm-subject"> <label> <span> <input id="subject-field" name="subject-field{{timestamp_id}}" class="cm-subject-field" data-action="compose-subject" value="{{conversation_user1}}" placeholder="{{str_comp_add_subject}}"/> </span> {{less_than_IE10}} </label> </div> </div> ',more_recipients_str:'<li class="hLozenge"> <span class="more_recp lozenge-static cl {{show_hovercard}} more" data-address="{{data_address}}" data-action="compose-recpt-more" role="button" tabindex="0" aria-label="{{str_thread_hdr_more_recipients_attr}}"> {{str_hdr_more_recipients}}</span> </li> '}},"1.0.0",{requires:["_shared_module_compose_quick_reply_card_actions"]});
YUI.add("comms-ui-lozenge",function(e){function l(t){var n=this;e.use("contacts-ui-contact-popup",function(e){var r=n.getNode(),i=r.ancestor("ul"),s=n.data;s.copyable=n.copy,s.editable=n.edit,s.isContext=!0,s.stateChangeCB=function(t){e.Node.getDOMNode(r)&&(t.state==="show"?r.addClass("focus"):r.removeClass("lozenge-open-menu").removeClass("focus"))},i&&i.all("li").removeClass("focus"),e.mail.ContactPopup.showContactMenu(e.mail.ContactPopup.TYPE_INTERMEDIATE,n.rootNode,s,n.error),r.menu&&r.menu.isVisible()&&t.stopPropagation()}),t.preventDefault()}function c(t){var n=function(t){t.addClass("focus"),e.fire("lozenge:highlight")},r=e.UA.os==="macintosh"?t.metaKey:t.ctrlKey,i=-2,s=-1,u=-1,a,f=-1,l,c,h=!0,p,d;if(r||t.shiftKey){p=this.rootNode.ancestor(".ac-input"),p&&this.rootNode.ancestor(".compose-header").all(".ac-input").each(function(e){e!==p&&e.all(".hLozenge").removeClass("focus")});if(r)this.rootNode.hasClass("focus")?this.rootNode.removeClass("focus"):n(this.rootNode);else if(p){var v=p.all(".hLozenge");v.each(function(e){e.hasClass("focus")&&(a=v.indexOf(e),f===a-1&&h?h=!0:f>=0?h=!1:h=!0,s<a&&(s=a),i<0&&(i=a),f=a)}),u=v.indexOf(this.rootNode),i===s||u<i||u>s?u<i?h?(l=u,c=s):(l=u,c=i):u>s&&(h?(l=i,c=u):(l=s,c=u)):(l=i,c=u),v.removeClass("focus");if(l<0||c<0)n(this.rootNode);else for(a=l;a<=c;a++)n(v.item(a))}}else d=this.rootNode.ancestor(".compose-header"),o===!0?d&&(d=d.all(".hLozenge.focus"),d.size()===1&&this.rootNode.hasClass("focus")?(t.halt(),this.rootNode.removeClass("focus"),this.startEdit()):(d.removeClass("focus"),n(this.rootNode))):(d&&(d=d.all(".hLozenge.focus"),d.removeClass("focus")),n(this.rootNode))}function h(){var e=this,t=e.getFullDisplayData();e.staticL.setContent(r(t)),e.editL.removeClass("mask"),e.staticL.addClass("mask"),e.editL.focus(),e.editL.setAttribute("value",t)}function p(t){var n=this,i,s,o,u,a=t.keyCode;a===13?(i=n.rootNode.ancestor("div"),i&&(s=i.get("scrollTop"),o=i.all("li"),u=o.item(o.size()-1).one("input"),u.focus(),e.later(50,n,function(){i.set("scrollTop",s),u.addClass("whiteout")}))):(n.staticL.setContent(r(n.editL.get("value"))),n.staticL.setAttribute("title",n.getFullDisplayData()))}function d(){var e=this,t=s(e.editL.get("value"));if(!t){e.remove();return}e.data=e.createUserDataFromString(t),e.validate(),e.setState(),e.setLabel(),e.staticL.setAttribute("title",e.getFullDisplayData()),e.staticL.setAttribute("data-address",e.data.email),e.staticL.removeClass("mask"),e.editL.addClass("mask")}function v(){return this.rootNode}function m(){var e=this;if(e.valFn){if(!e.valFn.call(e,e.data))return e.data.fail=!0,e.error=!0,!1}else if(!i.isValidEmail(e.data.email))return e.data.fail=!0,e.error=!0,!1;return e.data.fail=!1,e.error=!1,!0}function g(){var e=this.data,t;t=e.name||e.email,this.staticL.setContent(r(t))}function y(){this.error?this.staticL.addClass("lozenge-error"):this.staticL.removeClass("lozenge-error")}function b(e){var t=!1,n=null,r=null,o=/(<[^<>]+[^<>]+\.[^<>]+>)|(\([^\(\)]+@[^\(\)]+\.[^\(\)]+\))|(\[[^\[\]]+@[^\[\]]+\.[^\[\]]+\])/,u,a;return e=s(e),a=e.replace(/\".*\"/g,""),!s(a)||a.indexOf("@")<0?(t=!0,r=n=e):(o.test(e)?(u=e.match(o),r=u[0],n=s(e.replace(r,"")),r=r.substring(1,r.length-1)):r=n=e,i.isValidEmail(r)?(this.error=!1,t=!1):(this.error=!0,t=!0)),{fail:t,email:r,name:n}}function w(){var e=this.data,t=e.name||"",n=e.email;return this.error?n:(t=t===n?"":t+" ",t+"<"+n+">")}function E(){var t=this;e.later(0,t,function(){t.rootNode.remove().destroy(!0),e.fire("lozenge:remove")})}var t=e.common.Utils,n=t.substitute,r=t.escapeHtml,i=e.comms.Utils,s=e.Lang.trim,o=t.features.enabled("lozengeContactCard"),u=o===!0?"hcard":"",a={base:'<li class="hLozenge {{parentClass}}" data-action="{{action}}"><span role="button" class="lozenge-static '+u+' cl {{errorClass}} {{dataClass}}" title="{{hover}}" data-address="{{hover}}" >{{label}}</span>{{editable}}</li>',edit:'<input class="lozenge-edit mask" type="text" value="{{fullDisplayData}}">'},f;e.on("click",function(t){if(!t.altKey&&!t.shiftKey&&!t.ctrlKey&&!t.metaKey){var n=e.all(".hLozenge");n.each(function(e){e!==t.target&&e!==t.target.get("parentNode")&&e.hasClass("focus")&&e.removeClass("focus")})}}),f=function(t){var i=this,s,u,f,l;i.label=t.label||"",i.hover=t.hover||"",i.valFn=t.valFn||null,i.error=t.error||!1,i.menu=t.menu||null,i.edit=t.edit||!1,i.copy=t.copy||!1,i.bidi=t.bidi||!1,i.action=t.action||"",i.dataClass=t.dataClass||"",i.parentClass=t.parentClass||"",NeoConfig&&(i.bidi=!!NeoConfig.bidi),i.data=t.data||{name:"",email:"",cid:null},i.validate(),s=e.Node.create(n(a.base,null,null,null,{label:r(this.label),editable:i.edit?a.edit:"",errorClass:i.error?"lozenge-error":"",dataClass:i.dataClass,parentClass:i.parentClass,action:i.action})),u=i.staticL=s.one(".lozenge-static"),u.setAttribute("title",i.hover),t.state!=="error"&&u.setAttribute("data-address",i.hover),s.setData("lozenge",i),s.setData("user",i.data),i.bidi&&(l=e.Intl.detectDirection(i.label.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,">").replace(/&amp;/g,"&")),s.setAttribute("dir",l),s.addClass(l)),o!==!0&&e.on("contextmenu",i.popupMenu,u,i),i.edit&&(f=i.editL=s.one(".lozenge-edit"),f.setAttribute("value",i.getFullDisplayData()),e.on("click",i.highlight,u,i),e.on("dblclick",i.startEdit,u,i),e.on("keydown",i.typeEdit,f,i),e.on("blur",i.finishEdit,f,i),e.on("mousedown",function(t){t.preventDefault(),e.ACWidgetInst&&e.ACWidgetInst.hide(),e.fire("HoverCard:hideHoverCard")},u,i)),i.rootNode=s},f.prototype={popupMenu:l,highlight:c,startEdit:h,typeEdit:p,finishEdit:d,getNode:v,validate:m,setLabel:g,setState:y,getFullDisplayData:w,createUserDataFromString:b,remove:E},e.namespace("comms.ui"),e.comms.ui.Lozenge=f,e.comms.ui.LozengeUtils={makeContact:function(e,t){var r,i=[],s=[],o,u,a,f,l,c,h,p=e.all("span.lozenge");for(r in t){u=t[r].fields;for(var d=0,v=u.length;d<v;d++)o=u[d],o.type==="email"?i=i.concat(o.value):o.type==="name"&&(a=o.value,f=n(strings.str_name_format,{given_name:a.givenName,family_name:a.familyName
}),s=s.concat(f))}p.each(function(e){if(e.hasClass("lozengeadd")){c=e.getAttribute("data-address");for(l=0;l<i.length;l++)i[l]===c&&(e.remove(),h&&(h.addClass("right"),f=s[l],f&&h.one("a").setContent(f),h=null))}else h=e})}}},"0.0.1",{requires:["comms-ui-lozenge_css","common-utils","comms-utils","mail-common-utils-features","isXobnifiedCheck","node"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("classnamemanager",function(e,t){var n="classNamePrefix",r="classNameDelimiter",i=e.config;i[n]=i[n]||"yui3",i[r]=i[r]||"-",e.ClassNameManager=function(){var t=i[n],s=i[r];return{getClassName:e.cached(function(){var n=e.Array(arguments);return n[n.length-1]!==!0?n.unshift(t):n.pop(),n.join(s)})}}()},"3.16.0",{requires:["yui-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-base",function(e,t){function R(e){var t=this,n,r,i=t.constructor;t._strs={},t._cssPrefix=i.CSS_PREFIX||s(i.NAME.toLowerCase()),e=e||{},R.superclass.constructor.call(t,e),r=t.get(T),r&&(r!==P&&(n=r),t.render(n))}var n=e.Lang,r=e.Node,i=e.ClassNameManager,s=i.getClassName,o,u=e.cached(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),a="content",f="visible",l="hidden",c="disabled",h="focused",p="width",d="height",v="boundingBox",m="contentBox",g="parentNode",y="ownerDocument",b="auto",w="srcNode",E="body",S="tabIndex",x="id",T="render",N="rendered",C="destroyed",k="strings",L="<div></div>",A="Change",O="loading",M="_uiSet",_="",D=function(){},P=!0,H=!1,B,j={},F=[f,c,d,p,h,S],I=e.UA.webkit,q={};R.NAME="widget",B=R.UI_SRC="ui",R.ATTRS=j,j[x]={valueFn:"_guid",writeOnce:P},j[N]={value:H,readOnly:P},j[v]={valueFn:"_defaultBB",setter:"_setBB",writeOnce:P},j[m]={valueFn:"_defaultCB",setter:"_setCB",writeOnce:P},j[S]={value:null,validator:"_validTabIndex"},j[h]={value:H,readOnly:P},j[c]={value:H},j[f]={value:P},j[d]={value:_},j[p]={value:_},j[k]={value:{},setter:"_strSetter",getter:"_strGetter"},j[T]={value:H,writeOnce:P},R.CSS_PREFIX=s(R.NAME.toLowerCase()),R.getClassName=function(){return s.apply(i,[R.CSS_PREFIX].concat(e.Array(arguments),!0))},o=R.getClassName,R.getByNode=function(t){var n,i=o();return t=r.one(t),t&&(t=t.ancestor("."+i,!0),t&&(n=q[e.stamp(t,!0)])),n||null},e.extend(R,e.Base,{getClassName:function(){return s.apply(i,[this._cssPrefix].concat(e.Array(arguments),!0))},initializer:function(t){var n=this.get(v);n instanceof r&&this._mapInstance(e.stamp(n))},_mapInstance:function(e){q[e]=this},destructor:function(){var t=this.get(v),n;t instanceof r&&(n=e.stamp(t,!0),n in q&&delete q[n],this._destroyBox())},destroy:function(e){return this._destroyAllNodes=e,R.superclass.destroy.apply(this)},_destroyBox:function(){var e=this.get(v),t=this.get(m),n=this._destroyAllNodes,r;r=e&&e.compareTo(t),this.UI_EVENTS&&this._destroyUIEvents(),this._unbindUI(e),t&&(n&&t.empty(),t.remove(P)),r||(n&&e.empty(),e.remove(P))},render:function(e){return!this.get(C)&&!this.get(N)&&(this.publish(T,{queuable:H,fireOnce:P,defaultTargetOnly:P,defaultFn:this._defRenderFn}),this.fire(T,{parentNode:e?r.one(e):null})),this},_defRenderFn:function(e){this._parentNode=e.parentNode,this.renderer(),this._set(N,P),this._removeLoadingClassNames()},renderer:function(){var e=this;e._renderUI(),e.renderUI(),e._bindUI(),e.bindUI(),e._syncUI(),e.syncUI()},bindUI:D,renderUI:D,syncUI:D,hide:function(){return this.set(f,H)},show:function(){return this.set(f,P)},focus:function(){return this._set(h,P)},blur:function(){return this._set(h,H)},enable:function(){return this.set(c,H)},disable:function(){return this.set(c,P)},_uiSizeCB:function(e){this.get(m).toggleClass(o(a,"expanded"),e)},_renderBox:function(e){var t=this,n=t.get(m),i=t.get(v),s=t.get(w),o=t.DEF_PARENT_NODE,u=s&&s.get(y)||i.get(y)||n.get(y);s&&!s.compareTo(n)&&!n.inDoc(u)&&s.replace(n),!i.compareTo(n.get(g))&&!i.compareTo(n)&&(n.inDoc(u)&&n.replace(i),i.appendChild(n)),e=e||o&&r.one(o),e?e.appendChild(i):i.inDoc(u)||r.one(E).insert(i,0)},_setBB:function(e){return this._setBox(this.get(x),e,this.BOUNDING_TEMPLATE,!0)},_setCB:function(e){return this.CONTENT_TEMPLATE===null?this.get(v):this._setBox(null,e,this.CONTENT_TEMPLATE,!1)},_defaultBB:function(){var e=this.get(w),t=this.CONTENT_TEMPLATE===null;return e&&t?e:null},_defaultCB:function(e){return this.get(w)||null},_setBox:function(t,n,i,s){return n=r.one(n),n||(n=r.create(i),s?this._bbFromTemplate=!0:this._cbFromTemplate=!0),n.get(x)||n.set(x,t||e.guid()),n},_renderUI:function(){this._renderBoxClassNames(),this._renderBox(this._parentNode)},_renderBoxClassNames:function(){var e=this._getClasses(),t,n=this.get(v),r;n.addClass(o());for(r=e.length-3;r>=0;r--)t=e[r],n.addClass(t.CSS_PREFIX||s(t.NAME.toLowerCase()));this.get(m).addClass(this.getClassName(a))},_removeLoadingClassNames:function(){var e=this.get(v),t=this.get(m),n=this.getClassName(O),r=o(O);e.removeClass(r).removeClass(n),t.removeClass(r).removeClass(n)},_bindUI:function(){this._bindAttrUI(this._UI_ATTRS.BIND),this._bindDOM()},_unbindUI:function(e){this._unbindDOM(e)},_bindDOM:function(){var t=this.get(v).get(y),n=R._hDocFocus;n||(n=R._hDocFocus=t.on("focus",this._onDocFocus,this),n.listeners={count:0}),n.listeners[e.stamp(this,!0)]=!0,n.listeners.count++,I&&(this._hDocMouseDown=t.on("mousedown",this._onDocMouseDown,this))},_unbindDOM:function(t){var n=R._hDocFocus,r=e.stamp(this,!0),i,s=this._hDocMouseDown;n&&(i=n.listeners,i[r]&&(delete i[r],i.count--),i.count===0&&(n.detach(),R._hDocFocus=null)),I&&s&&s.detach()},_syncUI:function(){this._syncAttrUI(this._UI_ATTRS.SYNC)},_uiSetHeight:function(e){this._uiSetDim(d,e),this._uiSizeCB(e!==_&&e!==b)},_uiSetWidth:function(e){this._uiSetDim(p,e)},_uiSetDim:function(e,t){this.get(v).setStyle(e,n.isNumber(t)?t+this.DEF_UNIT:t)},_uiSetVisible:function(e){this.get(v).toggleClass(this.getClassName(l),!e)},_uiSetDisabled:function(e){this.get(v).toggleClass(this.getClassName(c),e)},_uiSetFocused:function(e,t){var n=this.get(v);n.toggleClass(this.getClassName(h),e),t!==B&&(e?n.focus():n.blur())},_uiSetTabIndex:function(e){var t=this.get(v);n.isNumber(e)?t.set(S,e):t.removeAttribute(S)},_onDocMouseDown:function(e){this._domFocus&&this._onDocFocus(e)},_onDocFocus:function(e){var t=R.getByNode(e.target),n=R._active;n&&n!==t&&(n._domFocus=!1,n._set(h,!1,{src:B}),R._active=null),t&&(t._domFocus=!0,t._set(h,!0,{src:B}),R._active=t)},toString:function(){return this.name+"["+this.get(x)+"]"},DEF_UNIT:"px",DEF_PARENT_NODE:null,CONTENT_TEMPLATE:L,BOUNDING_TEMPLATE:L,_guid:function(){return e.guid()},_validTabIndex:function(e){return n.isNumber(e)||n.isNull(e)},_bindAttrUI:function(e){var t,n=e.length;for(t=0;t<n;t++)this.after(e[t]+A,this._setAttrUI)},_syncAttrUI:function(e){var t,n=e.length,r;for(t=0;t<n;t++)r=e[t],this[M+u(r)](this.get(r))},_setAttrUI:function(e){e.target===this&&this[M+u(e.attrName
)](e.newVal,e.src)},_strSetter:function(t){return e.merge(this.get(k),t)},getString:function(e){return this.get(k)[e]},getStrings:function(){return this.get(k)},_UI_ATTRS:{BIND:F,SYNC:F}}),e.Widget=R},"3.16.0",{requires:["attribute","base-base","base-pluginhost","classnamemanager","event-focus","node-base","node-style"],skinnable:!0});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-htmlparser",function(e,t){var n=e.Widget,r=e.Node,i=e.Lang,s="srcNode",o="contentBox";n.HTML_PARSER={},n._buildCfg={aggregates:["HTML_PARSER"]},n.ATTRS[s]={value:null,setter:r.one,getter:"_getSrcNode",writeOnce:!0},e.mix(n.prototype,{_getSrcNode:function(e){return e||this.get(o)},_preAddAttrs:function(e,t,n){var r={id:e.id,boundingBox:e.boundingBox,contentBox:e.contentBox,srcNode:e.srcNode};this.addAttrs(r,t,n),delete e.boundingBox,delete e.contentBox,delete e.srcNode,delete e.id,this._applyParser&&this._applyParser(t)},_applyParsedConfig:function(t,n,r){return r?e.mix(n,r,!1):n},_applyParser:function(t){var n=this,r=this._getNodeToParse(),s=n._getHtmlParser(),o,u;s&&r&&e.Object.each(s,function(e,t,s){u=null,i.isFunction(e)?u=e.call(n,r):i.isArray(e)?(u=r.all(e[0]),u.isEmpty()&&(u=null)):u=r.one(e),u!==null&&u!==undefined&&(o=o||{},o[t]=u)}),t=n._applyParsedConfig(r,t,o)},_getNodeToParse:function(){var e=this.get("srcNode");return this._cbFromTemplate?null:e},_getHtmlParser:function(){var t=this._getClasses(),n={},r,i;for(r=t.length-1;r>=0;r--)i=t[r].HTML_PARSER,i&&e.mix(n,i,!0);return n}})},"3.16.0",{requires:["widget-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-skin",function(e,t){var n="boundingBox",r="contentBox",i="skin",s=e.ClassNameManager.getClassName;e.Widget.prototype.getSkinName=function(e){var t=this.get(r)||this.get(n),o,u;return e=e||s(i,""),u=new RegExp("\\b"+e+"(\\S+)"),t&&t.ancestor(function(e){return o=e.get("className").match(u),o}),o?o[1]:null}},"3.16.0",{requires:["widget-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-uievents",function(e,t){var n="boundingBox",r=e.Widget,i="render",s=e.Lang,o=":",u=e.Widget._uievts=e.Widget._uievts||{};e.mix(r.prototype,{_destroyUIEvents:function(){var t=e.stamp(this,!0);e.each(u,function(n,r){n.instances[t]&&(delete n.instances[t],e.Object.isEmpty(n.instances)&&(n.handle.detach(),u[r]&&delete u[r]))})},UI_EVENTS:e.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(n)},_createUIEvent:function(t){var n=this._getUIEventNode(),i=e.stamp(n)+t,s=u[i],o;s||(o=n.delegate(t,function(e){var t=r.getByNode(this);t&&t._filterUIEvent(e)&&t.fire(e.type,{domEvent:e})},"."+e.Widget.getClassName()),u[i]=s={instances:{},handle:o}),s.instances[e.stamp(this)]=1},_filterUIEvent:function(e){return e.currentTarget.compareTo(e.container)||e.container.compareTo(this._getUIEventNode())},_getUIEvent:function(e){if(s.isString(e)){var t=this.parseType(e)[1],n,r;return t&&(n=t.indexOf(o),n>-1&&(t=t.substring(n+o.length)),this.UI_EVENTS[t]&&(r=t)),r}},_initUIEvent:function(e){var t=this._getUIEvent(e),n=this._uiEvtsInitQueue||{};t&&!n[t]&&(this._uiEvtsInitQueue=n[t]=1,this.after(i,function(){this._createUIEvent(t),delete this._uiEvtsInitQueue[t]}))},on:function(e){return this._initUIEvent(e),r.superclass.on.apply(this,arguments)},publish:function(e,t){var n=this._getUIEvent(e);return n&&t&&t.defaultFn&&this._initUIEvent(n),r.superclass.publish.apply(this,arguments)}},!0)},"3.16.0",{requires:["node-event-delegate","widget-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stdmod",function(e,t){function H(e){}var n=e.Lang,r=e.Node,i=e.UA,s=e.Widget,o="",u="hd",a="bd",f="ft",l="header",c="body",h="footer",p="fillHeight",d="stdmod",v="Node",m="Content",g="firstChild",y="childNodes",b="ownerDocument",w="contentBox",E="height",S="offsetHeight",x="auto",T="headerContentChange",N="bodyContentChange",C="footerContentChange",k="fillHeightChange",L="heightChange",A="contentUpdate",O="renderUI",M="bindUI",_="syncUI",D="_applyParsedConfig",P=e.Widget.UI_SRC;H.HEADER=l,H.BODY=c,H.FOOTER=h,H.AFTER="after",H.BEFORE="before",H.REPLACE="replace";var B=H.HEADER,j=H.BODY,F=H.FOOTER,I=B+m,q=F+m,R=j+m;H.ATTRS={headerContent:{value:null},footerContent:{value:null},bodyContent:{value:null},fillHeight:{value:H.BODY,validator:function(e){return this._validateFillHeight(e)}}},H.HTML_PARSER={headerContent:function(e){return this._parseStdModHTML(B)},bodyContent:function(e){return this._parseStdModHTML(j)},footerContent:function(e){return this._parseStdModHTML(F)}},H.SECTION_CLASS_NAMES={header:s.getClassName(u),body:s.getClassName(a),footer:s.getClassName(f)},H.TEMPLATES={header:'<div class="'+H.SECTION_CLASS_NAMES[B]+'"></div>',body:'<div class="'+H.SECTION_CLASS_NAMES[j]+'"></div>',footer:'<div class="'+H.SECTION_CLASS_NAMES[F]+'"></div>'},H.prototype={initializer:function(){this._stdModNode=this.get(w),e.before(this._renderUIStdMod,this,O),e.before(this._bindUIStdMod,this,M),e.before(this._syncUIStdMod,this,_)},_syncUIStdMod:function(){var e=this._stdModParsed;(!e||!e[I])&&this._uiSetStdMod(B,this.get(I)),(!e||!e[R])&&this._uiSetStdMod(j,this.get(R)),(!e||!e[q])&&this._uiSetStdMod(F,this.get(q)),this._uiSetFillHeight(this.get(p))},_renderUIStdMod:function(){this._stdModNode.addClass(s.getClassName(d)),this._renderStdModSections(),this.after(T,this._afterHeaderChange),this.after(N,this._afterBodyChange),this.after(C,this._afterFooterChange)},_renderStdModSections:function(){n.isValue(this.get(I))&&this._renderStdMod(B),n.isValue(this.get(R))&&this._renderStdMod(j),n.isValue(this.get(q))&&this._renderStdMod(F)},_bindUIStdMod:function(){this.after(k,this._afterFillHeightChange),this.after(L,this._fillHeight),this.after(A,this._fillHeight)},_afterHeaderChange:function(e){e.src!==P&&this._uiSetStdMod(B,e.newVal,e.stdModPosition)},_afterBodyChange:function(e){e.src!==P&&this._uiSetStdMod(j,e.newVal,e.stdModPosition)},_afterFooterChange:function(e){e.src!==P&&this._uiSetStdMod(F,e.newVal,e.stdModPosition)},_afterFillHeightChange:function(e){this._uiSetFillHeight(e.newVal)},_validateFillHeight:function(e){return!e||e==H.BODY||e==H.HEADER||e==H.FOOTER},_uiSetFillHeight:function(e){var t=this.getStdModNode(e),n=this._currFillNode;n&&t!==n&&n.setStyle(E,o),t&&(this._currFillNode=t),this._fillHeight()},_fillHeight:function(){if(this.get(p)){var e=this.get(E);e!=o&&e!=x&&this.fillHeight(this.getStdModNode(this.get(p)))}},_uiSetStdMod:function(e,t,r){if(n.isValue(t)){var i=this.getStdModNode(e,!0);this._addStdModContent(i,t,r),this.set(e+m,this._getStdModContent(e),{src:P})}else this._eraseStdMod(e);this.fire(A)},_renderStdMod:function(e){var t=this.get(w),n=this._findStdModSection(e);return n||(n=this._getStdModTemplate(e)),this._insertStdModSection(t,e,n),this[e+v]=n,this[e+v]},_eraseStdMod:function(e){var t=this.getStdModNode(e);t&&(t.remove(!0),delete this[e+v])},_insertStdModSection:function(e,t,n){var r=e.get(g);if(t===F||!r)e.appendChild(n);else if(t===B)e.insertBefore(n,r);else{var i=this[F+v];i?e.insertBefore(n,i):e.appendChild(n)}},_getStdModTemplate:function(e){return r.create(H.TEMPLATES[e],this._stdModNode.get(b))},_addStdModContent:function(e,t,n){switch(n){case H.BEFORE:n=0;break;case H.AFTER:n=undefined;break;default:n=H.REPLACE}e.insert(t,n)},_getPreciseHeight:function(e){var t=e?e.get(S):0,n="getBoundingClientRect";if(e&&e.hasMethod(n)){var r=e.invoke(n);r&&(t=r.bottom-r.top)}return t},_findStdModSection:function(e){return this.get(w).one("> ."+H.SECTION_CLASS_NAMES[e])},_parseStdModHTML:function(t){var n=this._findStdModSection(t);return n?(this._stdModParsed||(this._stdModParsed={},e.before(this._applyStdModParsedConfig,this,D)),this._stdModParsed[t+m]=1,n.get("innerHTML")):null},_applyStdModParsedConfig:function(e,t,n){var r=this._stdModParsed;r&&(r[I]=!(I in t)&&I in r,r[R]=!(R in t)&&R in r,r[q]=!(q in t)&&q in r)},_getStdModContent:function(e){return this[e+v]?this[e+v].get(y):null},setStdModContent:function(e,t,n){this.set(e+m,t,{stdModPosition:n})},getStdModNode:function(e,t){var n=this[e+v]||null;return!n&&t&&(n=this._renderStdMod(e)),n},fillHeight:function(e){if(e){var t=this.get(w),r=[this.headerNode,this.bodyNode,this.footerNode],s,o,u=0,a=0,f=!1;for(var l=0,c=r.length;l<c;l++)s=r[l],s&&(s!==e?u+=this._getPreciseHeight(s):f=!0);f&&((i.ie||i.opera)&&e.set(S,0),o=t.get(S)-parseInt(t.getComputedStyle("paddingTop"),10)-parseInt(t.getComputedStyle("paddingBottom"),10)-parseInt(t.getComputedStyle("borderBottomWidth"),10)-parseInt(t.getComputedStyle("borderTopWidth"),10),n.isNumber(o)&&(a=o-u,a>=0&&e.set(S,a)))}}},e.WidgetStdMod=H},"3.16.0",{requires:["base-build","widget"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position",function(e,t){function d(e){}var n=e.Lang,r=e.Widget,i="xy",s="position",o="positioned",u="boundingBox",a="relative",f="renderUI",l="bindUI",c="syncUI",h=r.UI_SRC,p="xyChange";d.ATTRS={x:{setter:function(e){this._setX(e)},getter:function(){return this._getX()},lazyAdd:!1},y:{setter:function(e){this._setY(e)},getter:function(){return this._getY()},lazyAdd:!1},xy:{value:[0,0],validator:function(e){return this._validateXY(e)}}},d.POSITIONED_CLASS_NAME=r.getClassName(o),d.prototype={initializer:function(){this._posNode=this.get(u),e.after(this._renderUIPosition,this,f),e.after(this._syncUIPosition,this,c),e.after(this._bindUIPosition,this,l)},_renderUIPosition:function(){this._posNode.addClass(d.POSITIONED_CLASS_NAME)},_syncUIPosition:function(){var e=this._posNode;e.getStyle(s)===a&&this.syncXY(),this._uiSetXY(this.get(i))},_bindUIPosition:function(){this.after(p,this._afterXYChange)},move:function(){var e=arguments,t=n.isArray(e[0])?e[0]:[e[0],e[1]];this.set(i,t)},syncXY:function(){this.set(i,this._posNode.getXY(),{src:h})},_validateXY:function(e){return n.isArray(e)&&n.isNumber(e[0])&&n.isNumber(e[1])},_setX:function(e){this.set(i,[e,this.get(i)[1]])},_setY:function(e){this.set(i,[this.get(i)[0],e])},_getX:function(){return this.get(i)[0]},_getY:function(){return this.get(i)[1]},_afterXYChange:function(e){e.src!=h&&this._uiSetXY(e.newVal)},_uiSetXY:function(e){this._posNode.setXY(e)}},e.WidgetPosition=d},"3.16.0",{requires:["base-build","node-screen","widget"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-align",function(e,t){function c(e){}var n=e.Lang,r="align",i="alignOn",s="visible",o="boundingBox",u="offsetWidth",a="offsetHeight",f="region",l="viewportRegion";c.ATTRS={align:{value:null},centered:{setter:"_setAlignCenter",lazyAdd:!1,value:!1},alignOn:{value:[],validator:e.Lang.isArray}},c.TL="tl",c.TR="tr",c.BL="bl",c.BR="br",c.TC="tc",c.RC="rc",c.BC="bc",c.LC="lc",c.CC="cc",c.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionAlign is added"),e.after(this._bindUIPosAlign,this,"bindUI"),e.after(this._syncUIPosAlign,this,"syncUI")},_posAlignUIHandles:null,destructor:function(){this._detachPosAlignUIHandles()},_bindUIPosAlign:function(){this.after("alignChange",this._afterAlignChange),this.after("alignOnChange",this._afterAlignOnChange),this.after("visibleChange",this._syncUIPosAlign)},_syncUIPosAlign:function(){var e=this.get(r);this._uiSetVisiblePosAlign(this.get(s)),e&&this._uiSetAlign(e.node,e.points)},align:function(e,t){return arguments.length?this.set(r,{node:e,points:t}):this._syncUIPosAlign(),this},centered:function(e){return this.align(e,[c.CC,c.CC])},_setAlignCenter:function(e){return e&&this.set(r,{node:e===!0?null:e,points:[c.CC,c.CC]}),e},_uiSetAlign:function(t,r){if(!n.isArray(r)||r.length!==2){e.error("align: Invalid Points Arguments");return}var i=this._getRegion(t),s,o,u;if(!i)return;s=r[0],o=r[1];switch(o){case c.TL:u=[i.left,i.top];break;case c.TR:u=[i.right,i.top];break;case c.BL:u=[i.left,i.bottom];break;case c.BR:u=[i.right,i.bottom];break;case c.TC:u=[i.left+Math.floor(i.width/2),i.top];break;case c.BC:u=[i.left+Math.floor(i.width/2),i.bottom];break;case c.LC:u=[i.left,i.top+Math.floor(i.height/2)];break;case c.RC:u=[i.right,i.top+Math.floor(i.height/2)];break;case c.CC:u=[i.left+Math.floor(i.width/2),i.top+Math.floor(i.height/2)];break;default:}u&&this._doAlign(s,u[0],u[1])},_uiSetVisiblePosAlign:function(e){e?this._attachPosAlignUIHandles():this._detachPosAlignUIHandles()},_attachPosAlignUIHandles:function(){if(this._posAlignUIHandles)return;var t=this.get(o),n=e.bind(this._syncUIPosAlign,this),r=[];e.Array.each(this.get(i),function(i){var s=i.eventName,o=e.one(i.node)||t;s&&r.push(o.on(s,n))}),this._posAlignUIHandles=r},_detachPosAlignUIHandles:function(){var t=this._posAlignUIHandles;t&&((new e.EventHandle(t)).detach(),this._posAlignUIHandles=null)},_doAlign:function(e,t,n){var r=this._posNode,i;switch(e){case c.TL:i=[t,n];break;case c.TR:i=[t-r.get(u),n];break;case c.BL:i=[t,n-r.get(a)];break;case c.BR:i=[t-r.get(u),n-r.get(a)];break;case c.TC:i=[t-r.get(u)/2,n];break;case c.BC:i=[t-r.get(u)/2,n-r.get(a)];break;case c.LC:i=[t,n-r.get(a)/2];break;case c.RC:i=[t-r.get(u),n-r.get(a)/2];break;case c.CC:i=[t-r.get(u)/2,n-r.get(a)/2];break;default:}i&&this.move(i)},_getRegion:function(t){var n;return t?(t=e.Node.one(t),t&&(n=t.get(f))):n=this._posNode.get(l),n},_afterAlignChange:function(e){var t=e.newVal;t&&this._uiSetAlign(t.node,t.points)},_afterAlignOnChange:function(e){this._detachPosAlignUIHandles(),this.get(s)&&this._attachPosAlignUIHandles()}},e.WidgetPositionAlign=c},"3.16.0",{requires:["widget-position"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stack",function(e,t){function O(e){}var n=e.Lang,r=e.UA,i=e.Node,s=e.Widget,o="zIndex",u="shim",a="visible",f="boundingBox",l="renderUI",c="bindUI",h="syncUI",p="offsetWidth",d="offsetHeight",v="parentNode",m="firstChild",g="ownerDocument",y="width",b="height",w="px",E="shimdeferred",S="shimresize",x="visibleChange",T="widthChange",N="heightChange",C="shimChange",k="zIndexChange",L="contentUpdate",A="stacked";O.ATTRS={shim:{value:r.ie==6},zIndex:{value:0,setter:"_setZIndex"}},O.HTML_PARSER={zIndex:function(e){return this._parseZIndex(e)}},O.SHIM_CLASS_NAME=s.getClassName(u),O.STACKED_CLASS_NAME=s.getClassName(A),O.SHIM_TEMPLATE='<iframe class="'+O.SHIM_CLASS_NAME+'" frameborder="0" title="Widget Stacking Shim" src="javascript:false" tabindex="-1" role="presentation"></iframe>',O.prototype={initializer:function(){this._stackNode=this.get(f),this._stackHandles={},e.after(this._renderUIStack,this,l),e.after(this._syncUIStack,this,h),e.after(this._bindUIStack,this,c)},_syncUIStack:function(){this._uiSetShim(this.get(u)),this._uiSetZIndex(this.get(o))},_bindUIStack:function(){this.after(C,this._afterShimChange),this.after(k,this._afterZIndexChange)},_renderUIStack:function(){this._stackNode.addClass(O.STACKED_CLASS_NAME)},_parseZIndex:function(e){var t;return!e.inDoc()||e.getStyle("position")==="static"?t="auto":t=e.getComputedStyle("zIndex"),t==="auto"?null:t},_setZIndex:function(e){return n.isString(e)&&(e=parseInt(e,10)),n.isNumber(e)||(e=0),e},_afterShimChange:function(e){this._uiSetShim(e.newVal)},_afterZIndexChange:function(e){this._uiSetZIndex(e.newVal)},_uiSetZIndex:function(e){this._stackNode.setStyle(o,e)},_uiSetShim:function(e){e?(this.get(a)?this._renderShim():this._renderShimDeferred(),r.ie==6&&this._addShimResizeHandlers()):this._destroyShim()},_renderShimDeferred:function(){this._stackHandles[E]=this._stackHandles[E]||[];var e=this._stackHandles[E],t=function(e){e.newVal&&this._renderShim()};e.push(this.on(x,t))},_addShimResizeHandlers:function(){this._stackHandles[S]=this._stackHandles[S]||[];var e=this.sizeShim,t=this._stackHandles[S];t.push(this.after(x,e)),t.push(this.after(T,e)),t.push(this.after(N,e)),t.push(this.after(L,e))},_detachStackHandles:function(e){var t=this._stackHandles[e],n;if(t&&t.length>0)while(n=t.pop())n.detach()},_renderShim:function(){var e=this._shimNode,t=this._stackNode;e||(e=this._shimNode=this._getShimTemplate(),t.insertBefore(e,t.get(m)),this._detachStackHandles(E),this.sizeShim())},_destroyShim:function(){this._shimNode&&(this._shimNode.get(v).removeChild(this._shimNode),this._shimNode=null,this._detachStackHandles(E),this._detachStackHandles(S))},sizeShim:function(){var e=this._shimNode,t=this._stackNode;e&&r.ie===6&&this.get(a)&&(e.setStyle(y,t.get(p)+w),e.setStyle(b,t.get(d)+w))},_getShimTemplate:function(){return i.create(O.SHIM_TEMPLATE,this._stackNode.get(g))}},e.WidgetStack=O},"3.16.0",{requires:["base-build","widget"],skinnable:!0});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-constrain",function(e,t){function m(e){}var n="constrain",r="constrain|xyChange",i="constrainChange",s="preventOverlap",o="align",u="",a="bindUI",f="xy",l="x",c="y",h=e.Node,p="viewportRegion",d="region",v;m.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}},v=m._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}},m.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added"),e.after(this._bindUIPosConstrained,this,a)},getConstrainedXY:function(e,t){t=t||this.get(n);var r=this._getRegion(t===!0?null:t),i=this._posNode.get(d);return[this._constrain(e[0],l,i,r),this._constrain(e[1],c,i,r)]},constrain:function(e,t){var r,i,s=t||this.get(n);s&&(r=e||this.get(f),i=this.getConstrainedXY(r,s),(i[0]!==r[0]||i[1]!==r[1])&&this.set(f,i,{constrained:!0}))},_setConstrain:function(e){return e===!0?e:h.one(e)},_constrain:function(e,t,n,r){if(r){this.get(s)&&(e=this._preventOverlap(e,t,n,r));var i=t==l,o=i?r.width:r.height,u=i?n.width:n.height,a=i?r.left:r.top,f=i?r.right-u:r.bottom-u;if(e<a||e>f)u<o?e<a?e=a:e>f&&(e=f):e=a}return e},_preventOverlap:function(e,t,n,r){var i=this.get(o),s=t===l,a,f,c,h,p,d;return i&&i.points&&v[t][i.points.join(u)]&&(f=this._getRegion(i.node),f&&(a=s?n.width:n.height,c=s?f.left:f.top,h=s?f.right:f.bottom,p=s?f.left-r.left:f.top-r.top,d=s?r.right-f.right:r.bottom-f.bottom),e>c?d<a&&p>a&&(e=c-a):p<a&&d>a&&(e=h)),e},_bindUIPosConstrained:function(){this.after(i,this._afterConstrainChange),this._enableConstraints(this.get(n))},_afterConstrainChange:function(e){this._enableConstraints(e.newVal)},_enableConstraints:function(e){e?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on(r,this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(e){e.constrained||(e.newVal=this.getConstrainedXY(e.newVal))},_getRegion:function(e){var t;return e?(e=h.one(e),e&&(t=e.get(d))):t=this._posNode.get(p),t}},e.WidgetPositionConstrain=m},"3.16.0",{requires:["widget-position"]});
/*
YUI 3.16.0 (build 3.16.0-ym16)
Copyright 2015 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("overlay",function(e,t){e.Overlay=e.Base.create("overlay",e.Widget,[e.WidgetStdMod,e.WidgetPosition,e.WidgetStack,e.WidgetPositionAlign,e.WidgetPositionConstrain])},"3.16.0",{requires:["widget","widget-stdmod","widget-position","widget-position-align","widget-stack","widget-position-constrain"],skinnable:!0});
YUI.add("comms-ui-autocomplete-plugin",function(C){var B="autocomplete",F=C.Lang,G=C.Array.each,L=C.Plugin,E=L.Base,I="ac",D=13;function J(O,Q){var N="down",P=C.stamp(this)+"|";if(C.UA.gecko>0&&C.UA.gecko<5){N="press";C.on(P+"key",O.raiseFlag,Q,"down",O);}C.on(P+"valueChange",H,Q,O);C.on(P+"key",O.next,Q,N+":40",O);C.on(P+"key",O.previous,Q,N+":38",O);C.on(P+"key",O.close,Q,"down:27",O);Q.on("keyup",function(R){if(R.keyCode===D){R.type="select";this.select.call(O,R);}},O,"select");}function H(O){var N=O.newVal;if(!N&&!(N===""&&this.get("minQueryLength")===0)){this._cachedValue=false;return this.close();}if(N===this._cachedValue||N.length<this.get("minQueryLength")){return false;}this._cachedValue=N;this.fire("ac:query",{value:O.newVal});return true;}function A(N){return function(){if(N){N.setAttribute(B,"on");}N=null;};}function K(N){var P=C.Node.getDOMNode(N),Q=P.getAttribute(B);if((Q&&Q!=="off")||Q===null||Q===undefined){var O=A(P);C.on("beforeunload",O,window);C.on("unload",O,window);}P.setAttribute(B,"off");}function M(){M.superclass.constructor.apply(this,arguments);}C.extend(M,E,{_defaultEventFn:null,initializer:function(){var N=this,O=N.get("host"),P=(!F.isNull(N._defaultEventFn)?N._defaultEventFn:{});J(N,O);G(["query","load","show","hide","next","previous","select"],function(Q){N.publish("ac:"+Q,{broadcast:1,bubbles:1,context:N,preventable:true,prefix:I,defaultFn:P[Q]||null});},N);K(O);},destructor:function(){var N=this;C.detach(C.stamp(N)+"|");N.detachAll();},open:function(){this.fire("ac:show");},next:function(N){if(this.conflictingKeyFlag&&C.UA.gecko){return;}N.preventDefault();this.fire("ac:next");},previous:function(N){if(this.conflictingKeyFlag&&C.UA.gecko){return;}N.preventDefault();this.fire("ac:previous");},raiseFlag:function(O,N){if((O.keyCode===55)||(O.keyCode===57)){N.conflictingKeyFlag=true;}else{N.conflictingKeyFlag=false;}},select:function(N){this.fire("ac:select",N);},hide:function(){},close:function(){this.fire("ac:hide");},reload:function(N){if(N){if(N.length<1){this.set("badResult",this.get("queryValue"));}this.fire("ac:load",{results:N,query:this.get("queryValue")});}}},{NAME:"ACPlugin",NS:I,ATTRS:{queryValue:{getter:function(){return this.get("host").get("value");},setter:function(N){this.get("host").set("value",N);this._cachedValue=N;return this._cachedValue;}},dataSource:{value:[]},minQueryLength:{value:0,validator:F.isNumber},queryTemplate:{value:encodeURIComponent,setter:function(N){return(F.isFunction(N)?N:function(O){return N.replace(/(^|[^\\])((\\{2})*)\{query\}/,"$1$2"+encodeURIComponent(O)).replace(/(^|[^\\])((\\{2})*)\\(\{query\})/,"$1$2$4");});}},alignNode:null,conflictingKeyFlag:false,badResult:{value:false,setter:function(N){return(C.Lang.isString(N))?N:false;}}}});C.namespace("comms.ui");C.comms.ui.AutoCompleteEventsPlugin=M;},"1.0.0",{requires:["node","plugin","event-valuechange","event-key"]});YUI.add("comms-ui-autocomplete",function(C){var H=C.Array.each,F=C.Lang,B=C.Overlay,G="selectedIndex",A="queryValue",J="ac",D="_BOUND",I="_"+G,K="_originalValue";function E(){E.superclass.constructor.apply(this,arguments);this.delegated=false;this.listeners=[];}C.extend(E,B,{initializer:function(){var L=this;L.after({queryChanged:L.drawMarkUp,dataChanged:L.drawMarkUp});L.hide();L.publish(J+":complete",{broadcast:1,bubbles:1,context:L,preventable:true,prefix:J});},renderUI:function(){var M=this.get("ac"),L={"display":"none","overflow":"auto","maxHeight":"300px"};if(!M){return false;}this.get("contentBox").setStyles(L);this.get("contentBox").set("role","listbox");this.setSize();this.set("align",{node:this.get("ac").get("alignNode"),points:[C.WidgetPositionAlign.TL,C.WidgetPositionAlign.BL]});this.get("contentBox").setStyle("display","block");return true;},bind:function(P){var Q=this,L=Q.get("contentBox"),O=Q.get("ac"),N=C.stamp(Q)+"|";if(P&&O!==P&&Q[D]){C.detach(N);Q[D]=0;}P=P||O;if(P&&!Q[D]){var M=[];Q[D]=1;if(!Q.delegated){Q.delegated=true;M.push(L.delegate("click",Q.click,"li",Q));M.push(L.delegate("mouseover",Q.mouseover,"li",Q));M.push(L.delegate("mouseout",Q.mouseout,"li",Q));M.push(L.delegate("mousemove",function(R){R.halt();R.currentTarget.addClass("over");},"li",Q));M.push(L.delegate("mouseleave",function(R){R.halt();R.currentTarget.removeClass("over");},"li",Q));M.push(C.on("click",function(R){if(!Q.isVisible()){return;}if(Q.get("contentBox").contains(R.target)){if(R.target.get("nodeName").toLowerCase()!=="li"){return;}Q.get("ac").get("host").simulate("keydown",{keyCode:13});}if(Q.get("ac").get("host").contains(R.target)){return;}Q.hide();},document,this));}M.push(P.on(N+J+":load",function(R){if(!Q.get("disabled")){Q.setAttrs({query:R.query,data:R.results}).drawMarkUp().show().setAlign();}}));M.push(P.on(N+J+":query",function(R){Q.set("query",R.value).drawMarkUp();}));M.push(P.on(N+J+":next",Q.next,Q));M.push(P.on(N+J+":previous",Q.previous,Q));M.push(P.on(N+J+":hide",Q.hide,Q));P.select=function(R){Q.selected.call(Q,R,"enter");};Q.listeners=M;}return Q;},bindUI:function(L){return this.bind(L);},setSize:function(){if(!this.get("expandWidthToContents")){this.set("width",this.get("ac").get("alignNode").get("offsetWidth"));}},setAlign:function(){var O=this,M=O.get("ac").get("alignNode"),L=M.get("region"),N=[L.left,L.bottom];O.set("xy",N);return O;},drawMarkUp:function(){var L=this,M=L.get("data");if(!M){return L;}L[I]=-1;L[K]="";L.get("contentBox").set("innerHTML",L.getListMarkup(M));if(M.length>0){if(L.get("selectFirst")){this.set(G,0);}L.get("contentBox").setStyle("display","block");}else{L.get("contentBox").setStyle("display","none");}return L;},getListMarkup:function(O){var N=this,L=N.get("listTpl"),M=[];H(O,function(P){M.push(N.getItemMarkup(P));});return L.replace(/\{list\}/g,M.join(""));},getItemMarkup:function(M){var L=this;if(!F.isString(M)){return false;}return L.get("itemTpl").replace(/\{hilite\}/g,M);},_fixView:function(O){var R=this,N=R.get(G),L=R.get("contentBox"),Q,M,P;if(N===-1){L.set("scrollTop",0);return true;}M=R.item(N);Q=L.get("scrollTop");M=R.item(N);P=M.get("offsetTop");M.addClass("key-select");if(O){if((P>Q)&&(R.itemsCount()!==(N+1))){return true;}L.set("scrollTop",P);document.body.scrollIntoView();return false;}else{if((P+M.get("clientHeight"))>(Q+L.get("clientHeight"))){L.set("scrollTop",L.get("scrollTop")+M.get("clientHeight"));if(C.UA.ie<=0){M.scrollIntoView();}document.body.scrollIntoView(false);}return true;}},next:function(){var L=this;if(L.get("selectFirst")&&L.itemsCount()===1){return false;}return(L.get("visible")?L.selectNext():L);},selectNext:function(){var L=this;L.set(G,this.get(G)+1);L._fixView(false);return L.get(G);},selectPrevious:function(){var L=this;L.set(G,this.get(G)-1);L._fixView(true);return L.get(G);},previous:function(){var L=this;if(L.itemsCount()===1){return false;}return L.get("visible")?L.selectPrevious():L;},isVisible:function(){return this.get("visible");},hasSelectedItem:function(){return this.get("selectedIndex")>-1;},item:function(L){return this.get("contentBox").all(this.get("itemSelector")).item(L);},itemsCount:function(){return this.get("contentBox").all(this.get("allItemsSelector")).size();},click:function(L){this.selected(L,"click");},mouseover:function(O){var M,L,N=this;M=O.currentTarget;L=N.get("contentBox").all("li").indexOf(M);N.set("selectedIndex",L);},mouseout:function(){this.set("selectedIndex",-1);},autoManageSelect:function(L){var M=this,N=M.get("ac");if(!L){L=false;}if(L){N.on(J+":select",M.handleEnter,M);}else{N.detachAll(J+":select");}},handleEnter:function(P,M){if(!M){M=this;}var O=M.get("ac"),L=M[I],N,Q;P.halt();M.fire(J+":complete",M);if(L!==-1){N=M.item(L);if(N){Q=N.get("text");O.set(A,Q);}M[I]=-1;O.get("host").focus();M.hide();}},selected:function(R,P){var M=null,N=this,Q=N.get("ac"),L,O;if(!P){P="click";}M=N.item(this.get(G));if(!M){return false;}O=M.getData("selectedCb");if(O){O.call(M,R);return;}L=this.get(G);R.selectedItem=M;R.selectedIndex=L;R.type=P;R.container=N.get("contentBox");Q.fire("ac:select",R);N[I]=-1;return true;},setHostValue:function(M){var L=this;L.get("ac").set(A,M);L.get("ac").get("host").focus();L.hide();},reload:function(L){return this.get("ac").reload(L);},close:function(){var L=this;L.get("ac").close();L.hide();},destroy:function(){var M=this.listeners;if(M){var N=M.length,L;for(L=0;L<N;L++){if(M[L]){M[L].detach();M[L]=null;}}this.listeners=null;}if(this.get("ac")){this.get("ac").destructor();}E.superclass.destroy.apply(this,arguments);}},{NAME:"AutoCompleteWidget",ATTRS:{ac:{setter:function(L){if(!this[D]){return;}this.bind(L);},validator:function(){return true;}},data:{},query:{value:""},listTpl:{value:'<ul role="presentation">{list}</ul>'},itemTpl:{value:'<li role="option">{hilite}</li>'},itemSelector:{value:"ul li"},allItemsSelector:{value:"ul li"},selectedItem:{getter:function(){return this.item(this.get(G));},readOnly:true},expandWidthToContents:{value:false},selectFirst:{value:true}}});
E.ATTRS[G]={value:-1,validator:function(L){var M=this.get("data");return M&&C.Lang.isNumber(L);},getter:function(){return this[I];},setter:function(O){var T=this,Q=T.get(G),R=T.get("data"),L=T.itemsCount(),S=T.get("ac"),M=this.getClassName("selected"),P,N;if(isNaN(Q)){Q=-1;}if(!R||!L){return false;}while(O<-1){O+=L+1;}O=(O+1)%(L+1)-1;Q=(Q+1)%(L+1)-1;T[I]=O;if(Q===-1){T[K]=S.get(A);}if(Q===O){return false;}var U=T.get("contentBox").one("."+M);if(U){U.removeClass(M).removeClass("key-select");}if(O===-1){}else{P=T.item(O);if(P&&P.hasClass("corpmail.label")){N=O+(Q<O?1:-1);T[I]=N;P=T.item(N);}if(P){P.addClass(M);}}return O;}};C.namespace("comms.ui");C.comms.ui.AutoComplete=E;},"1.0.0",{requires:["overlay","comms-ui-autocomplete-plugin","node-event-simulate"]});YUI.add("contacts-api-config",function(e){"use strict";e.namespace("contacts");var t=e.contacts,n={1:"asc",2:"desc"},r={1:"first",3:"last",6:"email"},i;i=function(){var t=this,i=function(e){return!!e},s={baseHost:{validator:i},uri:{},headers:{},wssid:{},guid:{},requestFn:{},wspath:{value:"/ws/sd",validator:i},start:{},count:{value:"max",validator:i},sortfields:{},out:{value:"name,email,nickname,yahooid,phone,otherid,guid"},prefs:{value:null},sort:{},fields:{},view:{value:["compact"]},rev:{value:0,validator:i},reloadOnUpdate:{value:!0},fieldsToProcess:{value:["name","nickname","email","yahooid"],validator:function(t){return e.Lang.isArray(t)}}};t.addAttrs(s),t.setSortField=function(e){return t.set("sortfields",r[e]),t.get("sortfields")},t.setSortOrder=function(e){return t.set("sort",n[e]),t.get("sort")}},e.augment(i,e.Attribute),t.config=new i;if(t.clientConfig)t.config.setAttrs(t.clientConfig);else if(NeoConfig){var s={guid:NeoConfig.neoguid,wssid:NeoConfig.wssid,wspath:NeoConfig.socdirProxyPath,sortfields:"first",sort:"asc"};e.Object.getValue(e,["common","net","SessionMgr"])&&(s.requestFn=e.common.net.SessionMgr.requestProxy),t.config.setAttrs(s)}},"1.0.0",{requires:["attribute"]});
YUI.add("contacts-api-cache",function(e){"use strict";e.namespace("contacts");var t=e.contacts,n=e.contacts.config,r,i=e.Lang,s={CONTACT_CHANGED:"contacts:api:contactChanged",CONTACTS_LOADED:"contacts:api:loaded",CONTACT_IMAGE_UPDATED:"contacts:api:imageUpdated"};t.EVENTS=s,r=function(){var t=this,r=!1,o=0,u,a={},f={},l={},c={},h=[],p=null,d,v,m,g,y;d=function(e,t){var n,r;t||(c={});for(n in e)e.hasOwnProperty(n)&&(r=e[n],c[r.id]=c[r.id]||r,t&&(c[r.id].contacts=c[r.id].contacts||[],c[r.id].contacts.push(t.id)))},y=function(t,n){var r=t.fields,i,s,o,u,f,l=a[t.id]={typedFields:{},typedFieldValues:{}};if(!r)return;n=n||[],i=n.length>0;for(f in r)if(r.hasOwnProperty(f)){s=r[f],o=s.value,u=s.type;if(i&&e.Array.indexOf(n,u)===-1)continue;l.typedFields[u]||(l.typedFields[u]=[]),l.typedFieldValues[u]||(l.typedFieldValues[u]=[]),u==="name"&&o&&(o.familyName&&o.familyName.indexOf("<")!==-1&&(o.familyName=""),o.givenName&&o.givenName.indexOf("<")!==-1&&(o.givenName="")),l.typedFields[u].push(s),l.typedFieldValues[u].push(o)}},t.loadSortPrefs=function(e,t){p||(p={}),p.sort_order=e,p.sort_field=t},t.setSortPrefs=function(n,r){t.loadSortPrefs(n,r),e.later(10,t,e.contacts.api.load,[1])},t.getSortPrefs=function(){return p},t.load=function(i){var o,p,m=n.get("fieldsToProcess"),g=[],b=i.contacts.contact||[];l={},h=[],f={},c={},a={};for(p=0;p<b.length;p++)o=b[p],g.push(o),y(o,m),h[p]=o.id,l[o.id]=o,v(o),d(o.categories,o);u=i,u.contacts.contact=g,u.contacts.count=u.contacts.total=g.length,r=!0,e.later(10,t,t.fire,[s.CONTACTS_LOADED])},t.removeFromCategories=function(t){var n=t.categories||[],r=n.length,i,s,o;for(i=0;i<r;i++)s=n[i].id,o=c[s].contacts,o&&o.splice(e.Array.indexOf(o,t.id),1)},t.update=function(r){var u,a,f,c,p=n.get("fieldsToProcess"),g=[],b=[],w=[],E=[],S=[],x=[],T=[],N,C;r.syncresult?(o=r.syncresult.rev,u=r.syncresult.diff.contacts,T=r.syncresult.results.contacts):i.isArray(r)?u=r:u=[r.contact];for(C=0;C<T.length;C+=1){a=T[C],c=a.op,f=l[a.id];switch(c){case"remove":x.push(f);break;case"add":E.push(a);break;case"update":S.push(a)}}for(C=0;C<u.length;C+=1){a=u[C],c=a.op||"add",f=l[a.id];switch(c){case"remove":f&&(m(f),h.splice(e.Array.indexOf(h,f.id),1),t.removeFromCategories(f),w.push(f));break;default:f?(m(f),b.push(a)):g.push(a),y(a,p),d(a.categories,a),l[a.id]=a,v(a)}}return N={created:g,modified:b,removed:w,createdCurrent:E,modifiedCurrent:S,removedCurrent:x},g.length||b.length?n.get("reloadOnUpdate")&&e.later(10,t,e.contacts.api.load,[1]):e.later(10,t,t.fire,[s.CONTACTS_LOADED]),e.later(10,t,t.fire,[s.CONTACT_CHANGED,N]),N},t.updateCategories=function(){var r={categories:c};n.get("reloadOnUpdate")&&e.later(10,t,e.contacts.api.load,[1]),e.later(10,t,t.fire,[s.CONTACT_CHANGED,r])},v=function(e){var t,n,r,i;t=a[e.id].typedFieldValues.email;if(!t||t.length===0)return;for(i in t)t.hasOwnProperty(i)&&(n=t[i],r=n.toLowerCase(),f[r]=f[r]||[],f[r].push(e))},m=function(e){var t,n,r,i,s,o;t=a[e.id].typedFieldValues.email||[],s=e.id;for(o in t)t.hasOwnProperty(o)&&(n=t[o],i=n.toLowerCase(),r=f[i],r&&r[s]&&(r[s]=undefined))},t.isLoaded=function(){return r},t.getResponseObject=function(){return u},t.getContactsData=function(){return a},t.getContacts=function(){return l},t.getEmails=function(){return f},t.getCategories=function(){return c},t.getContactOrder=function(){return h},t.getCurrentRevision=function(){return o},t.setCurrentRevision=function(e){o=e},t.loadTinyUserCard=function(r){var i=r.contacts.contact,o,u=n.get("fieldsToProcess"),a=[],f;for(f in i)i.hasOwnProperty(f)&&(o=i[f],y(o,u),l[o.id]=o,v(o),a.push(o));return e.later(10,t,t.fire,[s.CONTACT_IMAGE_UPDATED,a]),a},t.getContactsByBucket=function(e,t,n){var r,i=[],s,o=e+t,u,a=[];n?(s=c[n],s&&(i=s.contacts||[])):i=h||[];for(u=e;u<o;u++){r=i[u];if(!r)break;a.push(l[r])}return{contacts:a,total:i.length}},t.removeFlatContact=function(e,t){var n=a[e].flatContacts,r,i=n.length,s;for(r=0;r<i;r++){s=n[r];if(s.emailField&&s.emailField.id===t){n.splice(r,1);break}}},t.removeField=function(e,n){var r=l[e];if(r){var i=r.fields,s,o=i.length,u;for(s=0;s<o;s++){u=i[s];if(u.id===n){i.splice(s,1),u.type==="email"&&t.removeFlatContact(e,n);break}}}},g=function(){var e={broadcast:1,emitFacade:!0};t.publish(s.CONTACT_CHANGED,e),t.publish(s.CONTACTS_LOADED,e),t.publish(s.CONTACT_IMAGE_UPDATED,e)}()},e.augment(r,e.EventTarget),t.cache=new r},"1.0.0",{requires:["contacts-api-config","common-utils-stats"]});
YUI.add("contacts-api-utils",function(e){"use strict";e.namespace("contacts");var t=e.contacts,n=t.cache,r=function(){var t=this;t.getContactsByEmail=function(e){return!e||e===""?null:n.getEmails()[e.toLowerCase()]},t.isEmailKnown=function(e,n){var r,i;return r=t.getContactsByEmail(e),r?1:0},t.getContactById=function(e){var t;return t=n.getContacts()[e],t},t.getContactsByIds=function(e){var n,r;n=[];for(r in e)e.hasOwnProperty(r)&&n.push(t.getContactById(e[r]));return n},t.getCategoryById=function(e){var t;return t=n.getCategories()[e],t},t.areContactsLoaded=function(){return n.isLoaded()},t.getResponseObject=function(){return n.getResponseObject()},t.getContacts=function(e){var t,r={},i=n.getContacts();if(!e)return i;for(t in i)i.hasOwnProperty(t)&&i[t].id>=0&&(r[t]=i[t]);return r},t.getSmartContacts=function(){var e,t={};for(e in n.getContacts())n.getContacts().hasOwnProperty(e)&&n.getContacts()[e].id<0&&(t[e]=n.getContacts()[e]);return t},t.getAllContacts=function(){return n.getContacts()},t.getCategories=function(){return n.getCategories()},t.getContactsClone=function(e){var r={},i,s,o,u;if(e){i=n.getContactsByBucket(0,n.getContactOrder().length,e).contacts,o=i.length;while(o--)r[i[o].id]=i[o]}else{s=t.getContacts();for(u in s)r[u]=s[u]}return r},t.getFlatContacts=function(){var e=t.getContacts(),n=[],r,i,s;for(i in e)if(e.hasOwnProperty(i)){r=t.getBasicFlatContacts(e[i]);for(s in r)r.hasOwnProperty(s)&&n.push(r[s])}return n},t.getFieldsByType=function(e,t){return n.getContactsData()[e.id].typedFields[t]},t.getFieldValues=function(r,i,s){var o,u,a;if(!r||!i)return null;if(s){u=t.getFieldsByType(r,i);if(u){o=[];for(a in u)u.hasOwnProperty(a)&&e.Array.indexOf(a.flags,s)&&o.push(a.value)}return o}return n.getContactsData()[r.id].typedFieldValues[i]},t.getShownContactName=function(n){var r,i,s=e.Lang.trim,o=s(n.name),u=n.email;if(t.isEmailKnown(u)){r=t.getContactsByEmail(u),i=t.getFirstFieldValue(r[0],"nickname");if(i)return i;i=t.getFirstFieldValue(r[0],"name");if(i){i=i.familyName+" "+i.givenName;if(s(i))return i}}return o||u},t.getName=function(n){var r,i,s=e.Lang.trim,o=s(n.name),u=n.email;if(t.isEmailKnown(u)){r=t.getContactsByEmail(u),i=t.getFirstFieldValue(r[0],"nickname");if(i)return i;i=t.getFirstFieldValue(r[0],"name");if(i&&i.givenName){i=i.givenName;if(s(i))return i}else if(i&&i.familyName){i=i.familyName;if(s(i))return i}return o}},t.getFirstFieldValue=function(e,n,r){return!e||!n?null:(t.getFieldValues(e,n,r)||[])[0]},t.getHigherPrecedenceFieldByType=function(e,n){function r(e,t){return e.id-t.id}if(!e)return null;var i=t.getFieldsByType(e,n)||[];return i.sort(r)[0]?i.sort(r)[0].value:null},t.getBasicFlatContacts=function(e){var r=n.getContactsData()[e.id].flatContacts,i,s,o,u;if(!r){r=[],s=t.getFieldsByType(e,"email")||[],i=t.getHigherPrecedenceFieldByType(e,"name")||{},o=s.length&&s[0]||{value:""};for(u in s)s.hasOwnProperty(u)&&r.push({firstname:i.givenName,lastname:i.familyName,middlename:i.middleName,nickname:t.getFirstFieldValue(e,"nickname"),email:s[u].value,emailField:s[u],id:e.id,isPrimary:s[u].value===o.value});n.getContactsData()[e.id].flatContacts=r}return r},t.getContactImage=function(e){var r=n.getContactsData()[e.id].image,i;return r||(i=t.getFirstFieldValue(e,"guid"),i&&(r=i.image),n.getContactsData()[e.id].image=r),r},t.getSortedFlatContacts=function(e){return t.sortFlatContacts(t.getFlatContacts(),e)},t.sortFlatContacts=function(e,t){function r(e){var t=0,n,r=e.matches,i;if(r)for(n in r)r[n].length===1&&(i=r[n][0],i.endIndex-i.startIndex===e[n].length&&t++);return t}function i(e,t,n){var r=e[n],i=t[n];return r&&i?r===i?null:r<i?-1:1:!r&&!i?null:r?-1:1}function s(e,t){var r,s;for(s in n)if(n.hasOwnProperty(s)){r=i(e,t,n[s]);if(r)return r}return 0}var n=t||["firstname","lastname","email"];return e.sort(s),e},t.getContactsCacheBucket=function(e,t,r){return n.getContactsByBucket(e,t,r)},t.getContactOrder=function(){return n.getContactOrder()},t.loadSortPrefs=function(e,t){n.loadSortPrefs(e,t)},t.getSortPrefs=function(){return n.getSortPrefs()},t.getSortedContacts=function(){var e=t.getContacts(),n=t.getContactOrder(),r=n.length,i=[],s;for(s=0;s<r;s++)i.push(e[n[s]]);return i},t.getTotalContacts=function(){return n.getContactOrder().length}};t.utils=new r},"1.0.0",{requires:["contacts-api-cache","common-utils-stats"]});
YUI.add("contacts-api-urigenerator",function(e){"use strict";function h(e,t,n){var r=e.split(" "),i,s="",o=r.length;while(o--)i=r[o],i&&(s&&(s+=";"),s+=u.replace("{field}",t).replace("{condition}",n).replace("{query}",encodeURIComponent(i.replace(/,/g,"\\,"))));return s}function p(t,n){var i={id:t.id,op:"update",fields:[],categories:[]},s=i.fields,o=t.fields||[],u=n.fields||[],a={},f,l,c,h,p;t=e.clone(t,!0),n=e.clone(n,!0),p=o.length;while(p--)a[parseInt(o[p].id,10)]=o[p];p=u.length;while(p--){c=u[p],f=parseInt(c.id,10),h=c.categories,l=a[f];if(!l)s.push({op:"add",value:c.value,type:c.type,flags:c.flags||[]}),h&&(s[s.length-1].categories=h);else{if(c.type!==l.type||!r.congruent(c.value,l.value,!1)||!r.congruent(c.flags,l.flags,!1)||!r.congruent(h,l.categories,!1))c.type==="yahooid"&&!r.congruent(h,l.categories,!1)?(s.push({op:"remove",id:l.id}),s.push({op:"add",value:c.value,type:c.type,flags:c.flags||[],categories:h})):(s.push({op:"update",id:f,value:c.value,type:c.type,flags:c.flags||[]}),h&&(s[s.length-1].categories=h));delete a[f]}}for(p in a)a.hasOwnProperty(p)&&s.push({op:"remove",id:p});return i}function d(e,t){e=e||[],t=t||[];var n=[],r={},i,s,o,u;u=e.length;while(u--)r[parseInt(e[u].id,10)]=e[u];u=t.length;while(u--)i=t[u],o=i.id,s=r[o],s?delete r[o]:n.push({op:"addTo",id:o});for(u in r)r.hasOwnProperty(u)&&n.push({op:"removeFrom",id:e[u].id});return n}function v(t){t.path=t.wspath||"ws/sd",t.baseHost=t.baseHost||e.config.win.location.host,this.params=undefined,this.method="GET",this.rev=t.rev,this.useCORS()?this.uri=c:(this.headers=t.headers||{"Content-Type":"application/json"},this.uri=t.uri||e.config.win.location.protocol+"//"+(t.baseHost+"/"+t.path).replace("//","/")+"?/"),this.uri+=t.singleContact?o.replace("{guid}",t.guid).replace("{cid}",t.id):s.replace("{guid}",t.guid),t.prefs&&(this.uri+="/preferences;"),t.contactImport&&(this.uri+="/import"),this.init(t)}var t=e.contacts,n=t.utils,r=e.common.Utils,i=e.Lang,s="v1/user/{guid}/contacts",o="v1/user/{guid}/contact/{cid}",u="{field}.{condition}={query}",a={asc:1,desc:2,1:1,2:2},f={first:-10001,last:-10003,email:4,"-10001":"first","-10003":"last",4:"email",1:-10001,3:-10003,6:4},l=r.features.enabled("socDirXDR"),c=r.settings.value("contactProgrssURL");v.prototype={init:function(e){var t=v.METHODS,n=e.type||t.DEFAULT;switch(n){case t.SAVE:case t.DELETE:i.isNumber(this.rev)&&this.rev>=0?(this.method="PUT",e.isCreateList?this.setCreateListParams(e):this.setPUTParams(e),this.setPUTUri(e)):(this.method="POST",e.isCreateList?this.setCreateListParams(e):this.setPOSTParams(e),this.setPOSTUri(e));break;case t.SAVE_PREFS:this.method="POST",this.setPOSTPrefsParams(e),this.setPOSTUri(e);break;case t.DELETE_CATEGORIES:case t.SAVE_CATEGORIES:this.method="PUT",this.setCategoriesParams(e),this.setPUTUri(e);break;case t.UPDATE_CONTACTS_CATEGORIES:this.method="PUT",this.setUpdateCategoriesParams(e),this.setPUTUri(e);break;case t.REMOVE_FIELD:this.method="PUT",this.setRemoveFieldParams(e),this.setPUTUri(e);break;case t.IMPORT_CONTACT:this.method="POST",this.setPOSTImportParams(e),this.setPOSTUri(e);break;default:this.method="GET",this.setGETUri(e)}},getURI:function(){return this.uri},getMethod:function(){return this.method},setMethod:function(e){this.method=e},useCORS:function(){return l===!0&&"withCredentials"in new XMLHttpRequest},getXDR:function(){return this.useCORS()?{use:"native",credentials:!0}:undefined},getHeaders:function(){return this.useCORS()?{"Content-Type":"text/plain; chaset=utf-8"}:this.headers},setHeaders:function(e){this.headers=e},getParams:function(){return this.params},stripContact:function(e){e._data&&(e._data=undefined)},setPOSTImportParams:function(e){var t=e.contactImport;this.params={},t&&(this.params=t)},setPOSTPrefsParams:function(e){var t=e.prefs,n={},r=t.sort_order,i=t.sort_field;this.params={},t&&(r&&(n.sort_order=a[r]),i&&(n.sort_type=f[i]),this.params.preferences=n)},setPOSTParams:function(e){var t={};this.params={},e.contacts&&i.isArray(e.contacts)&&!i.isUndefined(e.contacts[0])&&(t=e.contacts[0]),this.stripContact(t),this.params.contact=t},setPOSTUri:function(e,t){this.uri+=t===!0?"/sync?format=json&custId=ymail":"?format=json",e.wssid&&(this.uri+="&wssid="+e.wssid),this.useCORS()&&(this.uri+="&custId=ymail")},setCreateListParams:function(e){var t=e.newContacts,n=e.updateContacts,r={name:e.category,op:"add",refid:"01"},i=[{refid:"01",op:"addTo"}],s={rev:this.rev,categories:[],contacts:[]},o,u,a;s.categories.push(r),a=t.length;while(a--)o=t[a],u={op:"add",fields:[{value:{givenName:o.name},type:"name",op:"add"},{value:o.email,type:"email",op:"add"}],categories:i},s.contacts.push(u);a=n.length;while(a--)u={id:n[a].id,op:"update",categories:i},s.contacts.push(u);this.params={contactsync:s}},setPUTParams:function(t){var r=t.contacts||[],s=t.categories||[],o=[],u=[],a,f,l,c,h,v,m,g;this.params={contactsync:{rev:this.rev}},m=r.length;if(m>0){while(m--){a=e.clone(r[m]);if(i.isValue(a.id)){if(!a.op||a.op!=="remove")f=n.getContactById(a.id),c=a.categories,l=f.categories,a=p(f,a),a.categories=d(l,c)}else{a.op="add",v=a.fields||[],g=v.length;while(g--)v[g].op="add";v=a.categories||[],g=v.length;while(g--)v[g]={op:"addTo",id:v[g].id};this.stripContact(a)}o.push(a)}this.params.contactsync.contacts=o}m=s.length;if(m>0){while(m--){h=e.clone(s[m]);if(i.isValue(h.id))throw new Error("category modification not yet implemented");h.op="add",h.contacts=n.getContactsByIds(h.contacts),u.push(h)}this.params.contactsync.categories=u}},setPUTUri:function(e){this.useCORS()?this.setPOSTUri(e,!0):this.setPOSTUri(e)},setGETUri:function(e){var t,n=e.fields,r,s=this.uri;if(n)for(r in n)n.hasOwnProperty(r)&&(t=n[r],t.name&&t.condition&&t.value&&(s+=";"+t.name+"."+t.condition+"="+t.value));e.searchQuery&&e.searchField&&e.searchCondition&&(s+=";"+h(e.searchQuery,e.searchField,e.searchCondition)),e.out&&(s+=";out="+e.out),e.start&&(s+=";start="+e.start),e.count&&(s+=";count="+e.count),e.sortfields&&(s+=";sort-fields="+e.sortfields),e.sort&&(s+=";sort="+
e.sort),s+="?format=json",e.view&&(i.isArray(e.view)?s+="&view="+e.view.join("&view="):s+="&view="+e.view),i.isValue(e.rev)&&(s+="&rev="+e.rev),e.wssid&&(s+="&wssid="+e.wssid),e.id&&(s+="&id="+e.id),this.useCORS()&&(s+="&custId=ymail"),this.uri=s},setCategoriesParams:function(e){var t=e.categories||[],n={rev:this.rev,categories:[],contacts:[]},r=[],i={},s,o=t.length;while(o--)s=t[o],s.id?s.op==="remove"?i=s:i={op:"update","new":{name:s.name},old:{id:s.id}}:i={op:"add",name:s.name},r.push(i);n.categories=r,this.params={contactsync:n}},setUpdateCategoriesParams:function(t){var n=t.categories.addTo||[],r=n.length,i=t.categories.removeFrom||[],s=i.length,o=t.contacts,u=o.length,a=[],f=[],l=[],c=1,h={rev:this.rev,categories:[],contacts:[]},p,d;p=r;while(p--)d=n[p],e.Lang.isNumber(d)?f.push({id:n[p],op:"addTo"}):(l.push({name:d,op:"add",refid:c}),f.push({refid:c,op:"addTo"}),c++);p=s;while(p--)f.push({id:i[p],op:"removeFrom"});p=u;while(p--)a.push({id:o[p],op:"update",categories:f});h.contacts=a,h.categories=l,this.params={contactsync:h}},setRemoveFieldParams:function(e){var t={rev:this.rev,contacts:[]},r=!1,i=e.fieldId,s=e.contactId,o=n.getContactById(s),u={id:s},a=o.fields,f,l=a.length;while(l--){f=a[l];if(f.id!==i&&f.type!=="guid"){r=!0;break}}r?(u.op="update",u.fields=[{op:"remove",id:i}]):u.op="remove",t.contacts=[u],this.params={contactsync:t}}},v.METHODS={DEFAULT:0,GETCONTACTS:1,SAVE:2,DELETE:3,SAVE_CATEGORIES:4,DELETE_CATEGORIES:5,SAVE_PREFS:6,UPDATE_CONTACTS_CATEGORIES:7,REMOVE_FIELD:8,IMPORT_CONTACT:9},e.namespace("contacts"),t.URIGenerator=v},"1.0.0",{requires:["contacts-api-utils","mail-common-utils-settings","mail-common-utils-features"]});
YUI.add("contacts-api-io",function(e){"use strict";function i(e,t){return function(n,r){var i={};if(!r)return e.failure(i,r,t);try{i=e.parseJSON(r)}catch(s){return typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-contacts-api-io:1",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-contacts-api-io:1"),e.failure(i,r,t)}return i.error||!e.isSuccess(r.status)?e.failure(i,r,t):e.success(i,r,t)}}function s(e){this.io=null,this.maxRetries=2,this.retryCount=0,this.uriGenerator=t.URIGenerator,this.onSuccess=function(){},this.onFailure=function(){},this.hook=e}e.namespace("contacts");var t=e.contacts,n=e.Lang,r=e.JSON;s.prototype={parseJSON:function(t){var n={};if(typeof t.body=="string")n=r.parse(t.body);else if(typeof t.body=="object")n=t.body;else{if(typeof t.responseText!="string"||t.responseText==="")throw e.fire("MailLog",{m:"contacts-api-io.Request.parseJSON",info:"Contacts API returned empty or unrecognized response"}),new Error("no response body to parse");n=r.parse(t.responseText)}return n.status=t.status,n.statusText=t.statusText,n},isSuccess:function(e){switch(e){case 200:case 201:case 202:case 204:return!0}return!1},doRetry:function(e){switch(e){case 500:return!0}return!1},success:function(e,t,n){this.onSuccess(e,t,n),this.retryCount=0},failure:function(t,r,i){var s=t.error&&t.error.detail&&(t.error.detail.match?t.error.detail.match(/-\d+/):null);if(("-50304"===s||!r||this.doRetry(r.status))&&this.retryCount<this.maxRetries)return this.retryCount+=1,e.later(100,this,function(){this.send(i)});this.retryCount=0,t.errorCode=!n.isUndefined(s)&&!n.isNull(s)?s:"-99999",this.onFailure(t,r,i)},send:function(t){var n=i(this,t),s=this,o=this.uriGenerator.getURI(),u=this.uriGenerator.getMethod(),a=this.uriGenerator.useCORS(),f={data:r.stringify(this.uriGenerator.getParams()),on:{success:n,failure:n},headers:this.uriGenerator.getHeaders(),method:u==="PUT"&&a===!0?"POST":u,xdr:this.uriGenerator.getXDR(),sync:!1};this.hook&&a===!1?(f.serviceCredType="loose",s.io=this.hook(o,f)):e.use("io",function(e){s.io=e.io(o,f)})},abort:function(){return this.io&&typeof this.io.abort=="function"?(this.io.abort(),!0):!1}},t.sendRequest=function(e,t,n,r,i){var o=new s(r,i);return t&&(o.onSuccess=t),n&&(o.onFailure=n),e&&(o.uriGenerator=e),o.send(),o},t.Request=s},"1.0.0",{requires:["contacts-api-urigenerator","json"]});
YUI.add("contacts-api-adapter",function(e){"use strict";e.namespace("contacts");var t=e.contacts,n=t.URIGenerator,r=t.cache,i=e.Lang,s="CONTACTS",o,u;e.common&&e.common.Utils&&(o=e.common.Utils,u=new o.Stopwatch("ContactsRequest")),t.APIAdapter={},function(){function a(e,t,s,o,f,l){function d(n){s.push(n.contact);if(e.length===0){var u=r.update(s);f&&i.isFunction(f)&&f(u)}else a(e,t,s,o,f,l)}function v(n){if(e.length===0&&s.length>0)r.update(s);else if(e.length>0){a(e,t,s,o,f,l);return}l&&i.isFunction(l)&&l(n)}var c=t.requestFn||null,h,p={baseHost:t.baseHost,uri:t.uri,headers:t.headers,guid:t.guid,type:n.METHODS.SAVE,wspath:t.wspath,wssid:t.wssid};o?p.contacts=o:p.contacts=[e.shift()],h=new n(p),u(h,d,v,c,{contact:p.contacts})}function f(e,t,s,o){function c(e){var t=r.update(e);s&&i.isFunction(s)&&s(t,e)}function h(e){o&&i.isFunction(o)&&o(e)}var a=t.requestFn||null,f,l={baseHost:t.baseHost,guid:t.guid,type:n.METHODS.SAVE,wspath:t.wspath,uri:t.uri,headers:t.headers,rev:r.getCurrentRevision(),wssid:t.wssid};i.isArray(e)||(e=[e]),l.contacts=e,f=new n(l),u(f,c,h,a)}var s=this,o=!1,u=t.sendRequest;s.getContact=function(s,o,a,f){function v(e){o&&i.isFunction(o)&&o(e)}function m(e){a&&i.isFunction(a)&&a(e)}var l,c,h,p,d;if(r.isLoaded()&&!f){l=r.getContacts()[s],l&&o&&i.isFunction(o)&&o({contact:l});return}c=t.config.getAttrs(),h=c.requestFn||null,p={baseHost:c.baseHost||e.config.win.location.host,uri:c.uri,headers:c.headers,guid:c.guid,wssid:c.wssid,type:n.METHODS.GETCONTACTS,start:c.start,count:c.count||"max",sortfields:c.sortfields,out:c.out,sort:c.sort,fields:c.fields,wspath:c.wspath,view:c.view,rev:c.rev,singleContact:!0,id:s},d=new n(p),u(d,v,m,h)},s.getContacts=function(s,a,f){function d(e,t){var n=t.responseHeaders,s;n&&(s=n["X-Yahoo-Social-ContactsRev"]||n["X-Yahoo-Social-Contactsrev"]||n["x-yahoo-social-contactsrev"],s&&r.setCurrentRevision(parseInt(s,10))),r.load(e),a&&i.isFunction(a)&&a(r.getContacts()),o=!1}function v(e){o=!1,f&&i.isFunction(f)&&f(e)}if(r.isLoaded()&&!s){a&&i.isFunction(a)&&a(r.getContacts());return}var l=t.config.getAttrs(),c=l.requestFn||null,h,p={baseHost:l.baseHost||e.config.win.location.host,uri:l.uri,headers:l.headers,guid:l.guid,wssid:l.wssid,type:n.METHODS.GETCONTACTS,start:l.start,count:l.count||"max",sortfields:l.sortfields,out:l.out,sort:l.sort,fields:l.fields,wspath:l.wspath,view:l.view};o&&a&&i.isFunction(a)?e.once("contacts:api:loaded",function(){a(r.getContacts())}):(o=!0,h=new n(p),u(h,d,v,c))},s.createList=function(e,s,o,a,f){function d(e){var t=r.update(e);a&&i.isFunction(a)&&a(t,e)}function v(e){f&&i.isFunction(f)&&f(e)}var l=t.config.getAttrs(),c=l.requestFn||null,h={baseHost:l.baseHost,uri:l.uri,headers:l.headers,guid:l.guid,type:n.METHODS.SAVE,wspath:l.wspath,wssid:l.wssid,rev:r.getCurrentRevision(),newContacts:e,updateContacts:s,category:o,isCreateList:!0},p=new n(h);p.setMethod("PUT"),u(p,d,v,c)},s.deleteContacts=function(e,s,o){function d(e){o&&i.isFunction(o)&&o(e)}function v(e){var t,n,o,u;if(e.status===202){t=e.syncresult.results,n=t.contacts,o=n.length;while(o--)if(n[o].error){e.errorCode=n[o].error,d(!1,e);return}}u=r.update(e),s&&i.isFunction(s)&&s(u,e)}var a=t.config.getAttrs(),f=a.requestFn||null,l=[],c=e&&i.isArray(e)?e.length:0,h={baseHost:a.baseHost,guid:a.guid,type:n.METHODS.DELETE,wspath:a.wspath,uri:a.uri,headers:a.headers,rev:r.getCurrentRevision(),wssid:a.wssid},p;while(c--)l.push({id:e[c],op:"remove"});h.contacts=l,p=new n(h),u(p,v,d,f)},this.getPreferences=function(e,s){function c(e){s&&i.isFunction(s)&&s(e)}function h(t,n,r){var s=t.preferences||"";e&&i.isFunction(e)&&e(s)}var o=t.config.getAttrs(),a=o.requestFn||null,f={baseHost:o.baseHost,guid:o.guid,wspath:o.wspath,uri:o.uri,headers:o.headers,rev:r.getCurrentRevision(),wssid:o.wssid,prefs:!0},l;l=new n(f),u(l,h,c,a)},this.importContact=function(e,s,o){function h(e){o&&i.isFunction(o)&&o(e)}function p(e,t,n){var r=e.preferences||"";s&&i.isFunction(s)&&s(r)}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost,guid:a.guid,wspath:a.wspath,uri:a.uri,headers:a.headers,rev:r.getCurrentRevision(),wssid:a.wssid,type:n.METHODS.IMPORT_CONTACT,contactImport:e.contactImport},c;c=new n(l),u(c,p,h,f)},this.saveContacts=function(e,n,s){var o=t.config.getAttrs(),u=r.getCurrentRevision();u>0||!i.isArray(e)||e.length===1?f(e,o,n,s):a(e,o,[],n,s)},this.getContactsTinyUserCard=function(s,o,a){function p(e){var t=r.loadTinyUserCard(e)[0];o&&i.isFunction(o)&&o(t)}function d(e){a&&i.isFunction(a)&&a(e)}var f=t.config.getAttrs(),l=f.requestFn||null,c={baseHost:f.baseHost||e.config.win.location.host,uri:f.uri,headers:f.headers,guid:f.guid,wssid:f.wssid,type:n.METHODS.GETCONTACTS,start:0,count:1,fields:[{name:"guid",condition:"is",value:s}],wspath:f.wspath,view:"tinyusercard"},h=new n(c);u(h,p,d,l)},this.saveCategory=function(e,s,o){function h(e){var t=e.syncresult.results,n,o;if(e.status===202){n=t.categories;if(n[0].error){e.errorCode=n[0].error,p(!1,e);return}}o=e.syncresult.diff,r.updateCategories(e),s&&i.isFunction(s)&&s(o,e)}function p(e){o&&i.isFunction(o)&&o(e)}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost,guid:a.guid,type:n.METHODS.SAVE_CATEGORIES,wspath:a.wspath,uri:a.uri,headers:a.headers,rev:r.getCurrentRevision(),categories:[e],wssid:a.wssid},c=new n(l);u(c,h,p,f)},this.deleteCategory=function(e,s,o){function h(e){var t=e.syncresult.results,n;if(e.status===202){n=t.categories;if(n[0].error){e.errorCode=n[0].error,p(!1,e);return}}r.updateCategories(e),s&&i.isFunction(s)&&s(e.syncresult.diff,e)}function p(e){o&&i.isFunction(o)&&o(e)}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost,guid:a.guid,type:n.METHODS.DELETE_CATEGORIES,wspath:a.wspath,uri:a.uri,headers:a.headers,rev:r.getCurrentRevision(),categories:[{id:e,op:"remove"}],wssid:a.wssid},c=new n(l);u(c,h,p,f)},this.updateContactsCategories=function(e,s,o,a,f){function d(e){var t=e.syncresult.results,n;if(e.status===202){n=t.categories;if(n[0].error){e.errorCode=n[0].error,v(!1
,e);return}}r.updateCategories(e),a&&i.isFunction(a)&&a(e.syncresult.diff,e)}function v(e,t){f&&i.isFunction(f)&&f(t)}var l=t.config.getAttrs(),c=l.requestFn||null,h={baseHost:l.baseHost,guid:l.guid,type:n.METHODS.UPDATE_CONTACTS_CATEGORIES,wspath:l.wspath,uri:l.uri,headers:l.headers,rev:r.getCurrentRevision(),categories:{addTo:s,removeFrom:o},contacts:e,wssid:l.wssid},p=new n(h);u(p,d,v,c)},this.removeField=function(e,s,o,a){function p(e){r.updateCategories(e),o&&i.isFunction(o)&&o(e.syncresult.diff,e)}function d(e,t){a&&i.isFunction(a)&&a(t)}var f=t.config.getAttrs(),l=f.requestFn||null,c={rev:r.getCurrentRevision(),contactId:e,fieldId:s,baseHost:f.baseHost,guid:f.guid,type:n.METHODS.REMOVE_FIELD,wspath:f.wspath,uri:f.uri,headers:f.headers,wssid:f.wssid},h=new n(c);u(h,p,d,l)},this.setSortField=function(e,s,o){function h(e){var t=e.preferences;t&&(r.setSortPrefs(t.sort_order,t.sort_type),s&&i.isFunction(s)&&s())}function p(e){o&&i.isFunction(o)&&o(e)}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost,guid:a.guid,type:n.METHODS.SAVE_PREFS,wspath:a.wspath,uri:a.uri,headers:a.headers,wssid:a.wssid,prefs:{sort_field:e}},c=new n(l);u(c,h,p,f)},this.setSortOrder=function(e,s,o){function h(e){var t=e.preferences;t&&(r.setSortPrefs(t.sort_order,t.sort_type),s&&i.isFunction(s)&&s())}function p(e){o&&i.isFunction(o)&&o(e)}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost,guid:a.guid,type:n.METHODS.SAVE_PREFS,wspath:a.wspath,uri:a.uri,headers:a.headers,wssid:a.wssid,prefs:{sort_order:e}},c=new n(l);u(c,h,p,f)},this.getSortPrefs=function(s,o){function h(e){var t=e.preferences;t&&t.sort_order&&t.sort_type&&(r.setSortPrefs(t.sort_order,t.sort_type),s&&i.isFunction(s)&&s())}function p(e){o&&i.isFunction(o)&&o(e)}if(r.getSortPrefs()){s&&i.isFunction(s)&&s(r.getSortPrefs());return}var a=t.config.getAttrs(),f=a.requestFn||null,l={baseHost:a.baseHost||e.config.win.location.host,uri:a.uri,headers:a.headers,guid:a.guid,wssid:a.wssid,type:n.METHODS.DEFAULT,wspath:a.wspath,prefs:!0},c=new n(l);u(c,h,p,f)},this.removeField=function(e,s,o,a){function p(e){r.updateCategories(e),o&&i.isFunction(o)&&o(e.syncresult.diff,e)}function d(e,t){a&&i.isFunction(a)&&a(t)}var f=t.config.getAttrs(),l=f.requestFn||null,c={rev:r.getCurrentRevision(),contactId:e,fieldId:s,baseHost:f.baseHost,guid:f.guid,type:n.METHODS.REMOVE_FIELD,wspath:f.wspath,uri:f.uri,headers:f.headers,wssid:f.wssid},h=new n(c);u(h,p,d,l)},this.searchContacts=function(e,r,s){function c(e){var t=e.contacts.contact||[];r&&i.isFunction(r)&&r(t)}function h(e){s&&i.isFunction(s)&&s(e)}var o=t.config.getAttrs(),a=o.requestFn||null,f={baseHost:o.baseHost,guid:o.guid,type:n.METHODS.GETCONTACTS,wspath:o.wspath,uri:o.uri,headers:o.headers,wssid:o.wssid,out:o.out,fields:o.fields,search:o.search,searchField:"all",searchCondition:"contains",searchQuery:e},l=new n(f);u(l,c,h,a)},this.createEmptyContact=function(){return{fields:[],categories:[]}}}.apply(t.APIAdapter)},"1.0.0",{requires:["contacts-api-io","contacts-api-cache","contacts-api-urigenerator","contacts-api-config","json","common-utils"]});
YUI.add("contacts-api",function(e){"use strict";e.namespace("contacts");var t=e.contacts,n=t.APIAdapter,r=t.cache,i=function(){var t=this;this.load=function(e,t,r){n.getContacts(e,t,r)},this.saveContacts=function(e,t,r){n.saveContacts(e,t,r)},this.deleteContacts=function(e,t,r){n.deleteContacts(e,t,r)},this.getPreferences=function(e,t){n.getPreferences(e,t)},this.importContact=function(e,t,r){n.importContact(e,t,r)},this.saveCategory=function(e,t,r){n.saveCategory(e,t,r)},this.deleteCategory=function(e,t,r){n.deleteCategory(e,t,r)},this.createList=function(e,t,r,i,s){n.createList(e,t,r,i,s)},this.getContacts=function(e,t,r){if(typeof e!="boolean")return;n.getContacts(e,t,r)},this.getContact=function(e,t,r,i){n.getContact(e,t,r,i)},this.createEmptyContact=function(e,t){return n.createEmptyContact(e,t)},this.getContactImage=function(e,t,r){n.getContactsTinyUserCard(e,t,r)},this.searchContacts=function(e,t,r){n.searchContacts(e,t,r)},e.on("contacts:contactChanged",function(){t.load(1)}),this.setSortOrder=function(e,t,r){n.setSortOrder(e,t,r)},this.setSortField=function(e,t,r){n.setSortField(e,t,r)},this.getSortPrefs=function(e,t){n.getSortPrefs(e,t)},this.updateContactsCategories=function(e,t,r,i,s){n.updateContactsCategories(e,t,r,i,s)},this.removeEmail=function(e,t,r,i){n.removeField(e,t,r,i)},this.removeEmail=function(t,i,s){r.removeField(t,i);var o=e.contacts.utils.getContactById(t);n.removeField(t,i),s&&s()}};t.api=new i},"1.0.0",{requires:["contacts-api-adapter","contacts-api-config","contacts-api-cache","contacts-api-utils"]});
YUI.add("filter-contacts",function(e){function h(){this.filterItems=[],this.matchType=1,this.init_temp_data=!0,this.del_temp_data=!0,this.match_limit=50}function b(e){var t,n,r,i=e.value;if(e.numeric){n=i.length;if(n>1){r=i.charAt(0),t=1;while(t<n)r+="[ _\\.\\-()]*",r+=i.charAt(t),t+=1}else r=i}else r=i;e.regExp=new RegExp(r,"gi")}function w(e,t){var n={};return n.value=e,v.test(e)||(n.numeric=!0),n.group_id=t,n.match_siIndex=-1,b(n),n}function E(e){var t,n,r,i,s,o,u=[];n=e.length;if(n===0)return u;var a=new RegExp("[ ]","g");for(t=0;t<n;t++){r=e[t],i=0;while(a.test(r))s=a.lastIndex-1,i<s&&(o=w(r.substring(i,s),t),u.push(o)),i=a.lastIndex;i<r.length&&(o=w(r.substring(i),t),u.push(o))}return u}function S(e){var t=[],n,r,i;if(e.length>0){i=new RegExp("[,;]","g"),n=0;while(i.test(e))r=i.lastIndex-1,r>n&&t.push(e.substring(n,r)),n=i.lastIndex;n<e.length&&t.push(e.substring(n))}return t}function x(e,t,n,r){var i,s,o,u,a,f,l,c,p;l=r.fuzzy_match_idx+1,f=r.fuzzy_matches;if(l<f.length)return a=f[l],r.fuzzy_match_idx=l,a;if(!r.fuzzy_complete){i=g,s=-1;for(;;){if(s===-1&&r.fuzzy_match_idx===-1)s=0;else{s<=0&&(i.lastIndex=r.fuzzy_match_idx===-1?0:f[r.fuzzy_match_idx].start+1);if(!i.test(e))break;s=i.lastIndex-1}u=r.matches;for(l=0,c=u.length;l<c;l++){o=u[l];if(s>o.start)break;if(s===o.start)return a={},a.start=o.start,a.end=o.end,a.diff=0,f.push(a),r.fuzzy_match_idx+=1,n.match_idx=a.end,a}c=n.value.length;if(c<=2){p=0;if(r.complete)continue}else c<=5?p=1:p=2;if((a=h.fuzzyMatch(n.value,e,s,p))!==null)return f.push(a),r.fuzzy_match_idx+=1,n.match_idx=a.end,a}r.fuzzy_complete=!0}return r.fuzzy_match_idx=-1,null}function T(e,t,n,r){var i,s,o,u,a,f;s=r.match_idx+1,f=r.matches;if(s<f.length)return a=f[s],r.match_idx=s,a;if(!r.complete){i=n.regExp,i.lastIndex=r.match_idx===-1?0:f[r.match_idx].start+1,o=i.lastIndex;while(i.exec(e)){if(t)return u=e.substring(o,i.lastIndex),o+=u.search(i),a={},a.end=i.lastIndex,a.start=o,f.push(a),r.match_idx+=1,n.match_idx=a.end,a;o=i.lastIndex-n.value.replace(/\\/g,"").length;if(o===0||e.charAt(o-1).search(m)===0)return a={},a.end=i.lastIndex,a.start=o,f.push(a),r.match_idx+=1,n.match_idx=a.end,a}r.complete=!0}return r.match_idx=-1,null}function N(e,t,n,r,i,s,o){var u,a=n||e.matchType!==2?T:x;while((u=a(t,n,r,i))!==null){if(!o){if(r.start_siIndex===s&&r.start_idx===u.start)continue;return!0}if(u.start>=r.start_idx)return r.start_idx=u.start,!0}return!1}function C(e,t){var n=t.matches,r,i,s,o,u,a,f;if(e.match_idx!==-1)r=e.match_idx,i=e.matches;else{if(e.fuzzy_match_idx===-1)return!1;r=e.fuzzy_match_idx,i=e.fuzzy_matches}u=i[r].start,a=i[r].end;for(s=0,o=n.length;s<o;s++){f=n[s];if(!(f.end<=u||a<=f.start))return!1}for(s=0,o=t.length;s<o;s++)if((t[s].match_idx!==-1||t[s].fuzzy_match_idx!==-1)&&t[s].group_id!==e.group_id)return!1;return f={},f.start=u,f.end=a,t.matches.push(f),!0}function k(e,t,n,r,i,s,o){if(i.phoneno&&!t.numeric)return!1;var u,a,f,l,c,h,p;for(u=0,a=i.length;u<a;u++)if(i[u].index===n){f=i[u];break}f||(f={},f.index=n,f.group_id=t.group_id,f.match_idx=-1,f.matches=[],f.fuzzy_match_idx=-1,f.fuzzy_matches=[],i.push(f));var d=f.match_idx;while(N(e,r,i.phoneno,t,f,s,o))if(C(f,i))return!0;if(d!==-1){p=i.matches,l=f.matches[d].start,c=f.matches[d].end;for(u=0,a=p.length;u<a;u++)h=p[u],h.start===l&&h.end===c&&p.splice(u,1)}return t.match_idx=-1,!1}function L(e,t,n,r){var i,s,o,u,a,f,l,c;s=p.length,c=!1,n.match_siIndex===-1&&(c=!0,n.start_siIndex=-1,n.start_idx=-1,r>0&&(l=e.filterItems[r-1],l.group_id===n.group_id&&(n.start_siIndex=l.match_siIndex,n.start_idx=l.match_idx)));if(c&&n.start_siIndex!==-1){i=n.start_siIndex,f=i<3;if(!f||!!n.numeric){o=p[i],u=t[o];if(u&&u.length>0){a=t._matches[o],a||(a=[],a.matches=[],f&&(a.phoneno=!0),t._matches[o]=a);if(k(e,n,r,u,a,i,!0))return n.match_siIndex=i,n.special_match=!0,!0}}}n.match_siIndex===-1?i=0:n.special_match?(n.special_match=!1,i=0):i=n.match_siIndex;while(i<s){f=i<3;if(f&&!n.numeric){i+=1;continue}o=p[i],u=t[o];if(u&&u.length>0){a=t._matches[o],a||(a=[],a.matches=[],f&&(a.phoneno=!0),t._matches[o]=a);if(k(e,n,r,u,a,i,!1))return n.match_siIndex=i,!0}i+=1}return n.match_siIndex=-1,!1}function O(e){var t,n;for(t=0,n=e.filterItems.length;t<n;t++)if(e.filterItems[t].match_siIndex!==-1)return!1;return!0}function M(e){var t,n,r,i,s,o,u,a;if(!e._matches)return!0;for(t=0,i=p.length;t<i;t++){s=p[t],o=e[s];if(o&&o.length>0){u=e._matches[s];if(u){if(u.matches.length>0)return!1;for(n=0,r=u.length;n<r;n++){a=u[n];if(a.match_idx!==-1)return!1;if(a.fuzzy_match_idx!==-1)return!1}}}}return!0}var t=e.common.Utils,n=t.escapeHtml,r=t.unescapeHtml,i=e.contacts,s=i.api,o=i.utils,u={},a=function(e){return e.emailField&&e.emailField.value?e.emailField.value:e.id},f=function(e,t){for(var n=0;n<t.length;n++)e.push(t[n]);return e},l=function(){var e=o.getSortedFlatContacts(),t=function(e,t){var n=[];return e.user&&n.push(e.user.charAt(t).toLowerCase()),e.firstname&&n.push(e.firstname.charAt(t).toLowerCase()),e.lastname&&n.push(e.lastname.charAt(t).toLowerCase()),e.nickname&&n.push(e.nickname.charAt(t).toLowerCase()),e.mobileno&&f(n,e.mobileno.toLowerCase()),e.homeno&&f(n,e.homeno.toLowerCase()),e.workno&&f(n,e.workno.toLowerCase()),e.isCategory||e.email&&n.push(e.email.charAt(t).toLowerCase()),n},n,r,i,s=o.getCategories();for(r in s){var l=s[r],c=0;for(n in l.contacts){var h=o.getContactById(l.contacts[n]),p=o.getFieldsByType(h,"email");p&&(c+=1)}e.push({firstname:l.name,email:[c,"<span style='display:none'>___AC_CAT_ID:",l.id,"</span>"].join(""),id:l.id,isCategory:!0})}i={},u=[];for(n in e){var d=e[n];if(!d.email||!d.email.length)continue;var v,m=t(d,0);for(v in m){var g=m[v];u[g]||(u[g]={}),u[g][a(d)]=d}}},c=function(e,t){var n={},r={},i={},s=null,f,l;f=e.filterItems;for(var c=0;c<f.length;c++){var h=f[c],p=h.value.charAt(0).toLowerCase(),d=u[p];for(l in d){s=d[l];if(!d[l].isCategory||!t)r[l]=d[l]}}for(l in r){var v=r[l];e.filterContact(v)&&!i[v.email]&&(i[v.email]=!0,n[a(v)]=v)}var m=[];for(l in n)m.push(n[l]);return o.sortFlatContacts(m),m};e.on("contacts:api:contactChanged"
,l),e.on("contacts:api:loaded",l),o.areContactsLoaded()?l():s.load();var p=["mobileno","homeno","workno","firstname","lastname","user","email","nickname"],d=new RegExp("[\\+\\*\\?\\^\\[\\]\\{\\}\\$\\\\/%#~:<>()]","g"),v=new RegExp("[^0-9]","g"),m=new RegExp("[ _\\.\\-@]","g"),g=new RegExp("[ _\\.\\-@][^ _\\.\\-@]","g");h.prototype.fastMatch=function(e){return e=!!e,c(this,e).slice(0,this.match_limit)};var y=/___AC_CAT_ID\:(-?[0-9]+)/;h.prototype.decodeCategory=function(e){var t=y.exec(e);if(t&&t.length>1){var n=o.getCategoryById(t[1]),r=[];for(var i in n.contacts){var s=o.getBasicFlatContacts(o.getContactById(n.contacts[i]));for(var u in s){var f=s[u];if(f.isPrimary){r[a(f)]=f;break}}}return r}return!1},h.prototype.updateFilterItems=function(t){t.length>2048&&(t=t.substring(0,2048)),t=t.replace(d," ");var n=S(t),r,i=e.common.Utils;for(r in n)n.hasOwnProperty(r)&&(n[r]=i.regexpEscape(i.escapeHtml(n[r])));this.filterItems=E(n)},h.fuzzyMatch=function(e,t,n,r){var i=e.length,s=t.length,o=[],u=[],a=[],f,l,c,h,p,d,v,m,g,y,b,w;for(f=0;f<=i;f++)u[f]=f;h=s-n,h>i+r&&(h=i+r),c=0,d="";for(l=0;l<h;l++){m=d,d=t.charAt(l+n).toLowerCase(),c<=0?(g=l+1,a[0]=g,b=g,c=0,p=""):(g=r+1,a[c]=g,b=g,p=e.charAt(f-1).toLowerCase());for(f=c,c=-1;f<i;f++){v=p,p=e.charAt(f).toLowerCase(),p===d?g=u[f]:(g=u[f]+1,y=a[f]+1,g>y&&(g=y),y=u[f+1]+1,g>y&&(g=y),p===m&&v===d&&(y=o[f-1]+1,g>y&&(g=y))),a[f+1]=g,b>g&&(b=g),c===-1&&g<=r&&(f===0&&a[0]<=r?c=0:c=f+1);if(g>a[f]&&g>r)break}if(f===i){if(g===0){u=a,l+=1;break}y=u[i];if(y!==undefined&&y<g)break}if(b>r)return null;o=u,u=a,a=[]}return g=u[i],g===undefined||g>r?null:(w={},w.start=n,w.end=l+n,w.diff=g,w)},h.prototype.filterContact=function(e){delete e.matches;if(this.filterItems.length===0)return!1;this.init_temp_data&&(e._matches={});var t,n;n=this.filterItems.length,t=0;while(t<n){if(!L(this,e,this.filterItems[t],t)){if(t>0){t-=1;continue}return this.del_temp_data&&delete e._matches,!1}t+=1}e.matches={};var r,i,s,o,u,a,f,l,c;i=p.length,r=0;while(r<i){s=p[r],o=e._matches[s];if(o&&o.length>0){for(t=0,n=o.length;t<n;t++)u=o[t],(f=u.match_idx)!==-1?(a=this.filterItems[u.index],c=u.matches[f],l={},l.term=a.value,l.startIndex=c.start,l.endIndex=c.end,e.matches[s]||(e.matches[s]=[]),e.matches[s].push(l),u.match_idx=-1):(f=u.fuzzy_match_idx)!==-1&&(a=this.filterItems[u.index],c=u.fuzzy_matches[f],l={},l.term=a.value,l.startIndex=c.start,l.endIndex=c.end,l.diff=c.diff,e.matches[s]||(e.matches[s]=[]),e.matches[s].push(l),u.fuzzy_match_idx=-1);this.del_temp_data||(o.matches=[])}r+=1}this.del_temp_data&&delete e._matches;for(t=0,n=this.filterItems.length;t<n;t++)this.filterItems[t].match_siIndex=-1;return!0},h.prototype.setConfigValues=function(t,n,r){this.matchType=t,this.init_temp_data=e.Lang.isBoolean(n)?n:!0,this.del_temp_data=e.Lang.isBoolean(r)?r:!0},h.prototype.filterContacts=function(e){var t=!0,n=[];if(this.filterItems.length!==0){this.setConfigValues(1,!0,!t);for(var r in e)typeof e[r].email!="undefined"&&this.filterContact(e[r])&&n.push(e[r])}return n},h.prototype.buildContactsIndex=function(){l()};var A=function(){function s(t){var n=u(t),s;return t.isCategory?s=e.common.Utils.substitute(r,{hilite:n},0,0,0,0,strings):s=e.common.Utils.substitute(i,{hilite:n,id:t.id,email:t.email,emailFieldId:t.emailField.id},0,0,0,0,strings),s}function o(t,n,r,i){var s="";return t||n||r?(s=e.common.Utils.substitute(strings.str_name_format,{given_name:t?t:"",middle_name:n?n:"",family_name:r?r:""}),s=s.replace(/ +(?= )/g,"")):i?s=i:s="",s}function u(t){function x(e,t,n){var r="";switch(t){case"amp":n?r="&"+n+";":r="&";break;case"#39":r="'";break;case"quot":r='"';break;case"lt":r="<";break;case"gt":r=">";break;case"#35":r="#";break;default:r=""}return r}var n=t.matches,r,i,s,u="",f="",l="";if(n&&(n.nickname||n.user||n.firstname||n.lastname||n.mobileno||n.homeno||n.workno||n.email)){var c=e.Lang.isArray(n.nickname)&&n.nickname.length>0?!0:!1,h=e.Lang.isArray(n.firstname)&&n.firstname.length>0?!0:!1,p=e.Lang.isArray(n.lastname)&&n.lastname.length>0?!0:!1,d=e.Lang.isArray(n.email)&&n.email.length>0?!0:!1,v=t.nickname||null,m=t.firstname||null,g=t.lastname||null,y=t.email||null,b=c?a(v,n.nickname):v&&v.length>0?v:null,w=h?a(m,n.firstname):m&&m.length>0?m:null,E=p?a(g,n.lastname):g&&g.length>0?g:null,S=d?a(y,n.email):null;r="",r=o(w,"",E,b),b=c?b:null,w=h?w:null,E=p?E:null,i="",S?i+=S:i+=y,f=r||"",f=e.Lang.trim(f),f!==""&&(NeoConfig.bidi?(s=e.Intl.detectDirection(u.replace(/<\/?b\>/,"")),f="<span data-name dir="+s+">"+f+"</span>"):f="<span data-name>"+f+"</span>"),i.length>0&&(f.length>0&&(f+=" "),f===""?l="<em class='email no-name'"+(t.isCategory?"":" data-email='"+y+"'")+" dir='ltr'>"+i+"</em>":l="<em class='email'"+(t.isCategory?"":" data-email='"+y+"'")+" dir='ltr'>("+i+")</em>")}return l=l.replace(/&((?:[a-zA-Z]+)|(?:#[0-9]+));(?:([a-zA-Z]+|(?:#[0-9]+));)?|([;,])/gi,x),u=f+l,u}function a(t,n){var r=t,i,s,o,u,a;n.sort(l),s=r.length;for(i=n.length-1;i>=0;i--)o=n[i],NeoConfig.bidi?(u=r.substring(0,o.startIndex),a=r.substring(o.endIndex,s)+r.substring(s),r=u+e.comms.Intl.highlightString(r.substring(o.startIndex,o.endIndex),u,a)+a):r=r.substring(0,o.startIndex)+f(r.substring(o.startIndex,o.endIndex))+r.substring(o.endIndex,s)+r.substring(s),s=o.startIndex;return r=r.substring(0,s)+r.substring(s),r}function f(e){return"<b>"+e+"</b>"}function l(e,t){return typeof e=="object"&&typeof t=="object"&&typeof e.startIndex=="number"&&typeof t.startIndex=="number"?+(e.startIndex-t.startIndex):0}var t='<li role="option"><span class="ac-value">{{hilite}}</span><span data-action="ac-remove-item" data-ac-email-field-id="{{emailFieldId}}" data-ac-id="{{id}}" data-ac-email="{{email}}" class="icon icon-small-close ac-remove-item"></span></li>',n='<li role="option"><span class="ac-value">{{hilite}}</span></li>',r=n,i=NeoConfig.enableContactDelete?t:n;return{getItemMarkup:s,hlMatch:a,buildName:o}}();h._test={validateFilterItems:O,validateTempMatchData:M},e.namespace("comms").FilterContacts=h,e.namespace("comms").FilterContactsMarkup=
A},"1.0.0",{requires:["contacts-api-utils","contacts-api","common-utils"]});
